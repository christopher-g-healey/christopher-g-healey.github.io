<!DOCTYPE html>

<html lang="en">

<head>

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="UTF-8" />


<title>Python Tutorial: Institute for Advanced Analytics</title>
</head>

<script type="text/javascript" src="../../course/js/header-code.js"></script>

<body class="light">

<div style="text-align:center;">
<span id="banner-img" style="
  position: relative;
  display: inline-block;
  width: 100%;
  max-width: 1100px;
  height: 330px;
  background-image: url( '../../course/figs/python/banner.png' );
  background-repeat: no-repeat;
">
<div style="
  position: absolute;
  align: right;
  bottom: 15px;
  right: 20px;
  font-family: 'Trebuchet MS', Helvetica, sans-serif;
  font-size: 16pt;
  font-weight: normal;
  color: var(--title-fg);
">
  Python Tutorial
  <div style="font-size: 10pt;">
    <a target="_blank" href="https://healey.csc.ncsu.edu">
    <i>Christopher G. Healey</i>
    </a>
  </div>
</div>
<div style="
  position: absolute;
  align: right;
  top: 0px;
  left: 0px;
">
  <a target="_blank" href="https://www.ncsu.edu">
    <img alt="NC State Logo" src="../../course/figs/nc-state-logo-blue.png"
     style="
       border-style: none;
       -moz-box-shadow: 1px 1px 8px #646464;
       -webkit-box-shadow: 1px 1px 8px #646464;
       box-shadow: 1px 1px 8px #646464;
     " alt="nc-state-logo">
  </a>
</div>
</span>
</div>

<!--Spacer after image of one "line"-->

<div style="height: 1em;"></div>

<!-- Navigation toolbar -->

<div id="navWrap">
  <div id="nav">
    <ul id="nav-list">
      <li id="nav-intro:intro">Introduction
      <li id="nav-var:var">Variables
      <li id="nav-op:op">Operators
      <li id="nav-datatype:datatype">Data Types
      <li id="nav-cond:cond">Conditionals
      <li id="nav-file:file">Files
      <li id="nav-func:func">Functions
      <li id="nav-numpy:numpy">NumPy
      <li id="nav-pandas:pandas">pandas
      <li id="nav-sklearn:sklearn">sklearn
      <li id="nav-web:web">Web
      <li id="nav-prac:practice">Practice
    </ul>
  </div>

  <div id="nav-footer">
  </div>
</div>


<!-- Initially assume light theme (day), draw moon icon to switch to dark -->
<!-- Javascript will automatically check this and switch if it's night -->

<img id="light-dark" style="width: 24px; height: 24px; position: fixed; top: 2px; right: 20px; margin: 0; padding: 0; z-index: 200;" src="../figs/moon-icon-gradient.png" />


<h2 id="intro">Introduction</h2>

<p>A computer program is a sequence of instructions, written in a
<em>programming language</em>, that combine together to solve a
problem or produce a desired result. Computer programs range from very
simple examples with only a few lines of <em>source code</em>, to very
complicated. For example, Windows 11 is estimated to contain around
60&ndash;100 million lines of code.</p>

<p>In general, programming involves the following steps:</p>

<ol>

  <li>A program is written in some programming language
  (<em>e.g.</em>, C++, Python, R, or Javascript), usually stored in
  one or more source code files.

  <li>For compiled languages like C or C++, the source code is
  converted into machine language by a compiler, then combined into an
  executable file by a linker. The executable file is run on a target
  machine and operating system.

  <li>For interpreted languages like Python and R, the source code is
  processed by an interpreter. Individual lines are converted to
  machine language and executed one by one, as they are encountered
  within the source code.

</ol>

<p>This tutorial will provide an introduction to programming using
<a target="_blank" href="https://www.python.org">Python</a>,
an <em>interpreted</em> programming language. Python was conceived in
the late 1980s by Guido van Rossum at <a target="_blank"
href="https://www.cwi.nl">Centrum Wiskunde &amp; Informatica</a>
(National Research Institute for Mathematics and Computer Science) in
the Netherlands. Python 1.0 was released in 1994. The most recent
version is 3.10.2, released in January 2022. To maintain backwards
compatibility, Python versions 3.0 and 3.1 coincided with versions 2.6
and 2.7. We will be using Python version 3.9.x.

<p>Since Python is an interpreted language, individual lines of code
are converted to machine language and executed as they are encountered
(versus a compiled language, which converts an entire program to
machine code in an explicit compile&ndash;link stage). One advantage
of an interpreted language is the ability to enter individual commands
on a command line prompt, and immediately see their results.</p>


<div class="code-flex-div">
  <div class="code-flex" id="code-ex">
% print( 2 + 5 )
7
% l = [ 1, 2, 3 ]
% print( l )
[1, 2, 3]
% print( l[ 0 ] )
1
% email = { 'healey': 'healey@ncsu.edu', 'rappa': 'mrappa@ncsu.edu' }
% print( email )
{'rappa': 'mrappa@ncsu.edu', 'healey': 'healey@ncsu.edu'}
% print( email[ 'healey' ] )
healey@ncsu.edu
% basket = [ 'orange', 'apple', 'pear', 'apple', 'durian', 'orange' ]
% fruit = set( basket )
% print( fruit )
{'durian', 'orange', 'apple', 'pear'}
% print( 'durian' in fruit )
True
% print( 'pomegranate' in fruit )
False
  </div>
</div>


<p>Unless we're only issuing a few commands once or twice, we normally
store the commands in source code files. This allows us to load and
execute the commands as often as we want. It also makes it easier to
modify a program, or correct it when we discover errors. A slightly
modified version of the above code (to force output to appear when it's
run) is available in the source code
file <a href="tut-01-intro.py"><code>tut-01-intro.py</code></a>.</p>

<p>A source code file in Python is called a <em>module</em>. Every
Python program includes a <em>main</em> module. When the program
starts running, it begins interpreting code in the main module. You
can also split your code across additional modules to organize it, or
use <em>libraries</em> to access functionality provided by other
programmers.
</p>


<h3>Assignments</h3>

<p>The assignment for the Summer 2 session asks you to use Open
Weather Map's API (Application Programming Interface) to query
forecasted temperature data. You will write your results to a CSV
file. The <a href="./assn-openweathermap/" target="_blank">assignment
web page</a> provides full details on what is required.</p>

<p>The assignment will be completed as individuals, and not as a
homework team. Grading for the assignments will be on a standard
0&ndash;100% scale. You will submit the Python code for your completed
assignment through <a href="https://wolfware.ncsu.edu"
target="_blank">Moodle</a>. Look for "Python Programming:
OpenWeatherMap API Assignment". </p>


<h3>Running Python</h3>

<p>For this class, we'll be using the Anaconda Scientific with Python
3 for Windows. We will be using <a target="_blank"
href="https://www.anaconda.com/products/individual">Anaconda's Windows
Python 3.7 installer</a>. Anaconda includes
the <a href="https://numpy.org" target="_blank">NumPy</a>
(numerical Python), <a href="https://pandas.pydata.org"
target="_blank">pandas</a> (Python data analysis),
<a href="https://scikit-learn.org/stable/"
target="_blank">scikit-learn</a>,
<a href="https://docs.python.org/3/library/urllib.html"
target="_blank">urllib</a> (URL management), and
<a target="_blank"
href="https://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a>
libraries that we'll be using in this tutorial.</p>

<p>Once Anaconda is installed, I recommend running <code>Anaconda
Navigator</code> and choosing either <code>Jupyter notebook</code>
or <code>spyder</code> as your programming environment.</p>

<p>On most platforms, Python is normally installed by default. If it
is, you can run the Anaconda Prompt (Anaconda 3) and
type <code>python</code> at a command line prompt to bring up a Python
shell. Make sure you do this using the Anaconda Prompt and not a regular
Windows 10 command line, to ensure all the proper PATH variables to
appropriate Python packages are set.</p>


<h3>Why Python?</h3>

<p>Python is a powerful programming language that can perform many
functions. For this class, our interest is in Python's data management
capabilities. Python offers efficient ways to read data from one or
more input files, then modify, correct, convert, or extend that data
and write the results to an output file.</p>

<p>For example, suppose we had the following comma-separated value
(CSV) file:</p>

<blockquote>
  <code>Name,Height</code><br>
  <code>Jim,181</code><br>
  <code>Betty,167</code><br>
  <code>Frank,154</code><br>
  <code>...</code><br>
  <code>Annabelle,201</code>
</blockquote>

<p>We want to classify each individual based on his or her
height <em>h<sub>i</sub></em> versus the mean and standard deviation
of height &mu; and &sigma; as:<p>

<ul>
  <li>Class 1:&nbsp;&nbsp;|&thinsp;<em>h<sub>i</sub></em> -
  &mu;&thinsp;| &leq; &sigma;

  <li>Class 2:&nbsp;&nbsp;|&thinsp;<em>h<sub>i</sub></em> -
  &mu;&thinsp;| &leq; 2&sigma;

  <li>Class 3:&nbsp;&nbsp;<em>h<sub>i</sub></em> - &mu; &lt; -2&sigma;

  <li>Class 4:&nbsp;&nbsp;<em>h<sub>i</sub></em> - &mu; &gt;&gt;&gt;; 2&sigma;
</ul>

<p>producing a new CSV output file with contents:</p>

<blockquote>
  <code>Name,Height,Class</code><br>
  <code>Jim,181,2</code><br>
  <code>Betty,167,1</code><br>
  <code>Frank,154,3</code><br>
  <code>...</code><br>
  <code>Annabelle,201,4</code>
</blockquote>

<p>Python isn't the only way to produce this result (<i>e.g.</i>, we
could probably do it in Excel, or SAS, or R), but it's often easier
and faster to do it with a Python program. If you're curious,
<a href="tut-02-classify.py">this source code file</a> classifies a
comma-delimited height file. A <a href="./ht.csv">corresponding (very
simple) height file</a> is also available in CSV format.</p>


<h2 id="var">Variables</h2>

<p>Every programming language provides a way to maintain values as a
program runs. Usually, this is done by create a <em>named
variable</em>, then assigning a value to the variable. In Python,
variables are created interactively by specifying their name and
assigning them an initial value.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-var-ex">
% name = 'Abraham Lincoln'
% height = 6.33
% age = 56
% birthplace = 'Hodgenville KY'
% born = 'February 12 1809'
% deceased = 'April 15 1865'   
  </div>
</div>

<p>Unlike languages like C++, Python does not require you to specify a
variable's <em>type</em>. This is inferred from the value it
maintains. In the above example the variables <code>name</code>,
<code>birthplace</code>, <code>born</code>, and <code>deceased</code>
are inferred to be strings, <code>height</code> is inferred to be
floating point, and <code>age</code> is inferred to be integer. One
advantage of Python's <em>dynamically typed</em> variables is that you
can change them to hold different types of values whenever you
want. You can also ask Python what type of value a variable contains
with the <code>type()</code> function.

<div class="code-flex-div">
  <div class="code-flex" id="code-type-ex">
% name = 'Abraham Lincoln'
% print( type( name ) )
&lt;class 'str'&gt;
% name = 25
% print( type( name ) )
&lt;class 'int'&gt;
% name = 6.3
% print( type( name ) )
&lt;class 'float'&gt;
% name = 305127925769258727938193819283
% print( type( name ) )
&lt;class 'int'&gt;
% name = False
% print( type( name ) )
&lt;class 'bool'&gt;
  </div>
</div>

<p>Here is a quick list of some of Python's basic variable types.
More complicated types will be discussed later in the tutorial.</p>

<ul>
  <li><b>bool.</b> Boolean or "truth" variables. Possible values
  are <code>True</code> and <code>False</code>.

  <li><b>int.</b> Integer variables, whole number values with no
  fractional part. Possible values depend on the machine you're
  using. <code>sys.maxint</code> and <code>-sys.maxint - 1</code> can
  be used to query the machine's maximum and minimum integer values.

  <li><b>long.</b> Large integer variables. Python does not limit the
  size of long integers.

  <li><b>float.</b> Floating point variables, numbers with fractional
  parts. Possible values depend on the machine you're
  using. <code>sys.float_info.max</code> can be used to query the
  machine's maximum float value.

</ul>


<h3>Variable Practice Problem</h3>

<p>Write a set of Python statements that assign the names and
associated phone numbers: Christopher Healey, 9195138112, Michael
Rappa, 9195130480, and Aric LaBarr, 9195132957 to Python variables,
then prints three lines listing each person's name and corresponding
phone number.</p>

<p>I recommend you write your program using <code>Jupyter
notebook</code> or <code>spyder</code>, save it as a Python notebook
or source code file, and then test it, rather than writing the program
directly in the Python shell. This will let you write your code, run
it to see what it does, edit it to fix problems, and run it again,
without having to re-type the entire program at the command line.</p>


<div id="var-accordion" class="detail">
  <h3>Variable Assignment Solution</h3>
  <div>
    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-var-assign-ex">
% name_0 = 'Christopher Healey'
% phone_0 = '9195138112'
% name_1 = 'Michael Rappa'
% phone_1 = '9195130480'
% name_2 = 'Aric LaBarr'
% phone_2 = '9195132957'
%
% print( name_0, '@', phone_0 )
Christopher Healey @ 9195138112
%
% print( name_1, '@', phone_1 )
Michael Rappa @ 9195130480
%
% print( name_2, '@', phone_2 )
Aric LaBarr @ 9195132957
      </div>
    </div>

    <p>You can <a href="tut-03-var.py">download the solution file</a>
    and run it on your machine, if you want.</p>

    <p>Your choice of variable names is probably different than ours,
    and you might have printed the name and phone number with slightly
    different formatting. Regardless, the basic idea is to use six
    separate variables to store the names and phone numbers, then
    print the contents of these variables in combinations that produce
    the correct output.</p>

    <p>You might think, "This works, but it doesn't seem very
    efficient." That's true. Once you've learned more about Python,
    it's unlikely you'd write this code to solve the problem. Here's a
    more elegant and flexible solution. When you've finished the
    tutorial, you'll be able to understand, and to implement, this
    type of code.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-var-assign-dict">
% db = { }
% db[ '9195138112' ] = 'Christopher Healey'
% db[ '9195130480' ] = 'Michael Rappa'
% db[ '9195132957' ] = 'Aric LaBarr'
% for phone in db.keys():
%     print( db[ phone ], '@', phone )
Michael Rappa @ 9195130480
Christopher Healey @ 9195138112
Aric LaBarr @ 9195132957
      </div>
    </div>

  </div>
</div>


<h2 id="op">Operators</h2>

<p>Python provides a set of built-in functions or <em>operators</em>
to perform simple operations such as addition, subtraction,
comparison, and boolean logic. An expression is a combination of
variables, constants, and operators. Every expression has a
result. Operators in Python have <em>precedence</em> associated with
them. This means expressions using operators are not evaluated
strictly left to right. Results from the operators with the highest
precedence are computed first. Consider the following simple Python
expression:</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-precedence">
% 6 + 3 * 4 / 2 + 2
14
  </div>
</div>

<p>If this were evaluated left to right, the result would be
20. However, since multiplication and division have a higher
precedence than addition in Python, the result returned is 14,
computed as follows.</p>

<ul>

  <li><code><span style="color: #c0c0c0">6 +</span> 3 *
  4 <span style="color: #c0c0c0">/ 2 + 2</span></code>

  <li><code><span style="color: #c0c0c0">6 +</span> 12 /
  2 <span style="color: #c0c0c0"> + 2</span></code>

  <li><code>6 + 6 <span style="color: #c0c0c0">+ 2</span></code>

  <li><code>12 + 2</code>

  <li><code>14</code>

</ul>

<p>Of course, we can use parentheses to force a result of 20, if
that's what we wanted, with the following expression:</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-bracket">
% ((( 6 + 3 ) * 4 ) / 2 ) + 2
20
  </div>
</div>

<p>Below is a list of the common operators in Python, along with an
explanation of what they do. The operators are group according to
precedence, from highest to lowest.</p>

<div>
<table style="margin-left: auto; margin-right: auto;">
  <caption>
    Order of precedence for Python operators
  </caption>

  <tr>
    <th>Operator</th>
    <th>Description</th>
  </tr>

  <tr class="even">
    <td><code>( )</code></td>
    <td>parentheses define the order in which groups of operators should
    be evaluated</td>
  </tr>

  <tr class="odd">
    <td><code>**</code></td>
    <td>exponential</td>
  </tr>

  <tr class="even">
    <td><code>+x</code>, <code>-x</code></td>
    <td>make positive, make negative</td>
  </tr>

  <tr class="odd">
    <td><code>*</code>, <code>/</code>, <code>//</code>, <code>%</code></td>
    <td>multiplication, division, floor division, remainder</td>
  </tr>

  <tr class="even">
    <td><code>+</code>, <code>-</code></td>
    <td>addition, subtraction</td>
  </tr>

  <tr class="odd">
    <td>
      <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>,
      <code>&gt;=</code>, <code>!=</code>, <code>==</code>
    </td>
    <td>less, less or equal, greater, greater or equal, not equal,
    equal</td>
  </tr>

  <tr class="even">
    <td><code>and</code></td>
    <td>boolean AND</td>
  </tr>

  <tr class="odd">
    <td><code>or</code></td>
    <td>boolean OR</td>
  </tr>

</table>
</div>


<h2 id="datatype">Advanced Data Types</h2>

<p>In addition to boolean and numeric variables, Python provides a
number of more complex types, including strings (str), lists (list),
dictionaries (dict), or tuples (tuple). Using these types effectively
will make you a much more efficient programmer.</p>


<h3>str</h3>

<p>String variables (str) are a sequence of one or more characters.
String values are denoted by single quotes, <code>s = 'Abraham
Lincoln'</code>, or double quotes, <code>s = "Abraham
Lincoln"</code>. Because strings are a more complex data type, they
support more complex operations. Here are some common operations you
can perform on strings.</p>

<ul>

  <li><code>len(&nbsp;s&nbsp;)</code>, return the length (the number
  of characters) in <code>s</code>.

  <li><code>s + t</code>, concatenate <code>s</code>
  and <code>t</code>, returning a new string as the result.

  <li><code>s[&nbsp;i&nbsp;]</code>, return the <em>i</em>-th
  character in <code>s</code>. The first character in <code>s</code>
  is at <code>s[&nbsp;0&nbsp;]</code>.

  <li><code>s[&nbsp;i: j&nbsp;]</code>, <em>slice</em> <code>s</code>
  and return the substring from <code>s[&nbsp;i&nbsp;]</code> up to,
  but not including <code>s[&nbsp;j&nbsp;]</code>.

  <li><code>s[&nbsp;-i&nbsp;]</code>, return the <em>i</em>-th
  character <em>from the end</em> of <code>s</code>.

</ul>

<p>Here are some examples of string operations executed in a Python
shell.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-str">
% s = 'Hello world!'
% print( len( s ) )
12
% print( s[&nbsp;6&nbsp;] )
w
% print( s[&nbsp;2: 8&nbsp;] )
llo wo
% print( s[&nbsp;-2&nbsp;] )
d
% print( s[&nbsp;-3: 12&nbsp;] )
ld!
% t = 'Must.. try.. harder..'
% print( s + ' ' + t )
Hello world! Must.. try.. harder..
  </div>
</div>

<p>There are many additional operations you can perform on strings,
for example, <code>s.capitalize()</code> to capitalize a string, or
<code>s.find(&nbsp;t&nbsp;)</code> to find the first occurrence of
substring <code>t</code> in <code>s</code>. The Python
documentation
<a target="_blank"
href="https://www.tutorialspoint.com/python/python_strings.htm">describes
all the available string methods</a>, explaining how to use them and
what they do.</p>


<h3>list</h3>

<p>List variables are ordered sequences of values. Most data types can
be stored in a list, for example, a list of int's, a list of str's, or
even a list of list's. List values are denoted by square
brackets, <code>l = [&nbsp;1, 2, 3, 4&nbsp;]</code>.</p>

<p>You might notice that strings look suspiciously like a list of
characters. Indeed, both list and str are known as "sequence types" in
Python, so lists support the same <code>len</code>, concatenation,
indexing, and slicing operations as strings.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-list">
% l = [ 1, 2, 3, 4, 5 ]
% print( len( l ) )
5
% print( l[ 2 ] )
3
% print( l[ 1: 3 ] )
[2, 3]
% print( l[ -2 ] )
4
% print( l[ -3: 5 ] )
[3, 4, 5]
% m = [ -2, -3, -4 ]
% print( l + m )
[1, 2, 3, 4, 5, -2, -3, -4] 
  </div>
</div>

<p>As with strings, there are many additional operations you can
perform on lists, for
example, <code>l.insert(&nbsp;i,&nbsp;x&nbsp;)</code>
and <code>l.remove(&nbsp;i&nbsp;)</code> to add and remove items, or
<code>l.sort()</code> to reorder items into sorted order.  The Python
documentation
<a target="_blank"
href="https://www.tutorialspoint.com/python/python_lists.htm">describes
the available list methods</a>, explaining how to use them and what
they do.</p>


<h3>dict</h3>

<p>Dictionary variables are a collection of key&ndash;value pairs.
This is meant to be analogous to a real dictionary, where
the <em>key</em> is a word, and the associated <em>value</em> is the
word's definition. dict variables are designed to support efficient
searching for elements in the dictionary based on key.  Dictionary
values are denoted by braces, <code>d = {&nbsp;key:
value&nbsp;}</code>.

<p>By design, dictionaries have one important requirement: every value
you store in a dictionary must have its own, unique key. For example,
we could not store a person's address using their last name as a key,
because if two different people had the same last name, only one of
their addresses could be saved in the dictionary.</p>

<p>Suppose instead we wanted to find a person's name based on their
phone number. To do this, we could create a dictionary with phone
number as a key and name as a value.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-dict">
% d = { '9195138112': 'Christopher Healey' }
% d[ '9195130480' ] = 'Michael Rappa'
% d[ '9195152858' ] = 'Dept of Computer Science'
% print( d )
{'9195130480': 'Michael Rappa', '9195138112': 'Christopher Healey', '9195152858': 'Dept of Computer Science'}
% print( d[ '9195138112' ] )
Christopher Healey
  </div>
</div>

<p>The first statement creates a dictionary variable
named <code>d</code> and assigns a single key&ndash;value pair made up
of a string phone number key
<code>9195138112</code> and a string name value <code>Christopher
Healey</code>. The next two lines add two new key&ndash;value pairs
to <code>d</code> by specifying a key as an index (an string phone
number inside the square brackets) and assigned a name as the key's
value. Printing <code>d</code> lists all its key&ndash;value pairs.
The value attached to a specific key can be queried by
indexing <code>d</code> with the target key.</p>

<div id="key-accordion" class="detail">
  <h3>Key Types</h3>
  <div>
    <p>Why did we choose to make our key a string variable and not a
    numeric variable? The dictionary would work if we used <code>d =
    {&nbsp;9195138112: 'Christopher Healey'&nbsp;}</code>, with a long
    integer for the key rather than a string. Our choice was semantic:
    we view a phone number as a sequence of (numeric) characters, and
    not as a generic numeric value. It doesn't make sense to add or
    subtract phone numbers, for example, so phone numbers don't really
    act like numbers.</p>

    <p>Since the dictionary works identically either way, does it
    really matter? In terms of functionality, probably not. In terms
    of understandability, that depends. We try to find the best match
    between the context of a variable and its type. Here, the point is
    subtle, so it doesn't make a big difference. In other cases,
    though, a proper choice (rather than simply the first choice that
    works) can improve a program's effectiveness, and perhaps more
    importantly, make it easier to understand.</p>
  </div>
</div>

<p>One interesting difference between a dictionary and a list is that
dictionaries do not maintain order. The order that items are stored in
a dictionary will not necessarily match the order that you added them
to the dictionary. You can see this in the above example, where phone
numbers were added in the order
<code>9195138112</code>, <code>9195130480</code>, <code>9195152858</code>,
but they were stored in <code>d</code> in the
order <code>9195130480</code>, <code>9195138112</code>,
then <code>9195152858</code>.</p>

<p>Dictionaries are a very powerful data structure. If you need to
perform efficient search, if ordering the element's isn't critical,
and if you can define a key for each of the elements you're storing, a
dict might be a good candidate.

There are many additional operations you can perform on dictionaries,
for example, <code>d.keys()</code> to return a list of keys in the
dictionary, <code>d.values()</code> to return a list of its values,
or <code>d.pop(&nbsp;k&nbsp;)</code> to remove an entry with
key <code>k</code> (and return its value, if you want it). The Python
documentation
<a target="_blank"
href="https://www.tutorialspoint.com//python/python_dictionary.htm">describes
the available dictionary methods</a>, explaining how to use them and
what they do.</p>


<h3>tuple</h3>

<p>Tuple variables are ordered sequences of values, where the position
of a value within the tuple often has a semantic meaning.  Tuple
values are denoted by parentheses, <code>t = (&nbsp;2013, 10, 28, 14,
15, 0&nbsp;)</code>.</p>

<p>You might notice that tuples look identical to lists. Again, both
are "sequence types" in Python, so tuples support the
<code>len</code>, concatenation, and slicing operations, as well as
querying by index.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-type">
% t = ( 2013, 10, 28, 14, 15, 0 )
% print( len( t ) )
6
% print( t[ 0 ] )
2013
% print( t[ 3: 6 ] )
(14, 15, 0)
% print( t[ -3 ] )
14
% print( t[ -6: 3 ] )
(2013, 10, 28)
% u = ( 1, 232, 1 )
% print( t + u )
(2013, 10, 28, 14, 15, 0, 1, 232, 1) 
  </div>
</div>

<p>There are important differences between lists and tuples. Although
they are subtle, understanding them will help you decide when to use a
list, and when to use a tuple.</p>

<ul>

  <li>Values in a tuple cannot be changed after they are assigned
  (<i>i.e.,</i> tuples are immutable). If you tried something
  like <code>t[&nbsp;0&nbsp;] = 10</code>, Python will return an error
  message.

  <li>The position of a value in a tuple often has a semantic
  meaning. In the example above with <code>t = (&nbsp;2013, 10, 28,
  14, 15, 0&nbsp;)</code>, <code>t</code> represents a date-time value
  containing year, month, day, hour, minute, and second. So, each
  position in this kind of tuple matters: year is
  at <code>t[&nbsp;0&nbsp;]</code>, month is
  at <code>t[&nbsp;1&nbsp;]</code>, and so on.

  <li>Because tuples are immutable, they can be used in places that
  lists cannot. For example, a tuple can be used as a key in a
  dictionary entry. A list cannot be used as a key, since it would be
  possible to change the value of the list after it was stored in the
  dictionary, breaking the original key&ndash;value association.

</ul>

<p>Tuples support methods that lists support, as long as the
method <em>does not</em> modify the tuple's values. So, for example,
tuples support <code>len()</code> and <code>+</code>, but not
<code>remove()</code> or <code>sort()</code>, since that changes the
tuple's values or the order of its values.</p>


<h2 id="cond">Conditionals</h2>

<p>We've already seen that a Python program runs by executing the
first statement in the main module, and continuing with each
successive statement until it reaches the end of the program. This
doesn't allow for very complicated programs. What if want to control
the flow of execution, that is, what if we want one part of the
program to be executed in some cases, but another part to be executed
in different cases?</p>

<p><em>Conditional statements</em> allow you to control how your
program executes. For example, a conditional statement could apply a
comparison operator to a variable, then execute different a block of
statements depending on the result of the comparison.  Or, it could
cause a block of statements to be executed repeatedly until some
condition is met.</p>

<p>Understanding condition statements is necessary for writing even
moderately complicated programs. We discuss some common Python
conditional operators below, and give details on how to structure your
code within a conditional statement.</p>


<h3>if-then-else</h3>

<p>To start, we'll discuss the if-then-else conditional. Described in
simple terms, this is used in a program to say, "<em>If</em> some
condition is true, <em>then</em> do this, <em>else</em> do that."</p>

<p>As an example, suppose we have a variable <code>grade</code> that
holds a student's numeric grade on the range 0&ndash;100. We want to
define a new variable <code>passed</code> that's set
to <code>True</code> if the student's grade is 50 or higher,
or <code>False</code> if the grade is less than 50. The following
Python conditional will do this.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-if-then-else">
% grade = 75
% if grade >= 50:
%     passed = True
% else:
%     passed = False
%
% print( passed )
True
  </div>
</div>

<p>Although this statement appears simple, there are a number of
important details to discuss.</p>

<ul>

  <li>The comparison operation <code>grade &gt;= 50</code> evaluates
  to <code>True</code> if <code>grade</code>'s value is 50 or greater,
  and <code>False</code> if it isn't. The if conditional uses this
  boolean result to decide which part of the conditional statement to
  execute.

  <li>Notice there are colons (<code>:</code>) after the if statement
  and the else statement.

  <li>The <em>code blocks</em> that make up the then and else parts of
  the conditional are indented with a single Tab character. This
  identifies which statement(s) make up each code block. Identifying
  code blocks with Tabs is
  <b>required</b> in Python.

  <li>There is no explicit then keyword in Python. The first code
  block following the if statement is executed if the conditional
  passes.

</ul>

<p>Interestingly, the else part of the conditional is optional. The
following code will produce the same result as the first example.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-if-then">
% passed = False
% grade = 75
% if grade >= 50:
%     passed = True
%
% print( passed )
True
  </div>
</div>

<p>Suppose we wanted to not only define pass or fail, but also assign
a letter grade for the student. We could use a series of if-then
statements, one for each possible letter grade. A better way is to
use <code>elif</code>, which defines else-if code blocks. Now, we're
telling a program, "<em>If</em> some condition is true, <em>then</em>
do this, <em>else if</em> some other condition is true, <em>then</em>
do this, <em>else</em> do that." You can include as many else-if
statements as you want in an if-then-else conditional.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-if-then-elif">
% grade = 75
% if grade &gt;= 90:
%     passed = True
%     letter = 'A'
% elif grade &gt;= 80:
%     passed = True
%     letter = 'B'
% elif grade &gt;= 65:
%     passed = True
%     letter = 'C'
% elif grade &gt;= 50:
%     passed = True
%     letter = 'D'
% else:
%     passed = False
%     letter = 'F'
%
% print( passed )
True
% print( letter )
C
  </div>
</div>


<h3>while</h3>

<p>Another common situation is the need to execute a code block until
some condition is met. This is done with a while conditional. Here,
we're telling the program "<em>While</em> some condition is true, do
this." For example, suppose we wanted to print the square roots of
values on the range 1&ndash;15.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-while">
% import math
% i = 1
% while i &lt;= 15:
%     print( 'The square root of', i, 'is', math.sqrt( i ) )
%     i = i + 1
%
The square root of 1 is 1
The square root of 2 is 1.4142135623730951
&hellip;
The square root of 15 is 3.872983346207417 
  </div>
</div>


<p>(The <code>import math</code> statement is needed to give us access
to mathematical functions like <code>math.sqrt()</code>).</p>

<p>Notice that the variable that's compared in the while conditional
normally <b>must be updated</b> in the conditional's code block. If
you don't update the conditional variable, a comparison that initially
evaluates to <code>True</code> will never evaluate
to <code>False</code>, which means the while loop will execute
forever. For example, consider the following code block.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-endless-while">
% import math
% i = 1
% while i &lt;= 15:
%     print( 'The square root of', i, 'is', math.sqrt( i ) )
%
The square root of 1 is 1
The square root of 1 is 1
The square root of 1 is 1
The square root of 1 is 1
The square root of 1 is 1
The square root of 1 is 1
The square root of 1 is 1
&hellip;
  </div>
</div>

<p>Without the <code>i = i + 1</code> statement to
update <code>i</code> in the conditional's code block, the while
conditional never fails, giving us the same output over and over. You
can use Ctrl+C to halt your program if it's caught in an infinite loop
like this.</p>


<h3>for</h3>

<p>A final conditional that is very common is a for loop. Here, we're
telling a program "Execute this code block <em>for</em> some list of
values." for can work on any list of values, but it's often applied to
a numeric range. The <code>range</code> command is used to create a
sequence of integers.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-range">
% print( range( 5, 10 ) )
range( 5, 10 )
% print( range( 10 ) )
range( 10 )
% print( list( range( -15, -10 ) ) )
[-15, -14, -13, -12, -11]
  </div>
</div>

<p>Giving two values to <code>range</code> like <code>range(&nbsp;2,
5&nbsp;)</code> defines a starting value of 2 and an ending value of
5. <code>range</code> generates an integer list from the starting
value, up to but not including the ending value: <code>[2, 3,
4]</code>. If you only give an ending value to <code>range</code>
like <code>range(&nbsp;5&nbsp;)</code>, <code>range</code> assumes a
starting value of 0, producing the list <code>[0, 1, 2, 3, 4]</code>.

<p>Once a list is produced with <code>range</code>, each value in the
list is given to the for conditional's code block, in order. For
example, suppose we wanted to print the same set of square roots from
1&ndash;15 using a for loop.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-for">
% import math
% for i in range( 1, 16 ):
%     print( 'The square root of', i, 'is', math.sqrt( i ) )
%
The square root of 1 is 1
The square root of 2 is 1.4142135623730951
&hellip;
The square root of 15 is 3.872983346207417
  </div>
</div>

<p>The for statement defines a variable to hold the "current" list
value. In our case, this variable is
called <code>i</code>. <code>range(&nbsp;1, 16&nbsp;)</code> generates
the list <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
15]</code>.  The for conditional walks through this list and executes
the code block 15 times, first with <code>i</code> set to 1, then
with <code>i</code> set to 2, and so on up to the final value of
15. The statement inside the code block uses <code>i</code> to track
the current list value, printing square roots from 1 to 15.</p>

<p>We don't need to use <code>range</code> to execute a for
conditional. Any list can be used in a for loop.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-for-collection">
% name = [ "Healey", "Rappa", "LaBarr" ]
% for nm in name:
%     print( nm, '(', len( nm ), ')' )
%
Healey ( 6 )
Rappa ( 5 )
LaBarr ( 6 )
  </div>
</div>

<div id="break-continue-accordion" class="detail">
  <h3>break and continue</h3>
  <div>
    <p><em><b>break</b></em></p>

    <p>Sometimes we need to exit a for or while loop before its
    condition evaluates to <code>False</code>. The <code>break</code>
    statement allows us to do this. For example, suppose we wanted to
    print the elements of a list of strings, but terminate examining
    the list if we see the string <code>stop</code>.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-break">
        
% l = [ 'Healey', 'Rappa', 'LaBarr' ]
% for i in range( len( l ) ):
%     if l[ i ] == 'stop':
%         break
%     print( l[ i ] )
%
Healey
Rappa
LaBarr
% l.insert( 1, 'stop' )
% print( l )
[ 'Healey', 'stop', 'Rappa', 'LaBarr' ]
% for i in range( len( l ) ):
%     if l[ i ] == 'stop':
%         break
%     print( l[ i ] )
Healey
      </div>
    </div>

    <p><em><b>continue</b></em></p>

    <p>Other times, we want to stop executing a loop's code block, and
    instead return to check its condition.  The <code>continue</code>
    statement allows us to do this. For example, suppose we wanted to
    print only the odd numbers from 1 to 10.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-continue">
% for i in range( 1, 10 ):
%     if i % 2 == 0:
%         continue
%     print( i, 'is odd' )
1 is odd
3 is odd
5 is odd
7 is odd
9 is odd
      </div>
    </div>
  </div>
</div>


<h3>Loop Practice Problem</h3>

<p>Write a set of Python statements to compute the average of the
following list of numbers.</p>

<ul>

  <li> 6, 12, -7, 29, 14, 38, 11, 7

</ul>

<p>I recommend you write your program using <code>Jupyter
notebook</code> or <code>spyder</code>, save it as a Python notebook
or source code file, and then test it, rather than writing the program
directly in the Python shell. This will let you write your code, run
it to see what it does, edit it to fix problems, and run it again,
without having to re-type the entire program at the command line.</p>

<div id="list-avg-soln-accordion" class="detail">
  <h3>Loop Practice Solution</h3>
  <div>
    <p><em><b>for loop</b></em></p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-list-avg-for">
% num = [ 6, 12, -7, 29, 14, 38, 11, 7 ]
% sum = 0
% for n in num:
%     sum = sum + n
%
% print( float( sum ) / len( num ) )
13.75
        </div>
      </div>

      <p><em><b>while loop</b></em></p>

      <div class="code-flex-div">
        <div class="code-flex-accordion" id="code-list-avg-while">
% num = [ 6, 12, -7, 29, 14, 38, 11, 7 ]
% i = 0
% sum = 0
% while i &lt; len( num ):
%     sum = sum + num[ i ]
%     i = i + 1
%
% print( float( sum ) / len( num ) )
13.75
        </div>
      </div>

      <p>Notice that we have to convert the sum to a floating point
      value (in our case, by casting it with <code>float()</code>) to
      get the proper average of 13.75. If we had used the
      statement <code>print( float sum / len( num ) )</code> instead,
      Python would have return an integer result of 13.</p>

      <p>You can <a href="tut-04-avg.py">download the solution
      file</a> and run it on your machine, if you want.</p>
    </div>
  </div>
</div>


<h3>Debugging</h3>

<p>Inevitably, you'll write some Python code that either doesn't do
what you expect it to do, or that generates an error message when you
try to execute it. When that happens, you'll need to <em>debug</em>
the program to locate and correct the error. Consider the following
code.<p>

<div class="code-flex-div">
  <div class="code-flex" id="code-debug-error">
% l = [ '10', '20', '30' ]
% sum = 0
% for val in l:
%     sum = sum + val
  </div>
</div>

<p>If you hit Return to close the for loop, Python would respond with
an error message similar to this.</p>

<div class="ex-div">
TypeError   Traceback (most recent call last)
&lt;ipython-input-11-00773625d4c5&gt;, in &lt;module&gt;
      2 sum = 0
      3 for val in l:
----> 4     sum = sum + val
TypeError: unsupported operand type(s) for +: 'int' and 'str'
</div>

<p>So, that didn't work. The first two lines of the error message give
some details about how the error's being reported, and where the error
occurred (on line 2 of code being entered on
"<code>&lt;stdin&gt;&gt;&gt;;</code>", which is Python's way of saying "from
the keyboard"). The most important part of the error is the last line,
which tries to explain the problem Python encountered. This
explanation suggests that Python doesn't know how to add
(<code>+</code>) an int and a str.</p>

<p>If you look at where the error was reported (line 2 of the for
loop), it attempted to execute <code>sum = sum + val</code>. Python is
claiming the first variable in the add operation, <code>sum</code>, is
an int, but the second variable <code>val</code> is a
str. <code>val</code> is a value from the list
variable <code>l</code>. And, when we look at <code>l</code>, we see
that it contains three <b>string</b> values:
<code>'10'</code>, <code>'20'</code>, and <code>'30'</code>. This is
the problem that Python encountered.</p>

<p>There are various ways to fix this problem. One simple solution is
to put integers in the list, <code>l = [&nbsp;10, 20, 30&nbsp;]</code>. If you
wanted <code>l</code> to contain strings for some reason, you could
cast <code>val</code> to be an integer in the add operation.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-debug-fix">
% l = [ '10', '20', '30' ]
% sum = 0
% for val in l:
%     sum = sum + int( val )
%
% print( sum )
60
  </div>
</div>

<p>Now, Python accepts the for loop's body because it understands how
to add to int variables. The resulting sum is printed after the loop
finishes.</p>

<div id="bug-accordion" class="detail">
  <h3>Computer "Bugs"</h3>
  <div>
    <p>Why are errors in computer programs called <em>bugs</em>?
    Historically, the term "bug" was used in engineering to describe
    mechanical malfunctions.


    <div class="img-div" style="width: 40%; max-width: 500;">
      <img style="width: 100%; max-width: 500px;" src="../figs/python/bug.png"></img>
      <figcaption>
        A physical bug found during construction ofin the Harvard Mark
        II computer.
      </figcaption>
    </div>


    <p>In 1947 computer engineers were designing the Harvard Mark II
    computer. An error in the machine was traced to a moth that had
    become trapped in one of the machine's relays. The moth was
    removed and taped to the engineers' log book, where they referred
    to it as "The first actual case of bug being found." This incident
    seems to have contributed to the widespread use of the term in
    Computer Science.</p>
  </div>
</div>


<h2 id="file">Files</h2>

<p>One of the main reasons we're using Python is to read and write
data to and from external files. Python has an extensive set of file
input/output (file IO) operations to support this. The basic structure
of modifying a file often follows this simple pattern.</p>

<ol>

  <li>Open one or more input files to read the original data.

  <li>Open an output file to write the new or modified data.

  <li>Read data from the input file, usually line by line.

  <li>Examine each input line, modifying it or generate new data based
  on its contents.

  <li>Write the modified line and/or data to the output file.

  <li>Close the input and output files when processing is completed.

</ol>


<h3>Reading Files</h3>

<p>Here are some operations you can use to open files and read from
them.</p>

<ul>

  <li><code>inp = open( 'input.txt', 'r', encoding='latin' )</code>,
  open the file named <code>input.txt</code> for reading, accessed
  through variable <code>inp</code>.

  <li><code>inp.read()</code>, read the entire file, returning it as a
  single string.

  <li><code>inp.readline()</code>, read the next line of the file,
  returning the line as a string.

  <li><code>inp.readlines()</code>, read the entire file, returning it
  as a list of strings, one for each line in the file.

  <li><code>inp.close()</code>, close the file.

</ul>

<p>As a file is being read, Python maintains a current position in the
file (the <em>file pointer</em>). This is how Python finds things like
the "next" line: it starts from its current position in the file,
reads until it sees a newline character (<code>\r\n</code>) or the end
of the file, then returns what it read as a string.</p>

<p>Maintaining a current position means that Python won't
automatically "back up" for you if you want to go back and re-read
some data. For example, consider the following code snippet.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-open-file">
% inp = open( 'input.txt', 'r', encoding='latin' )
% line = inp.readlines()
% print( len( line ) )
180
% line = inp.readlines()
% print( len( line ) )
0
% inp.close()
  </div>
</div>

<p>The first time we read <code>input.txt</code> and asked how many
lines it contained, Python told us it had 180 lines. But the next time
we read the file, Python said it had 0 lines. How is that
possible?</p>

<p>Remember, after the first <code>line = inp.readlines()</code>
statement, Python reads everything in the file, returning a list with
180 strings representing the file's 180 lines. Critically, the current
position is now at the end of the file. We re-issue the
same <code>line = input.readlines()</code> statement,
Python <em>starts from its current position at the end of the
file</em>, realizes there's nothing else left to read, and returns an
empty list to tell us that. So, the length of that second list is 0,
exactly as we saw.</p>

<p>How could we re-read the entire file? The easiest way to do this
is to close the file, then re-open it. Doing this resets the current
position back to the start of the file.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-close-file">
% inp = open( 'input.txt', 'r', encoding='latin' )
% line = inp.readlines()
% print( len( line ) )
180
% inp.close()
% inp = open( 'input.txt', 'r', encoding='latin' )
% line = inp.readlines()
% print( len( line ) )
180
% inp.close()
  </div>
</div>

<div id="seek-accordion" class="detail">
  <h3>seek and tell</h3>
  <div>
    <p><em><b>seek</b></em></p>

    <p>It's possible to change the current position in a file without
    closing and re-opening it. <code>seek( pos )</code> is used to set
    a file's current position to <code>pos</code>. For example, we
    could re-read <code>input.text</code> as follows.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-seek">
% inp = open( 'input.txt', 'r', encoding='latin' )
% line = inp.readlines()
% print( len( line ) )
180
% inp.seek( 0 )
% line = inp.readlines()
% print( len( line ) )
180
% inp.close()
      </div>
    </div>

    <p>The command <code>inp.seek(&nbsp;0&nbsp;)</code> sets the
    current position to 0 bytes from the start of the file
    (<em>i.e.</em>, to the start of the file). If you need to seek
    from the end of the file, you can specifying a negative offset and
    a second argument of 2 to <code>seek</code>, for
    example, <code>inp.seek(&nbsp;-10, 2&nbsp;)</code> seek 10
    bytes <em>backwards</em> from the end
    of <code>input.txt</code>. You can also seek from the current
    position by specifying an offset and a second argument of 1 to
    <code>seek</code>, for example, <code>inp.seek(&nbsp;20,
    1&nbsp;)</code> to seek 20 bytes forwards from the current
    position, or <code>seek(&nbsp;-5, 1&nbsp;)</code> to seek 5 bytes
    backwards from the current position.</p>

    <p style="margin-top: 1em;"><em><b>tell</b></em></p>

    <p>The <code>tell()</code> command will return the current
    position in a file. For example, to determine the size of a file,
    you could do the following.

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-seek-tell">
% inp = open( 'input.txt', 'r', encoding='latin' )
% inp.seek( 0, 2 )
% print( inp.tell() )
4044
% inp.close()
      </div>
    </div>
  </div>
</div>


<h3>Writing Files</h3>

<p>Python provides similar operations open files and write to
them.</p>

<ul>

  <li><code>out = open( 'output.txt', 'w', encoding='latin' )</code>,
  open the file named <code>output.txt</code> for writing, accessed
  through variable <code>out</code>.

  <li><code>out = open( 'output.txt', 'a', encoding='latin' )</code>,
  open the file named <code>output.txt</code> and appends any new data
  you write to the end of the file.

  <li><code>out.write( s )</code>, write the contents of
  string <code>s</code> to the file.

  <li><code>out.close()</code>, close the file.

</ul>

<p>Writing data is simple: put the data you want to write into a
string variable (or convert a variable's value to a string value),
then use <code>write</code> to write the data to an output
file.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-write">
% import os
%
% out = open( 'output.txt', 'w', newline='', encoding='latin' )
% num = 50
% list = [ 'Healey', 'Rappa', 'Mostek' ]
% for elem in list:
%    out.write( elem + os.linesep )
%
% out.write( str( num ) )
% out.close()
  </div>
</div>


<p>This code snippet creates an output file <code>output.txt</code>
and writes four lines containing Healey, Rappa, Mostek, and 50 to the
file. Notice that if we need a newline after each value, we need to
add it explicitly by appending <code>'\r\n'</code> to the string as
it's being written.</p>

<div id="newline-accordion" class="detail">
  <h3>newlines</h3>
  <div>
    <p>Newlines are used to insert a carriage return between lines in
    a file. In Windows (or DOS) a newline is actually two characters:
    a return and a newline, denoted <code>\r\n</code>. This is unique
    to Windows. On other operating systems like Mac OS or Linux, only
    the newline <code>\n</code> is used.</p>

    <p>Newlines also matter when you're reading data. For example,
    supposed you used <code>readlines()</code> to read all the lines
    in a file.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-file-split">
% inp = open( 'input.txt', 'r', encoding='latin' )
% line = inp.readlines()
% print( line[ 0: 2 ] )
['This is the first line\r\n', 'This is the second line\r\n']
      </div>
    </div>

    <p>The return and newline are included at the end of each line
    that's read. In some cases you want these "separators" removed
    when the file is read and parsed. One easy way to do this is to
    read the entire file using <code>read()</code>, then split the
    result using the string operator <code>split()</code>.

    <p>To determine which character(s) represent the end of a line,
    use the <code>os.linesep</code> variable.

    <p><b>Windows:</b>
    <div class="ex-div">
% import os
% os.linesep
'\r\n'
    </div>
    </p>

    <p><b>Mac OS or Linux:</b></p>
    <div class="ex-div">
% import os
% os.linesep
'\n'
    </div>

    <p>Now, we read and divide lines as follows to produce a list of
    lines in a file.</p>
    
    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-read-newline">
% import os
% inp = open( 'input.txt', 'r', encoding='latin' )
% content = inp.read()
% line = content.split( os.linesep )
% print( line[ 0: 2 ] )
['This is the first line', 'This is the second line']
      </div>
    </div>

    <p><code>split()</code> divides a string into a list of substrings
    based on a <em>delimiter</em>, throwing away the delimiter after
    each split. Splitting the file's contents on the
    delimiter <code>os.linesep</code> gives us what we want: the
    individual lines from the file without carriage returns or
    newlines at the end of each line.</p>
  </div>
</div>


<h3>CSV Files</h3>

<p>A file type you are likely to encounter often is a comma-separated
value (CSV) file. CSV files are text files containing a table of
values. Each line represents one row in the table, with individual
column values in the row identified by a <em>separator</em>
character. The separator is often a comma (<code>,</code>), although
it can be any character that's guaranteed not to appear in any column
value. For example, the <a target="_blank"
href="https://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?src=bkmk">US
Census Bureau</a> maintains a file of estimated US city populations
from 2010&ndash;2017. We will use <a href="./pop.csv">an earlier
file</a>, compiled directly after the 2010 census, containing
estimated 2011 city and town populations</a>.


<div class="ex-div">
SUMLEV,STATE,COUNTY,PLACE,COUSUB,CONCIT,NAME,STNAME,CENSUS2010POP,ESTIMATESBASE2010,POPESTIMATE2010,POPESTIMATE2011
040,01,000,00000,00000,00000,Alabama,Alabama,4779736,4779735,4785401,4802740
162,01,000,00124,00000,00000,Abbeville city,Alabama,2688,2688,2689,2704
162,01,000,00460,00000,00000,Adamsville city,Alabama,4522,4522,4522,4525
162,01,000,00484,00000,00000,Addison town,Alabama,758,758,754,754
162,01,000,00676,00000,00000,Akron town,Alabama,356,356,354,348
162,01,000,00820,00000,00000,Alabaster city,Alabama,30352,30352,30473,30799
162,01,000,00988,00000,00000,Albertville city,Alabama,21160,21160,21202,21421
162,01,000,01132,00000,00000,Alexander City city,Alabama,14875,14875,14846,14876
162,01,000,01228,00000,00000,Aliceville city,Alabama,2486,2486,2483,2438
&hellip;
157,56,045,79125,00000,00000,Upton town,Wyoming,1100,1100,1096,1084
157,56,045,99990,00000,00000,Balance of Weston County,Wyoming,2576,2576,2564,2539
</div>


<p>We could use file and string operations to read and parse CSV
files, but Python provides a <code>csv</code> module to help us with
this.  Modules are pre-written collections of operators, usually
designed for a specific purpose or task. To use a module, you must
first <code>import</code> it. To invoke one of it's operations, you
precede the operator's name with the name of the module, followed by a
period.

<div class="code-flex-div">
  <div class="code-flex" id="code-csv">
% import csv
% csv.list_dialects()
['excel-tab', 'excel']
  </div>
</div>

<p>To read data from a CSV file, we normally perform the following
steps.</p>

<ol>

  <li>Open the CSV file to read with <code>open()</code>, exactly like
  any other input file.

  <li>Attach a CSV <code>reader</code> to the CSV file.

  <li>Use <code>next( reader )</code> to read and parse any header line(s)
  in the CSV file.

  <li>Use a <code>for</code> loop to read and parse the rows in the
  CSV file. Each row is returned as a list of column values found in
  the row's line.

  <li>Close the CSV file.

</ol>

<p>For example, this code would read and parse the Census population
file</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-csv-reader">
% import csv
%
% inp = open( 'pop.csv', 'r', newline='', encoding='latin' )
% reader = csv.reader( inp )
% header = next( reader )
%
% for row in reader:
%     if row[ 6 ] == row[ 7 ]:
%         print( 'The state of', row[ 7 ], 'has population', row[ 11 ] )
%     else:
%         print( 'City', row[ 6 ], 'in state', row[ 7 ], 'has population', row[ 11 ] )
%
The state of Alabama has population 4802740
City Abbeville city in state Alabama has population 2704
City Adamsville city in state Alabama has population 4525
&hellip;
City Upton town in state Wyoming has population 1084
City Balance of Weston County in state Wyoming has population 2539
%
% inp.close()
  </div>
</div>


<p>Note that we open the file with the <code>newline=''</code>
argument. We will use the same argument we we open files intended for
CSV writing below. This handles running Python 3.x on Windows, where
the interpreter automatically inserts a carriage return
(<code>\r</code>) whenever it sees a newline (<code>\n</code>). This
built-in functionality means that, on Windows, when we read or write a
CSV file, the newline <code>\r\n</code> on the file is automatically
converted to <code>\r\r\n</code>, which adds an extra line break.
Particularly on writing, this causes issues, making it look like
there's a blank line between each data line when the file is imported
into programs like Excel.</p>

<p>The <code>csv</code> module helps us read and parse a CSV file, but
it doesn't tell us anything about what the rows and columns in the
file represent. We need to provide that context based on our
understanding of the file. For example, in the code above:</p>

<ul>

  <li>We know the first line of the CSV file is a header row, so we
  read it using <code>header = next( reader )</code>. If we didn't
  do this, it would be interpreted as a city population line.

  <li>We can see that the 12th column on each row
  (<code>row[&nbsp;11&nbsp;]</code>) holds the estimated 2011
  population, so this is what we print in our output.

  <li>When the city name and the state name
  (<code>row[&nbsp;6&nbsp;]</code>
  and <code>row[&nbsp;7&nbsp;]</code>) are identical, the row
  represents the state's overall population. We check for this
  with <code>if row[&nbsp;6&nbsp;] == row[&nbsp;7&nbsp;]</code>, reporting the population
  for these rows as state population.

</ul>

<p>It's also possible to write data out in CSV format. This is useful,
since CSV files can be easily imported into programs like Excel or
SAS. A very similar sequence of steps is used to write a CSV file.</p>

<ol>

  <li>Open the CSV file to write with <code>open()</code>, exactly
  like any other output file.

  <li>Attach a CSV <code>writer</code> to the CSV file.

  <li>For each row you want to write to the CSV file, store the row's
  column values in a list.

  <li>Use <code>writerow()</code> to write the list's values as a
  comma-separated line in the CSV file.

  <li>After all the rows are written, close the CSV file.

</ol>

<p>For example, the Census population file has a lot of columns we
might not care about. Suppose we wanted to reduce the file to only
include city name, state name, and 2011 population estimate. The
following code would do this.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-census-pop">
% import csv
%
% inp = open( 'pop.csv', 'r', newline='', encoding='latin' )
% reader = csv.reader( inp )
% header = next( reader )
%
% out = open( 'pop-summary.csv', 'w', newline='', encoding='latin' )
% writer = csv.writer( out )
% writer.writerow( [ 'City', 'State', 'Population' ] )
%
% for row in reader:
%     writer.writerow( [ row[ 6 ], row[ 7 ], row[ 11 ] ] )
%
% inp.close()
% out.close()
  </div>
</div>

<p>This will produce an output file <code>pop-summary.csv</code> with
the following data.</p>


<div class="ex-div">
City,State,Population
Alabama,Alabama,4802740
Abbeville city,Alabama,2704
Adamsville city,Alabama,4525
Addison town,Alabama,754
Akron town,Alabama,348
Alabaster city,Alabama,30799
Albertville city,Alabama,21421
Alexander City city,Alabama,14876
Aliceville city,Alabama,2438
&hellip;
Upton town,Wyoming,1084
Balance of Weston County,Wyoming,2539
</div>


<h3>CSV Practice Problem</h3>

<p>Write a Python program that finds the city with the largest
population in <a href="pop.csv">pop.csv</a>, then prints this city's
name, the name of its state, and its population.</p>

<p><b>Hint.</b> When you read data with a CSV reader, the column
values it returns are all strings. You'll want to convert the
population value from a string to an integer. To do this,
you <em>cast</em> the string using the <code>int()</code>operation.

<div class="ex-div">
% for row in reader:
%     pop = int( row[ 11 ] )
  &hellip;
</div>

<p>I recommend you write your program using <code>Jupyter
notebook</code> or <code>spyder</code>, save it as a Python notebook
or source code file, and then test it, rather than writing the program
directly in the Python shell. This will let you write your code, run
it to see what it does, edit it to fix problems, and run it again,
without having to re-type the entire program at the command line.</p>


<div id="pop-accordion" class="detail">
  <h3>Maximum Population Solution</h3>
  <div>
    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-cvs-read-pop">
% import csv
% inp = open( 'pop.csv', 'r', encoding='latin' )
% reader = csv.reader( inp )
% header = next( reader )
% max_pop = 0
% max_city_nm = "Unknown"
% max_st_nm = "Unknown"
% for row in reader:
%     pop = int( row[ 11 ] )
%     if row[ 6 ] != row[ 7 ] and pop > max_pop:
%         max_pop = pop
%         max_city_nm = row[ 6 ]
%         max_st_nm = row[ 7 ]
%
% inp.close()
% print( max_city_nm, 'in state', max_st_nm, 'has population', max_pop )
Los Angeles County in state California has population 9889056
      </div>
    </div>

    <p>You can <a href="tut-05-pop.py">download the solution file</a>
    and run it on your machine, if you want.</p>

  </div>
</div>


<h2 id="func">Functions</h2>

<p>It's possible to write a program as a single, long sequence of
statements in the main module. Even for small programs, however, this
isn't efficient. First, writing a program this way makes it difficult
to examine and understand. Second, if you're performing common
operation on different variables, you need to duplicate the code every
time you perform that operation.</p>

<p>For example, suppose we wanted to report the average of two numeric
lists <code>l</code> and <code>m</code>. One obvious way to do it is
to write two for loops.<p>

<div class="code-flex-div">
  <div class="code-flex" id="code-for-avg">
% l = [ 1, 2, 3 ]
% m = [ 7, 8, 14 ]
% sum = 0
% for elem in l:
%     sum = sum + elem
%
% print( float( sum ) / 3 )
2.0
% sum = 0
% for elem in m:
%     sum = sum + elem
%
% print( float( sum ) / 3 )
9.66666666667
  </div>
</div>


<p>This has a number of problems, however. What if we had more than
just two lists we wanted to average? We'd need to duplicate the for
loop once for each list. What if we wanted to do something more
complicated than calculating the average (<em>e.g.</em>, what if we
wanted population standard deviation instead)? The amount of code we'd
need to duplicate would be much longer.</p>

<p>What we really want to do is to have some sort
of <code>avg()</code> operation that we can call whenever we want to
calculate the average of a numeric list.</p>

<div class="ex-div">
% l = [ 1, 2, 3 ]
% m = [ 7, 8, 14 ]
% print( avg( l ) )
% 2.0
% print( avg( m ) )
9.66666666667
</div>

<p>In Python we can define a <em>function</em> to create new
operations like <code>avg()</code>. A function is defined using the
keyword <code>def</code>, followed by the function's name, followed by
an argument list in parentheses, and then a colon. The function's code
block defines what the function does when it's called.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-avg">
% def avg( num ):
%     sum = 0
%     for elem in num:
%         sum = sum + elem
%     return float( sum ) / len( num )
  </div>
</div>


<p>Functions can take zero or more arguments. A function with no
arguments still needs open and close parentheses, <code>def
func():</code>. A function with multiple arguments separates then with
commas, <code>def func( a, b ):</code>.</p>

<p>Once a function is defined, it can be used anywhere, including in
other functions. Suppose we now wanted to write a
function <code>stdev()</code> to compute the population standard
deviation of a numeric list. We can use our <code>avg()</code>
function to help to do this.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-stdev">
% import math
%
% def stdev( num ):
%     sum = 0
%     num_avg = avg( num )
%     for elem in num:
%         sum = sum + ( ( elem - num_avg ) ** 2.0 )
%     return math.sqrt( sum / len( num ) )
  </div>
</div>

<p>What if we wanted to allow a user to decide whether to calculate
population standard deviation or sample standard deviation? We could
write two separate functions to do this, but an easier way is to add
an argument to the <code>stdev()</code> function to specify which
standard deviation to calculate.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pop-sample-stdev">
% import math
%
% def stdev( num, pop = True ):
%     sum = 0
%     num_avg = avg( num )
%     for elem in num:
%         sum = sum + ( ( elem - num_avg ) ** 2.0 )
%     if pop == True:
%         return math.sqrt( sum / len( num ) )
%     else:
%         return math.sqrt( sum / ( len( num ) - 1 ))
  </div>
</div>


<p>Now, <code>stdev()</code> takes a second
argument <code>pop</code>. If <code>pop</code> is <code>True</code>,
we return population standard deviation. Otherwise, we return sample
standard deviation. Notice that in the function header we
defined <code>pop = True</code>. This specifies a <em>default
value</em> for <code>pop</code>. If the user doesn't specify a second
argument, we return population standard deviation by default.</p>

<div class="ex-div">
% l = [ 7, 8, 14 ]
% print( 'Pop stdev of', l, 'is', stdev( l ) )
Pop stdev of [7, 8, 14] is 3.09120616517
% print( 'Sample stdev of', l, 'is', stdev( l, False ) )
Sample stdev of [7, 8, 14] is 3.7859388972
</div>


<p>It's even possible for functions to call themselves. This is known as
<em>recursion</em>. Consider the Fibonacci sequence:</p>

<ul>

  <li><i>F</i>( 0 ) = 0

  <li><i>F</i>( 1 ) = 1

  <li><i>F</i>( <i>n</i> ) = <i>F</i>( <i>n</i> - 1 )
  + <i>F</i>( <i>n</i> - 2 ) &forall; <i>n</i> &ge; 2

</ul>

<p>Since Fibonacci numbers for <i>n</i> &ge; 2 are defined based on
lower-order versions of themselves, they are a common candidate to
demonstrate a recursive function.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-fib">
% def fib( n ):
%     if n &lt;= 0:
%         return 0
%     elif n == 1:
%         return 1
%     else:
%         return fib( n - 1 ) + fib( n - 2 )
%
% print( fib( 0 ) )
0
% print( fib( 2 ) )
1
% print( fib( 20 ) )
6765
% print( fib( 40 ) )
102334155
  </div>
</div>

<p>If you look at <code>fib()</code>, you should see intuitively that
it's very expensive to execute. If you tried to
calculate <code>fib(&nbsp;100&nbsp;)</code>, for example, you'd be
waiting a long time for it to finish. That's because each number in a
Fibonacci sequence requires two recursive calls, which themselves each
require two recursive calls, and so on.</p>


<div id="fib-accordion" class="detail">
  <h3>Fibonacci, Rabbits, and Efficiency</h3>
  <div>

    <p>Although the origins of Fibonacci numbers are
    <a target="_blank"
    href="https://en.wikipedia.org/wiki/Fibonacci_number#History">credited
    to Indian mathematics</a>, the number series is named after
    Leonardo of Pisa, also known as Fibonacci. In 1202 Fibonacci posed
    a question about an idealized rabbit population.</p>

    <ul>

      <li>You begin with one male and one female rabbit, just born.

      <li>Rabbits reach sexual maturity in one month.

      <li>Once they reach sexual maturity, female rabbits give birth
      to one male and one female rabbit each month.

      <li>Rabbits never die.

    </ul>

    <p>Fibonacci wondered, "How many <em>pairs</em> of rabbits would
    you have after <i>n</i> months passed?"</p>

    <ul>

      <li><b>Month 1.</b> One pair, the original rabbits.

      <li><b>Month 2.</b> One pair, the rabbits have mated but not
      given birth.

      <li><b>Month 3.</b> Two pairs, one sexually mature and one just
      born.

      <li><b>Month 4.</b> Three pairs, two sexually mature and one
      just born.

      <li><b>Month 5.</b> five  pairs, three sexually mature and two
      just born.

    </ul>

    <p>As you can see, this forms a numeric sequence that we now call
    the Fibonacci number series.</p>

    <p>If we need to compute large Fibonacci numbers, the recursive
    formula is too inefficient. Instead, we use <a target="_blank"
    href="https://mathworld.wolfram.com/BinetsFibonacciNumberFormula.html">Binet's
    Formula</a> to calculate <i>F</i>(<i>n</i>) directly.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-binet">
% import math
%
% def fib_e( n ):
%     if n &lt;= 0:
%         return 0
%     elif n == 1:
%         return 1
%     else:
%         sum = ( 1.0 + math.sqrt( 5 ) ) ** n
%         sum = sum - ( 1.0 - math.sqrt( 5 ) ) ** n
%         sum = sum / ( 2.0 ** n * math.sqrt( 5 ))
%         return round( sum )
      </div>
    </div>

    <p>If you're curious, <i>F</i>(100) = 3.542248481792631e+20. It
    would take about 4 years for rabbits to outnumber humans based on
    Fibonacci's scenario.</p>

  </div>
</div>


<h2 id="numpy">NumPy</h2>

<p><a href="https://www.numpy.org">NumPy</a> (numerical Python,
hereafter <em>numpy</em>, pronounced <em>num-pie</em>) is a library that
provides advanced mathematical operations involving statistics and
linear algebra. Our interest is mainly in numpy statistical
capabilities, since this will allow us to calculate things like mean,
variance, minimum, maximum, correlation, and covariance on lists of
numbers.</p>

<p>numpy's standard data type is an array: a sequence of numbers, all
of the same type. Arrays can be created in numerous ways. Common
examples include:</p>

<ul>

  <li>from a Python list,

  <li>in a pre-defined size containing zeros or ones, or

  <li>using numpy's <code>arange()</code> command, which is analogous
  to Python's <code>range()</code> command.

</ul>


<div class="code-flex-div">
  <div class="code-flex" id="code-numpy-array">
% import numpy
%
% arr = numpy.array( [ 2, 3, 4 ] )
% print( arr )
[2 3 4]
% print( type( arr ) )
&lt;class 'numpy.ndarray'&gt;
% arr = numpy.zeros( 5 )
% print( arr )
[0. 0. 0. 0. 0.]
% arr = numpy.arange( 10, 30, 5 )
% print( arr )
[10 15 20 25]
  </div>
</div>


<p>numpy also supports <em>multidimensional arrays</em>. For example, a
table is a 2-dimensional (2D) array with rows and columns. A data cube
is a 3-dimensional array with rows, columns, and slices. We restrict
ourselves to 1D and 2D arrays in this tutorial. The easiest way to
define a 2D array in numpy is to provide a list of equal-length
sublists to the <code>array()</code> operator, one sublist for each
row in the array.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-numpy-ndarray">
% import numpy
%
% arr = numpy.array( [ [ 1, 2 ], [ 4, 5 ], [ 7, 8 ] ] )
% print( arr )
[[1 2]
 [4 5]
 [7 8]]
% print( arr[ 1 ] )
[4 5]
% print( arr[ 1, 1 ] )
5
% print( arr[ -1 ] )
[7 8]
% print( arr[ 1: 3 ] )
[[4 5]
 [7 8]]
% print( arr[ 0: 2, 1 ] )
[2 5]
%
% print( arr.shape )
(3, 2)
% arr = arr.reshape( 2, 3 )
% print( arr )
[[1 2 4]
 [5 7 8]
% print( arr.shape )
(2, 3)
  </div>
</div>


<p>numpy provides access to elements of an array using the standard
indexing operator <code>[&nbsp;]</code>. Negative indices and slicing
can be used, similar to Python lists. It's also possible to ask for
the <em>shape</em> of an array using <code>shape()</code>, which
returns the number of rows for a 1D array, or a tuple with the number
of rows and columns for a 2D array. It's even possible
to <em>reshape</em> an array using <code>reshape()</code>, rearranging
the array's values into a new (row, column) configuration.</p>

<p>As mentioned above, one of the main advantages of using numpy is
access to a number of statistical operations. A few common examples
are listed below. A full list of numpy's <a target="_blank"
href="https://numpy.org/doc/stable/reference/routines.statistics.html">statistical
operators</a> is available online.</p>

<ul>

  <li><code>numpy.mean( arr )</code>, the arithmetic mean of an
  array's values.

  <li><code>numpy.median( arr )</code>, the median of an array's
  values.

  <li><code>numpy.var( arr )</code>, the variance of an array's
  values.

  <li><code>numpy.std( arr )</code>, the population standard deviation
  of an array's values.

  <li><code>numpy.amax( arr )</code>, the maximum value in an array.

  <li><code>numpy.amin( arr )</code>, the minimum value in an array.

  <li><code>numpy.histogram( arr, b )</code>, build a histogram of the
  array's values with <code>b</code> bins; numpy returns a two-valued
  tuple: the first value an array of the number of values in each bin,
  the second contains an array of the boundary values that separate
  the bins.

</ul>

<div class="code-flex-div">
  <div class="code-flex" id="code-numpy-arange">
% import numpy
%
% arr = numpy.arange( 0, 500, 2 )
% print( arr.size )
250
% hist = numpy.histogram( arr, 10 )
% print( hist )
(array([25, 25, 25, 25, 25, 25, 25, 25, 25, 25]), array([ 0. , 49.8, 99.6, 149.4, 199.2, 249. , 298.8, 348.6, 398.4, 448.2, 498. ])) 
  </div>
</div>


<p>(Another use for numpy is to <a target="_blank"
href="https://numpy.org/doc/stable/reference/routines.linalg.html">perform
linear algebra operations</a>. Although less common in the analytics
program, numpy's ability to compute eigenvectors, invert matrices, or
solve systems of equations is very powerful.)


<h2 id="pandas">pandas</h2>

<p>The <a target="_blank" href="https://pandas.pydata.org">pandas
(Python Data Analysis) library</a> builds on numpy, offering an
extended set of data manipulation and analysis tools. pandas is built
on a few basic data types (or <em>data structures</em>, as they're
called in pandas), together with operations on data stored using these
types.</p>


<h3>Series</h3>

<p>One of pandas's fundamental data types is
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">a
<code>Series</code>, a 1D labelled array</a>. You can think of this as
a numpy array with an explicit label attached to each data value. The
collection of labels is called the data's <em>index</em>.</p>

<p>A Series can be created in numerous ways: from Python lists, from a
numpy array, or even from a Python dictionary.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-series">
% import numpy
% import pandas
%
% s = pandas.Series( [ 1, 2, 3 ], [ 'a', 'b', 'c' ] )
% print( s )
a   1
b   2
c   3
dtype: int64
%
% d = { 'a': 3.14, 'b': 6.29, 'x': -1.34 }
% t = pandas.Series( d )
% print( t )
a    3.14
x   -1.34
b    6.29
dtype: float64
%
% a = numpy.array( [ 4.5, 5.5, 6.5 ] )
% u = pandas.Series( a )
% print( u )
0   4.5
1   5.5
2   6.5
dtype: float64
  </div>
</div>


<p>Data in a Series can be queried using numeric indices and slicing,
just like with Python lists and numpy arrays. It can also be accessed
using index labels, similar to a Python dictionary.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-index">
% import numpy
% import pandas
%
% s = pandas.Series( [ 1, 2, 3 ], [ 'a', 'b', 'c' ] )
% print( s[ 1 ] )
2
% print( s[ 'c' ] )
3
% print( s[ 1: 3 ] )
b   2
c   3
dtype: int64
  </div>
</div>

<p>More importantly, we can index by applying a conditional operation
to every data element in a Series. This returns a new boolean Series
with the result of applying the conditional (<code>True</code>
or <code>False</code>) at each element position. The boolean Series is
then used to select only those data elements that passed the
conditional. For example, suppose we wanted to select the elements in
a Series whose values were greater than 2, but less than 5.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-cond-index">
% import numpy
% import pandas
%
% s = pandas.Series( [ 1, 2, 3, 4, 5 ] )
% idx = ( s &gt; 2 ) & ( s &lt; 5 )
% print( idx )
0   False
1   False
2    True
3    True
4   False
dtype: bool
% s_sub = s[ idx ]
% print( s_sub )
2   3
3   4
dtype: int64
  </div>
</div>

<p>This is how pandas interprets these commands.</p>

<ul>

  <li>A Series <code>s</code> with values <code>[&nbsp;1, 2, 3, 4,
  5&nbsp;]</code> is created.

  <li><code>( s  2 )</code> creates a boolean Series
  with <code>True</code> at locations where <code>s</code> is greater
  than 2, and <code>False</code> otherwise: <code>[&nbsp;False, False,
  True, True, True&nbsp;]</code>

  <li><code>( s &lt; 5 )</code> creates a boolean Series
  with <code>True</code> at locations where <code>s</code> is less
  than 5, and <code>False</code> otherwise: <code>[&nbsp;True, True,
  True, True, False&nbsp;]</code>

  <li>The <code>&amp;</code> (boolean and) operator combines the two
  boolean Series, returning <code>True</code> if the values in both
  Series are <code>True</code>, and <code>False</code> otherwise:
  <code>[&nbsp;False, False, True, True, False&nbsp;]</code>

  <li>Passing this boolean Series as an index to <code>s</code>
  returns the data elements in <code>s</code> whose corresponding
  index is <code>True</code>, that is, the third and fourth entries
  <code>[&nbsp;3, 4&nbsp;]</code>. This represents all the entries in
  <code>s</code> with a value greater than 2, but less than 5.

</ul>

<p>Because pandas data have labels, we can perform operations that
use <em>data alignment</em>. pandas will look at the variables
involved in an operation, and automatically "match up" data elements
with common labels.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-align">
% import numpy
% import pandas
%
% s = pandas.Series( [ 1, 2, 3 ], [ 'a', 'b', 'c' ] )
% t = pandas.Series( { 'a': 3.14, 'b': 6.29, 'x': -1.34 } )
% print( s + t )
a    4.14
b    8.29
c     NaN
x     NaN
dtype: float64
    </div>
</div>


<p>When we apply <code>s + t</code>, pandas sees data with
labels <code>a</code> and <code>b</code> in both variables, so it
knows to add those entries together. If data with a common label is
missing from any of the Series, the result is undefined, and set to
<code>NaN</code> (not a number).</p>


<h3>DataFrame</h3>

<p>A <code>DataFrame</code> is the second fundamental data type in
pandas.
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">A
DataFrame is a 2D table</a> whose columns and rows are both
labelled. You can think of a DataFrame as a table of Series arrays,
one for each column in the DataFrame. Row labels are still referred to
as the index, and column labels are simply called the
<em>columns</em>.

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-dataframe">
% import numpy
% import pandas
%
% d = [ [ 1, 2 ], [ 4, 5 ], [ 7, 8 ] ]
% df = pandas.DataFrame( d, index = [ 'a', 'b', 'c' ], columns = [ 'C1', 'C2' ] )
% print( df )
   C1  C2
a   1   2
b   4   5
c   7   8
  </div>
</div>


<p>Indexing is more complicated with DataFrames, since there are two
separate dimensions: the columns and the rows. The following operators
are used to index a DataFrame variable.</p>

<ul>

  <li><code>[&nbsp;c&nbsp;]</code>, return all the values in the column
  named <code>c</code>.

  <li><code>loc[&nbsp;r&nbsp;]</code>, return all the values in the row
  named <code>r</code>.

  <li><code>loc[&nbsp;r, c&nbsp;]</code>, return the value in the row
  named <code>r</code> and the column named <code>c</code>.

  <li><code>iloc[&nbsp;i&nbsp;]</code>, return all the values in the
  DataFrame's <code>i</code>-ith row.

</ul>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-index">
% import numpy
% import pandas
%
% d = [ [ 1, 2 ], [ 4, 5 ], [ 7, 8 ] ]
% df = pandas.DataFrame( d, index = [ 'a', 'b', 'c' ], columns = [ 'C1', 'C2' ] )
% print( df[ 'C2' ] )
a   2
b   5
c   8
Name: C2, dtype: int64
% print( df[ 'C1' ][ 'b' ] )
4
% print( df.loc[ 'b' ] )
C1   4
C2   5
Name: b, dtype: int64
% print( df.iloc[ 2 ] )
C1   7
C2   8
Name: c, dtype: int64
  </div>
</div>


<div id="dataframe-accordion" class="detail">
  <h3>Slicing DataFrames</h3>
  <div>
    <p>It's possible to use slicing to return multiple rows (and/or
    columns), rather than a single result. This must be done in a
    particular way to properly handle and differentiate between rows
    and columns, however, making it more complex than slicing lists or
    arrays.

    <ul>

      <li><code>df[&nbsp;r0: r1&nbsp;]</code>, return all the values
      in <b>rows</b> <code>r0</code>
      to <code>r1</code> <em>inclusive</em>.

      <div style="margin-bottom: 0.3em;"></div>

      <b>Note 1.</b> When you index with <code>[&nbsp;r0:
      r1&nbsp;]</code> it returns <b>rows</b>, not columns like it
      does when you only provide a single index.

      <div style="margin-bottom: 0.3em;"></div>

      <b>Note 2.</b> Slicing a DataFrame includes all rows
      from <code>r0</code> up to <b>and
      including</b> <code>r1</code>. This is different from slicing on
      a list or an array, which would exclude <code>r1</code> from the
      result.

      <div style="margin-bottom: 0.3em;"></div>

      <li><code>df.loc[&nbsp;r0: r1&nbsp;]</code>, return all the
      values in rows <code>r0</code> to <code>r1</code> inclusive.

      <li><code>df.loc[&nbsp;r0: r1, c0: c1&nbsp;]</code>, return the
      values in rows <code>r0</code> to <code>r1</code> inclusive, and
      columns <code>c0</code> to <code>c1</code> inclusive within
      those rows.

      <li><code>df.loc[&nbsp;:, c0: c1&nbsp;]</code>, return all the
      values in columns <code>c0</code> to <code>c1</code> inclusive
      (<code>[&nbsp;:&nbsp;]</code> is the <em>null slice</em>, and
      means "select everything on this dimension").

    </ul>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="code-dataframe-slice">
% import numpy
% import pandas
%
% d = [ [ 1, 2, -1 ], [ 4, 5, -2 ], [ 7, 8, -3 ] ]
% df = pandas.DataFrame( d, index = [ 'a', 'b', 'c' ], columns = [ 'C1', 'C2', 'C3' ] )
% print( df[ 'b': 'c' ] )
   C1  C2  C3
b   4   5  -2
c   7   8  -3
% print( df.loc[ 'a': 'b' ] )
   C1  C2  C3
a   1   2  -1
b   4   5  -2
% print( df.loc[ :, 'C2': 'C3' ] )
   C2  C3
a   2  -1
b   5  -2
c   8  -3
% print( df.loc[ 'a': 'b', 'C1': 'C2' ] )
   C1  C2
a   1   2
b   4   5
      </div>
    </div>
  </div>
</div>


<p>You can insert and delete rows and columns from a DataFrame, or
change values at specific index positions, using the same indexing
operations.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-dataframe-manip">
% import numpy
% import pandas
%
% d = [ [ 1, 2 ], [ 4, 5 ], [ 7, 8 ] ]
% df = pandas.DataFrame( d, index = [ 'a', 'b', 'c' ], columns = [ 'C1', 'C2' ] )
%
% s = pandas.Series( { 'C1': 9, 'C2': 11 } )
% s.name = 'd'
% df = df.append( s )
% print( df )
  C1  C2
a  1   2
b  4   5
c  7   8
d  9  11
%
% df[ 'C3' ] = df[ 'C1' ] + df[ 'C2' ]
% df[ 'C1' ][ 'a' ] = 99
%
% print( df )
   C1  C2  C3
a  99   2   3
b   4   5   9
c   7   8  15
d   9  11  20
  </div>
</div>


<div id="pandas-max-pop-accordion" class="detail">
  <h3>Maximum Population Revisited</h3>
  <div>

    <p>To better exemplify the power of pandas, recall the previous
    problem of identifying the city with the maximum estimated 2011
    population from a Census Bureau CSV file. Using pandas, we could
    identify the city with the largest population using only a few
    lines of code.</p>

    <div class="code-flex-div">
      <div class="code-flex-accordion" id="var-pandas-max-pop">
% import numpy
% import pandas
%
% pop = pandas.read_csv( 'pop.csv', encoding='latin1' )
% pop.describe()
            SUMLEV        STATE    POPESTIMATE2011
count 81746.000000 81746.000000       81746.000000
mean    114.380936    30.592849       15929.926565
std      47.934468    13.416473      244346.744241
min      40.000000     1.000000           0.000000
25%      61.000000    19.000000         339.000000
50%     157.000000    29.000000        1209.000000
75%     157.000000    41.000000        5041.000000
max     172.000000    56.000000    37691912.000000
%
% idx = pop[ 'NAME' ] != pop[ 'STNAME' ]
% city_pop = pop[ idx ]
% i = city_pop[ 'POPESTIMATE2011' ].idxmax()
%
% nm = pop[ 'NAME' ][ i ]
% state = pop[ 'STNAME' ][ i ]
% max_pop = pop[ 'POPESTIMATE2011' ][ i ]
% print( nm, 'in state', state, 'has population', max_pop )
Los Angeles County in state California has population 9889056
      </div>
    </div>

    <p>This is how pandas interprets these commands.</p>

    <ul>

      <li><code>read_csv()</code> reads the population CSV file,
      storing it in a DataFrame called <code>pop</code>. The header
      line in the CSV file is used to assign labels to each
      column. Default row indices 0&ndash;81745 are assigned to each
      row.

      <li><code>describe()</code> reports descriptive statistics on a
      DataFrame. The values are returned as a DataFrame, if you want
      to store or index them.

      <li>To ignore state population rows, we build an index
      Series <code>idx</code> that contains <code>True</code> for rows
      that <b>do not</b> contain state populations, <code>False</code>
      otherwise.

      <li><code>idx</code> is used to select city population rows,
      stored in a new DataFrame <code>city_pop</code>.

      <li><code>city_pop[&nbsp;'POPESTIMATE2011'&nbsp;]</code> selects
      the column with estimated 2011 population
      values. Applying <code>idxmax()</code> to this column returns
      the label of the row with the maximum value, that is, the row
      with the largest estimated 2011 city population.

      <li>The label from <code>idxmax()</code> is used to index the
      original <code>pop</code> DataFrame, identifying the largest
      city's name, state, and population.

    </ul>
  </div>
</div>


<h2 id="sklearn">scikit-learn</h2>

<p><code>scikit-learn</code> (<code>sklearn</code>) is an open-source
Python library that is used extensively for analytic tasks. Built as
a <a href="https://en.wikipedia.org/wiki/Scikit-learn"
target="_blank">Google Summer of Code project by David Cournapeau</a>,
the term <code>scikit</code> derives from the notion that the package
provides a toolkit for <a href="https://www.scipy.org"
target="_blank"><code>scipy</code></a>, a scientific Python library
similar to <code>numpy</code>.</p>

<p>Originally, <code>sklearn</code> was designed for machine learning
(ML), and retains an extensive list of algorithms to implement
numerous ML techniques. More recently, <code>sklearn</code> has
extended to include dimension reduction, model parameter comparison
and validation, and preprocessing such as text analytics, data
standardization, non-linear transformations, categorical encoding, and
imputation. The combination of base Python and <code>sklearn</code>
are often used as an all-purpose preprocessor and derivation engine,
transforming raw input into a format designed for more sophisticated
follow-on analytics.</p>

<p><code>sklearn</code> is built on top of <code>numpy</code>, so it
uses numpy's <code>Array</code> as its basic sequence data
structure. This also means that it integrates well
with <code>pandas</code>, which is also built on top
of <code>numpy</code>.</p>


<h3>Classification</h3>

<p>Classification is a supervised learning approach that analyzes
samples with known classes. It uses one subset of the samples to train
a model, and a second subset to test the model's predictive
accuracy. The model uses <em>predictor</em> variables to estimate the
<em>target</em> class. The model can then be used to suggest a class
for unclassified samples.</p>

<p>There is often confusion about the differences between
classification and clustering. The following table identifies some of
the characteristics that separate these two approaches.</p>

<div style="width: 80%; margin-left: 10%;">
  <table style="margin-left: auto; margin-right: auto;">
  <caption>
    <b>scikit-learn: classification <em>vs.</em> clustering</b>
  </caption>

  <tr>
    <th>Criteria</th>
    <th>Classification</th>
    <th>Clustering</th>
  </tr>

  <tr class="even">
    <td style="text-align: center;"><b>Supervised</b></td>
    <td style="width: 42.5%;">Yes</td>
    <td style="width: 42.5%;">No</td>
  </tr>

  <tr class="odd">
    <td style="text-align: center;"><b>Use Case</b></td>
    <td>Classify new samples into estimated classes</td>
    <td>Suggest groups of samples based on similar data patterns</td>
  </tr>

  <tr class="even">
    <td style="text-align: center;"><b>Algorithms</b></td>
    <td>Linear regression, ridge regression, lasso, elastic net, OMP,
    Bayesian regression, logistic regression, SGD, perceptron, LDA, QDA,
    kernel ridge regression, SVM, SVC, nearest neighbours, Gaussian
    process regression, naive Bayes, decision trees, random forest,
    XGBoost</td>
    <td><em>k</em>-means, affinity propagation, mean-shift, spectral,
    Ward, agglomerative, DBSCAN, Gaussian mixture, Birch</td>
  </tr>

  <tr class="odd">
    <td style="text-align: center;"><b>Required Data</b></td>
    <td>Labelled samples from a set of classes</td>
    <td>Unlabelled samples</td>
  </tr>

</table>
</div>


<p>As an example of classification, we will use the Iris dataset,
which is available in <code>sklearn</code>'s <code>datasets</code>
module. Recall
that <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set"
target="_blank">Fisher's Iris dataset</a> contains petal and sepal
lengths and widths for 50 samples of 3 classes of irises: Iris setosa,
Iris virginica, and Iris versicolor. This represents an excellent
example dataset, since it has already been pre-classified into one of
the three iris types.</p>

<p>To begin, we import <code>numpy</code> and <code>sklearn</code>,
load the Iris dataset, and explore it by printing its features
(predictor variables) and target classes. We then create the predictor
matrix using all samples' petal lengths and widths, as well as the
corresponding target iris types.

If you prefer, you can <a href="notebook/classify.ipynb"
target="_blank">download a Jupyter notebook with the classification
code</a> from here.</p>


<div class="code-flex-div">
  <div class="code-flex" id="code-sklearn-iris">
% import numpy as np
% from sklearn import datasets
%
% iris = datasets.load_iris()
%
% # Print some descriptive statistics about the data and target
% print( 'Data features:', iris.feature_names )
Data features: ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
%
% print( 'Target classes:', iris.target_names )
Target classes: ['setosa' 'versicolor' 'virginica']
%
% print( 'Truncated data array:', iris.data[ :5 ], '\n---\n', iris.data[ -5: ] )
Truncated data array:
[[5.1 3.5 1.4 0.2]
[4.9 3. 1.4 0.2]
[4.7 3.2 1.3 0.2]
[4.6 3.1 1.5 0.2]
[5. 3.6 1.4 0.2]]
---
[[6.7 3. 5.2 2.3]
[6.3 2.5 5. 1.9]
[6.5 3. 5.2 2. ]
[6.2 3.4 5.4 2.3]
[5.9 3. 5.1 1.8]]
%
% print( 'Target labels:', iris.target )
Target labels: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
%
%
% # Set predictors X as petal length and width
% # Set target y as iris class
% X = iris.data[ :, [ 2, 3 ] ]
% y = iris.target
    </div>
</div>

<p>Notice that at the end of the code block we set the predictor
matrix <code>X</code> to include all petal lengths and widths, and the
target vector <code>y</code> to include the corresponding iris types
for each predictor sample. You might wonder, why are we only using
petal length and width, and not any sepal values? If you do some
initial exploration of the data by building scatterplots of petal
length versus width and sepal length versus width, you can see that
petal data does a better job of separating the three classes, versus
sepal data.</p>


<div class="code-flex-div">
  <table style="margin: 2em auto 0px auto;">

  <tr>
  <td style="padding: 0px 8px 0px 0px; border: 0px solid black">
    <div class="code-flex" id="code-plot-petal">
% # Plot petal data to inspect how samples cluster
%
% import numpy as np
% from sklearn import datasets
% from matplotlib.colors import ListedColormap
% import matplotlib.pyplot as plt
%
% # Use petal length and width as predictor variables
% iris = datasets.load_iris()
% X = iris.data[ :, [ 2, 3 ] ]
% y = iris.target
%
% markers = ( 's', 'x', 'o' )
% colors = ( 'red', 'blue', 'lightgreen' )
% cmap = ListedColormap( colors[ :len( np.unique( y ) ) ] )
%
% fig = plt.figure()
% for i, col in enumerate( np.unique( y ) ):
%     plt.scatter(\
%     x=X[ y==col, 0 ], y=X[ y==col, 1 ],\
%     c=[cmap( i )], marker=markers[ i ],\
%     edgecolor='black', label=col )
% plt.xlabel( 'Petal Length (cm)' )
% plt.ylabel( 'Petal Width (cm)' )
% plt.legend( ['setosa', 'versicolor', 'virginica' ] )
% fig.suptitle( 'Petal Length vs. Width' )
    </div>
  </td>

  <td style="padding: 0px 8px 0px 0px; border: 0px solid black">
    <div class="code-flex" id="code-plot-sepal">
% # Plot sepal data to inspect how samples cluster
%
% import numpy as np
% from sklearn import datasets
% from matplotlib.colors import ListedColormap
% import matplotlib.pyplot as plt
%
% # Use sepal length and width as predictor variables
% iris = datasets.load_iris()
% X = iris.data[ :, [ 0, 2 ] ]
% y = iris.target
%
% markers = ( 's', 'x', 'o' )
% colors = ( 'red', 'blue', 'lightgreen' )
% cmap = ListedColormap( colors[ :len( np.unique( y ) ) ] )
%
% fig = plt.figure()
% for i, col in enumerate( np.unique( y ) ):
%     plt.scatter(\
%     x=X[ y==col, 0 ], y=X[ y==col, 1 ],\
%     c=[cmap( i )], marker=markers[ i ],\
%     edgecolor='black', label=col )
% plt.xlabel( 'Sepal Length (cm)' )
% plt.ylabel( 'Sepal Width (cm)' )
% plt.legend( ['setosa', 'versicolor', 'virginica' ] )
% fig.suptitle( 'Sepal Length vs. Width' )
    </div>
  </td>
  </tr>

  <tr>
  <td style="padding: 0px 8px 0px 0px; border: 0px solid black">
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 500px;">
      <img style="width: 90%; max-width: 900px;" src="../figs/python/petal-scatterplot.png" alt="petal-scatterplot">
    </div>
  </td>
  <td style="padding: 0px 8px 0px 0px; border: 0px solid black">
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 500px;">
      <img style="width: 90%; max-width: 900px;" src="../figs/python/sepal-scatterplot.png" alt="sepal-scatterplot">
    </div>
  </td>
  </tr>

</table>
</div>

<p>Once the predictor and target <code>X</code> and <code>y</code> are
set, we need to split them into a <em>test</em> subset and a
<em>training</em> subset. We will build our predictive model using the
training data, then test its accuracy using the test
data. <code>sklearn</code> provides built-in support to divide a
labelled dataset using its <code>test_train_split()</code> function.

<div class="code-flex-div">
  <div class="code-flex" id="code-predict-train-test">
% # Split data in training and test
%
% from sklearn.model_selection import train_test_split
%
% X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.3, stratify=y )
%
% print( 'Number of training samples:', X_train.shape[ 0 ] )
% print( 'Number of test samples:', X_test.shape[ 0 ] )

Number of training samples: 105
Number of test samples: 45

% uniq, n = np.unique( y, return_counts = True )
% print( 'Frequency of class values in y:', uniq, n )
% uniq, n = np.unique( y_train, return_counts = True )
% print( 'Frequency of class values in training dataset:', uniq, n )
% uniq, n = np.unique( y_test, return_counts = True )
% print( 'Frequency of class values in test dataset:', uniq, n )

Frequency of class values in y: [0 1 2] [50 50 50]
Frequency of class values in training dataset: [0 1 2] [35 35 35]
Frequency of class values in test dataset: [0 1 2 ] [15 15 15]
  </div>
</div>

<p><code>test_size</code> defines the relative size of the test
dataset to the training dataset, in this example, 70% for training,
30% for test. By default, <code>test_train_split</code> randomly
assigns samples to the training and test
datasets. The <code>stratify</code> parameter
forces <code>test_train_split</code> to produce training and test sets
with a proportion of target classes <code>y</code> in each set
equivalent to the original target dataset. That is, the class
proportions in each set are equivalent to the relative frequency of
each class in the original target dataset.</p>

<p>Next, we want
to <a href="https://scikit-learn.org/stable/auto_examples/preprocessing/plot_scaling_importance.html",
target="_blank">standardize our predictive variables</a> in the
training and test datasets, to try to fit the assumptions of many
modelling algorithms of a mean of zero and equal variance for each
variable. <code>sklearn</code>'s
<code>StandardScaler</code> can be used to achieve this, assuming
the underlying predictor variable distribution is bell-shaped. Centering
and scaling happen on a per-variable basis, with mean and standard deviation
saved within the <code>StandardScaler</code> variable for later use
during variable transformation.</p>

<p>Note that, if your distribution is skewed, per Dr. Race's
preprocessing instructions, you would not want to use a (&mu;=0,
&sigma;=1) standardization. Instead, you can use
the <code>MinMaxScaler</code> to scale each feature based on its
min&ndash;max range.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-standard-scale">
% from sklearn.preprocessing import StandardScaler
%
% # Fit a standard scalar to the predictive variables
% sc = StandardScaler()
% sc.fit( X_train )
%
% # Transform predictive datasets based on the scalar
% X_train_std = sc.transform( X_train )
% X_test_std = sc.transform( X_test )
%
% # Join (stack) the data training and test sets into a sequence of rows
% X_comb_std = np.vstack( ( X_train_std, X_test_std ) )
%
% # Join (stack) the target training and test sets into a 1D horizontal column
% y_comb = np.hstack( ( y_train, y_test ) )
%
% # Print some descriptive statistics about training and target
% print( 'Standardized data array:' )
% print( X_comb_std[ :5 ], '\n---\n', X_comb_std[ -5: ] )
% print( 'Target array:' )
% print( y_comb )

Standardized data array:
[[ 0.20072503 0.12914551]
[-1.28030022 -1.31903956]
[-1.33726273 -1.31903956]
[ 0.71338762 0.65575826]
[-1.22333771 -1.31903956]]
---
[[ 0.77035013 0.52410507]
[ 0.77035013 0.91906464]
[ 1.05516268 1.3140242 ]
[ 0.42857507 0.12914551]
[-1.28030022 -1.31903956]]
Target array:
[1 0 0 1 0 0 1 1 1 0 1 2 0 1 0 0 2 1 2 1 2 0 0 1 0 1 2 0 2 0 1 0 0 2 2 0 0 0 0 1 0 2 0 0 2 0 1 2 2 2 2 2 1 1 1 1 0 1 2 1 1 1 0 1 1 1 2 0 2 2 0 1 0 1 2 2 2 2 2 2 1 2 0 0 0 2 0 1 1 0 2 2 0 2 0 1 2 1 1 2 1 2 1 2 2 1 2 0 0 2 2 1 2 1 0 1 1 2 0 0 1 0 1 2 2 2 1 0 1 2 0 0 0 1 0 0 1 0 1 2 0 2 2 2 1 1 2 2 1 0]
  </div>
</div>

<p>At this point, the data has been preprocessed into a state that is
ready for building classification models. <code>sklearn</code>
supports many different modeling algorithms. We will explore four of
these: <code>Perceptron</code> (neural net), <code>SVC</code> (support
vector classification), <code>KNN</code> (<em>k</em> nearest
neighbours), and random forest, an ensemble decision tree
approach.</p>

<p>One of the useful advantages of using <code>sklearn</code>
exclusively is that classification follows a fairly standard set of
steps, regardless of the specific algorithm being used.  We will look
at <code>Perceptron</code> in some detail, then provide examples for
the other three methods, with discussion limited to the specific
differences (if any) for each.</p>

<p>The <code>Perceptron</code> classifier is sometimes described as a
simple feed-forward single-layer neural net.  In visual terms,
consider a perceptron approach as one that attempts to choose linear
boundaries that separate classes from one another, to the extent that
this is possible. Technically, the perceptron method uses an input
vector of attribute values and a <em>weight vector</em> of similar
length (together with a <em>bias</em>) to compute a value for the
input. Based on that value, one of the available classes is
suggested. If the suggestion is incorrect, the weight vector is
updated. This continues until some type of convergence is
achieved.</p>

<p>In <code>sklearn</code>, the <code>Perceptron</code> algorithm
falls within the <code>linear_model</code> group. The following code
builds a perceptron prediction model for our Iris dataset example.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-nn-predict">
% from sklearn.linear_model import Perceptron
% from sklearn.metrics import accuracy_score
%
% # Build a perceptron model based on training data, then classify test data
% ppn = Perceptron( max_iter=40, eta0=0.1, random_state=0 )
% ppn.fit( X_train_std, y_train )
% y_pred = ppn.predict( X_test_std )
%
% # Print results of classification
% print( 'Perceptron Model:' )
% print( 'Misclassified samples: %d' % ( y_test != y_pred ).sum() )
% print( 'Accuracy on training data: {:.2f} (out of 1)'.format( ppn.score( X_train_std, y_train ) ) )
% print( 'Accuracy on test data: {:.2f} (out of 1)'.format( ppn.score( X_test_std, y_test ) ) )

Perceptron Model:
Misclassified samples: 5
Accuracy on training data: 0.90 (out of 1)
Accuracy on test data: 0.89 (out of 1)
  </div>
</div>

<p>As you can see, the code to build a prediction model is simple once
the proper datasets have been defined and prepared. We build a
<code>Perceptron</code> prediction model, fit it to the training data,
and predict target classes with the <code>predict()</code> function.
The Perceptron model constructor supports numerous options, including:

<ul>

<li><code><b>max_iter</b></code>, the maximum number of passes
(epochs) over the training data to attempt to achieve convergence,
default=5;</li>

<li><code><b>eta0</b></code>, a constant by which updates are
multiplied, default=1; and</li>

<li><code><b>random_state</b></code>, the seed for the random number
generator to use when shuffling data, a different seed will produce a
different sequence of random numbers.

</ul>

<p>Next, we use <code>ppn</code>'s <code>score()</code> function to
report overall classification accuracy on both the training target
dataset <code>y_train</code> and the test target
dataset <code>y_test</code> (90% and 89% respectively in our
example).</p>

<p>If we instead wanted to use an <code>SVC</code> classifier, only
minor modifications would be needed to the perceptron code.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-svc-predict">
% from sklearn.svm import SVC
%
% # Build an SVC model based on training data, then classify test data
% svc = SVC( kernel='rbf', gamma=0.1, C=1.0, random_state=0 )
% svc.fit( X_train_std, y_train )
% y_pred = svc.predict( X_test_std )
%
% # Print results of classification
% print( 'SVC Model:' )
% print( 'Misclassified samples: %d' % ( y_test != y_pred ).sum() )
% print( 'Accuracy on training data: {:.2f} (out of 1)'.format( svc.score( X_train_std, y_train ) ) )
% print( 'Accuracy on test data: {:.2f} (out of 1)'.format( svc.score( X_test_std, y_test ) ) )
  </div>
</div>

<p>As you can see, building and evaluating the model is nearly
identical to the perceptron example. Next, let's look at <em>k</em>
nearest neighbours.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-knn-predict">
% from sklearn.neighbors import KNeighborsClassifier
%
% # Build a KNN model based on training data, then classify test data
% knn = KNeighborsClassifier( n_neighbors=5, p=2, metric='minkowski' )
% knn.fit( X_train_std, y_train )
% y_pred = knn.predict( X_test_std )
%
% # Print results of classification
% print( 'KNN Model:' )
% print( 'Misclassified samples: %d' % ( y_test != y_pred ).sum() )
% print( 'Accuracy on training data: {:.2f} (out of 1)'.format( knn.score( X_train_std, y_train ) ) )
% print( 'Accuracy on test data: {:.2f} (out of 1)'.format( knn.score( X_test_std, y_test ) ) )

KNN Model:
Misclassified samples: 0
Accuracy on training data: 0.96 (out of 1)
Accuracy on test data: 1.00 (out of 1)
  </div>
</div>

<p>Finally, here is code to run a random forest classifier on the iris
data.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-forest-predict">
% from sklearn.ensemble import RandomForestClassifier
%
% # Build a random forest model based on training data, then classify test data
% rf = RandomForestClassifier( n_estimators=100, oob_score=True )
% rf.fit( X_train_std, y_train )
% y_pred = rf.predict( X_test_std )
%
% # Print results of classification
% print( 'Random Forest Model:' )
% print( 'Misclassified samples: %d' % ( y_test != y_pred ).sum() )
% print( 'Accuracy on training data: {:.2f} (out of 1)'.format( rf.score( X_train_std, y_train ) ) )
% print( 'Accuracy on test data: {:.2f} (out of 1)'.format( rf.score( X_test_std, y_test ) ) )
% print( 'Out-of-bag accuracy: {:.2f} (out of 1)'.format( rf.oob_score_ ) )

Random Forest Model:
Misclassified samples: 1
Accuracy on training data: 0.99 (out of 1)
Accuracy on test data: 0.96 (out of 1)
Out-of-bag accuracy: 0.95 (out of 1)
Out-of-bag accuracy: 0.95 (out of 1)<br>
  </div>
</div>

<p>As we discussed above, each approach subdivides 2D space (in our
case, since we have two predictor variables) into regions representing
the three different iris types. Below are images, along with the
dataset samples, showing the class regions for each of the four
example algorithms. Samples outlined in black represent the test
data <code>y</code>, while the remaining samples represent the
training data <code>X</code>.</p>

<div class="code-flex-div">
  <table style="margin: 2em auto 0px auto; border: 1px solid var(--tbl-bd);">

  <tr>
    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/ppn.png" alt="ppn">
    </div>
    </td>
    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/svc.png" alt="svc">
    </div>
    </td>
  </tr>

  <tr>
    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/knn.png" alt="knn">
    </div>
    </td>
    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/forest.png" alt="forest">
    </div>
    </td>
  </tr>

  </table>
</div>


<h3>Clustering</h3>

<p>Clustering attempts to divide a set of samples into clusters based
on data properties or patterns identified within the samples.
Clustering is <em>unsupervised</em>; no pre-labeled data is required
to generate clusters.</p>

<p>During our examination of <code>sklearn</code>'s clustering
algorithms, we will continue to use the Iris dataset. 
<code>X</code> represents 150 samples defined by petal length and
width, and <code>y</code> represents the class (iris type) for each
corresponding sample. Since clustering is unsupervised, we will only
use <code>y</code> to calculate accuracies. It will not be needed
during the clustering process itself.</p>

<p>We will provide examples for three common clustering algorithms:
<em>k</em>-means, agglomerative, and DBSCAN. Similar to
classification, a common pattern is used by <code>sklearn</code>,
regardless of which clustering algorithm is applied. We will
study <em>k</em>-means, as well as some of its strengths and
limitations, in some depth.  Agglomerative clustering and DBSCAN will
be presented, but with a focus on their differences in implementation,
requirements, and the type of data they are designed to analyze.

If you prefer, you can <a href="notebook/cluster.ipynb"
target="_blank">download a Jupyter notebook with the clustering
code</a> from here.</p>

<p><b>Accuracy.</b> One issue to consider is how to measure
accuracy. The idea of determining how well an algorithm splits the
Iris dataset into three groups corresponds to how well cluster IDs are
attached to elements in the target <code>y</code>. In a perfect
scenario, elements with target
value <code>y<sub>i</sub></code> would have identical cluster
IDs <code>c<sub>j</sub></code> (remember, in general
<code>y<sub>i</sub> &ne; c<sub>j</sub></code>).  We can assume the
most frequent <code>c<sub>j</sub></code> is the cluster ID assigned
to elements in class <code>y<sub>i</sub></code>. Any other cluster IDs
can be considered errors.</p>

<p>The following <code>misclassify()</code> function takes target
classes <code>tg</code> and corresponding cluster
IDs <code>pred</code>, returning a total misclassification count and a
list of misclassifications per target class as a list. Although we
will not explain the function in detail, its comments should help
interested readers understand how we are attempting to determine
overall cluster accuracy.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-cluster-acc">
% from collections import Counter
%
% def misclassify( tg, pred ):
% # Try to determine number of misclassified elements during clustering
% #
% # tg: Target class
% # pred: Predicted cluster ID
%
%     # Get number of classes, clusters, create a "misclassified" label
%     tg_n = len( set( tg ) )
%     pr_n = len( set( pred ) )
%     miss = pr_n + 1
%
%     # Initialize errors per class, set of cluster IDs seen
%     err = [ 0 ] * tg_n
%     clust_ID = []
%
%     # For each target class, compute cluster ID errors
%     for i in range( 0, tg_n ):
%         # Grab subset of targets, predictions for current class
%         beg = i * 50
%         tg_sub = tg[ beg: beg + 50 ]
%         pr_sub = pred[ beg: beg + 50 ]
%
%         # "Mark as error" any cluster ID already assigned to a class
%         for j,val in enumerate( pr_sub ):
%         if val in clust_ID: pr_sub[ j ] = miss
%
%         # Build match vector as target class ID minus cluster ID
%         # Copy over errors from cluster ID vector
%         match = tg_sub - pr_sub
%         for j,val in enumerate( pr_sub ):
%             match[ j ] = miss if val == miss else match[ j ]
%
%         # Build dict of IDs, descending by frequency
%         count = Counter( match )
%         freq = count.most_common()
%
%         # Find most frequent ID that is not "miss" error
%         max_freq = miss
%         for val in freq:
%             if val[ 0 ] != miss:
%                 max_freq = val[ 0 ]
%                 err[ i ] = 50 - val[ 1 ]
%                 break
%
%         # If all entries "miss" error, all entries are incorrect
%         if max_freq == miss:
%             err[ i ] = 50
%
%             # Copy miss to entire subrange of original prediction list
%             for j in range( 0, len( pr_sub ) ):
%                 pred[ j + beg ] = miss
%             continue
%
%         max_ID = miss
%         for j,val in enumerate( match ):
%             if val != max_freq: pred[ j + beg ] = miss
%             if val == max_freq: max_ID = j
%
%         # Add cluster ID to list of cluster IDs seen so far
%         clust_ID = clust_ID + [ pr_sub[ max_ID ] ]
%
%     # Return total errors, error per class
%     return sum(err), err
  </div>
</div>


<p><em>k</em>-means clustering divides a dataset into <em>k</em>
clusters. Theoretically, the goal of <em>k</em>-means is to partition
a set of <em>n</em> samples <code>X = (<em>x</em><sub>1</sub><em>,
x</em><sub>2</sub></em>, ..., <em>x<sub>n</sub></em>)</code>
into <em>k</em> subsets
<code>S = {<em>s</em><sub>1</sub><em>, s</em><sub>2</sub>, ...,
<em>s<sub>k</sub></em>}</code> such that within-cluster sum of squares
(WCSS or variance) is minimized,</p>

<div style="font-size: 90%;">
\[
\text{arg$\,$min}_S \sum_{i=1}^{k} \sum_{x \in S_i} ||x-\mu_i||^2 = \text{arg$\,$min}_S \sum_{i=1}^{k} |S_i|\,\text{Var}\,S_i
\]
</div>

<p>where <em>&mu;<sub>i</sub></em> is the mean of the samples
in <em>S<sub>i</sub></em>.

<p>The basic approach for performing <em>k</em>-means (often known
as <a href="https://en.wikipedia.org/wiki/Lloyd%27s_algorithm"
target="_blank">Lloyd's algorithm</a>) uses the following set of
steps:</p>

<ol>

<li> Randomly choose <em>k</em> cluster <em>centroids</em> within the
bounding region of the dataset.</li>

<li> Assign each sample to the closest centroid, producing <em>k</em>
clusters.

<li> Compute the centroids for the clusters, producing a new set
of <em>k</em> centroids.

<li> Re-assign samples as needed based on the new centroid positions.

<li> Continue iterating in this manner until reasonable convergence
is achieved, or until a fixed number of iterations have been performed.

</ol>

<p>The obvious problem with <em>k</em>-means is how to
choose <em>k</em>, the "correct" number of clusters to generate. In
our example, we know there are three classes of irises, so we will ask
for <em>k=3</em> clusters. If the proper number of clusters is
unknown,
the <a href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)"
target="_blank">elbow method</a> is often used: start at <em>k=2</em>,
compute the sum of squared errors (SSE) between each point and its
centroid, move to <em>k=3</em>, and continue until we find a minimum
SSE. The <em>k</em> that produces this is selected at the "optimal"
number of clusters. Notice that this choice is based completely on
mathematical considerations, and may not necessarily match the
semantics of the data being clustered, particularly since neither WCSS
nor SSE consider data context.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-k-means-cluster">
% from sklearn.cluster import KMeans
%
% # Partition data into three clusters
% km = KMeans( n_clusters = 3, random_state = 101 )
% km.fit( X )
% y_pred = km.predict( X )
%
% n = len( y_pred )
% err = misclassify( y, y_pred )
%
% # Print accuracy results
% print( 'k-Means Clustering:' )
% print( 'Misassigned samples:', err[ 0 ] )
% print( 'Accuracy: {:.2f} (out of 1)'.format( ( n - err[ 0 ] ) / n ) )

k-Means Clustering:
Misassigned samples: 6
Accuracy: 0.96 (out of 1)
  </div>
</div>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 500px;">
  <img style="width: 80%; max-width: 432px;" src="../figs/python/k-mean.png" alt="k-means">
  <div style="height: 1em;"></div>
</div>

<p>Remember that, because the initial centroids are randomly chosen,
<em>k</em>-means results are stochastic (not stable). Rerunning the
algorithm with a different <code>random_state</code> seed value can
produce different results, misassigned sample counts, and
accuracies.</p>

<p>Another common clustering approach is agglomerative clustering,
which builds a hierarchical, bottom-up collection of clusters. Here,
we repeatedly take the two most similar elements and combine them into
a cluster until <code>X</code> forms a single cluster. What we mean by
"most similar" is critical to how the clusters will form, and is based
on a <em>linkage</em> strategy and a distance metric (<em>e.g.</em>,
Euclidean, Manhattan, Hamming, cosine, and so on). In all cases, we
assume a single element forms a 1-element cluster. Linkage strategies
include:

<ul>

<li><a href="https://en.wikipedia.org/wiki/Single-linkage_clustering"
target="_blank"><b>Single-linkage</b></a>. Combine the closest pair of
clusters <em>A</em> and <em>B</em>, where
dist(&thinsp;<em>A,&thinsp;B&thinsp;</em>) is defined either by the
distance between the centroids of <em>A</em> and <em>B</em>, or by the
distance between the two closest elements in <em>A</em>
and <em>B</em>.</li>

<li><a href="https://en.wikipedia.org/wiki/Complete-linkage_clustering"
target="_blank"><b>Complete-linkage</b></a>. For all cluster pairs
(&thinsp;<em>A,&thinsp;B</em>&thinsp;), calculate

dist(&thinsp;<em>A, B</em>&thinsp;)&thinsp;=&thinsp;max[&thinsp;dist(&thinsp;<em>e<sub>A</sub>,&thinsp;e<sub>B</sub></em>&thinsp;)&thinsp;]&thinsp;&forall;&thinsp;<em>e<sub>A</sub></em>&thinsp;&in;&thinsp;<em>A</em>,&thinsp;<em>e<sub>B</sub></em>&thinsp;&in;&thinsp;<em>B</em>

(the two elements from <em>A</em> and <em>B</em> farthest apart from
one another). Combine the two clusters with the smallest
dist(&thinsp;<em>A,B</em>&thinsp;).</li>

<li><a href="https://en.wikipedia.org/wiki/UPGMA"
target="_blank"><b>Average-linkage</b></a>. For all cluster pairs
(&thinsp;<em>A,&thinsp;B</em>&thinsp;), calculate

dist(&thinsp;<em>A,&thinsp;B</em>&thinsp;)&thinsp;=&thinsp;avg[&thinsp;dist(&thinsp;<em>e<sub>A</sub>,&thinsp;e<sub>B</sub></em>&thinsp;)&thinsp;]&thinsp;&forall;&thinsp;<em>e<sub>A</sub></em>&thinsp;&in;&thinsp;<em>A</em>,&thinsp;<em>e<sub>B</sub></em>&thinsp;&in;&thinsp;<em>B</em>

(the average distance between all
(&thinsp;<em>e<sub>A</sub>&thinsp;,e<sub>B</sub></em>&thinsp;)
pairs). Combine the two clusters with the smallest
dist(&thinsp;<em>A,&thinsp;B</em>&thinsp;).</li>

<li><a href="https://en.wikipedia.org/wiki/Ward%27s_method"
target="_blank"><b>Ward</b></a>. Combine the two clusters that
minimize the increase in total within-cluster variance after merging,
where variance is defined as the squared distance from an element to
its cluster centroid.</li>

</ul>

<p><code>sklearn</code>
supports <code>ward</code>, <code>complete</code>,
and <code>average</code> when the agglomerative clustering object is
created, with a default of Ward.</p>

<div class="ex-div">
% from sklearn.cluster import AgglomerativeClustering
%
% Clustering( n_clusters=3, linkage='average' )
</div>

<p>The sequence of combinations performed produces
a <em>dendrogram</em>, a tree with the root at the top (a single
cluster containing <code>X</code>), and each split generating two
children as we walk down the dendrogram. To choose <em>k</em>
clusters, we simply pick the <em>k</em> clusters that are closest to
the root cluster.</p>

<p>Agglomerative clustering is implemented in a nearly identical
manner to <em>k</em>-means. The one difference is that you can fit a
model, or fit and return
predictions. The <code>AgglomerativeClustering</code> module does not
provide a separate <code>predict()</code> function.

<div class="code-flex-div">
  <div class="code-flex" id="code-agglom-cluster">
% from sklearn.cluster import AgglomerativeClustering
%
% # Partition data into three clusters
% agg = AgglomerativeClustering( n_clusters = 3 )
% y_pred = agg.fit_predict( X )
%
% n = len( y_pred )
% err = misclassify( y, y_pred )
%
% # Print accuracy results
% print( 'Agglomerative Clustering:' )
% print( 'Misassigned samples:', err[ 0 ] )
% print( 'Accuracy: {:.2f} (out of 1)'.format( ( n - err[ 0 ] ) / n ) )

Agglomerative Clustering:
Misassigned samples: 6
Accuracy: 0.96 (out of 1)
  </div>
</div>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 500px;">
  <img style="width: 80%; max-width: 432px;" src="../figs/python/agglomerative.png" alt="agglomerative">
  <div style="height: 1em;"></div>
</div>


<p>Our final example uses DBSCAN (Density-BaSed Clustering of
Applications with Noise). DBSCAN is a spatial algorithm that clusters
points that are "closely packed" to one another. Specifically, basic
DBSCAN uses the following definitions to build its clusters.

<ul>

<li>A cluster must contain at least <em>min</em> points.

<li>Points <em>p</em> and <em>q</em> are neighbours if they lie within
distance &epsilon; of one another.

<li>Point <em>p</em> is core if at least <em>min</em> points are
within &epsilon; of <em>p</em>. Those points are <em>directly
reachable</em> from <em>p</em>.

<li>Point <em>q</em> is directly reachable from <em>p</em>
if <em>q</em> is within &epsilon; of <em>p</em> and <em>p</em> is
core.

<li>Point <em>q</em> is reachable from <em>p</em> if there exists a
path <em>p<sub>1</sub></em>, ..., <em>p<sub>n</sub></em>
with <em>p<sub>1</sub>&thinsp;=&thinsp;p</em>,
<em>p<sub>n</sub>&thinsp;=&thinsp;q</em>, and
all <em>p<sub>i</sub></em> are core with the possible exception
of <em>p<sub>n</sub>&thinsp;=&thinsp;q</em>.

<li>Any point not reachable from any other point is an outlier.

</ul>

<p>Given these definitions, core point <em>p</em> forms a cluster with
all points (core or non-core) that can reach <em>p</em>. Every cluster
contains at least one core point. Non-core points form the cluster's
edge, since they cannot be used to reach additional points.</p>

<p>Implementation of <code>DBSCAN</code> is identical to
<code>AgglomerativeClustering</code>, except we do not specify a
number of clusters. This is determined automatically by DBSCAN's
&epsilon; and <em>min</em> values (<code>eps</code>
and <code>min_samples</code> arguments during the creation of a DBSCAN
object, with defaults of 0.5 and 5, respectively.)</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-dbscan-cluster">
% from sklearn.cluster import DBSCAN
%
% # Partition data into three clusters
% db = DBSCAN()
% y_pred = db.fit_predict( X )
%
% n = len( y_pred )
% err = misclassify( y, y_pred )
%
% # Print accuracy results
% print( 'DBSCAN Clustering:' )
% print( 'Misassigned samples:', err[ 0 ] )
% print( 'Accuracy: {:.2f} (out of 1)'.format( ( n - err[ 0 ] ) / n ) )

Agglomerative Clustering:
Misassigned samples: 50
Accuracy: 0.67 (out of 1)
  </div>
</div>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 500px;">
  <img style="width: 80%; max-width: 432px;" src="../figs/python/dbscan.png" alt="dbscan">
  <div style="height: 1em;"></div>
</div>


<p>Notice that DBSCAN produces a much larger misassignment error than
either <em>k</em>-means or agglomerative clustering. Examining the
cluster plot makes the issue clear: DBSCAN merged iris classes 2 and 3
together, producing one class that was perfectly clustered, and one
that was entirely misassigned. This points to a common issue with
DBSCAN in particular, and spatial clustering algorithms in general:
when semantically different groups of elements overlap, they are often
merged, since DBSCAN has no notion of <em>what</em> each element
represents, only distances, cluster sizes, and how they compare to
&epsilon; and <em>min</em>.</p>


<h3>Imputation</h3>

<p>Imputation of values in a dataset is another function provided
by <code>sklearn</code>. It is common to receive raw data files with
missing values, errors, or other types of incorrect values.
Imputation allows you to replace these values through techniques like
estimation, replacement with constants, or replacement with
statistically derived results on the values that are available.

If you prefer, you can <a href="notebook/impute.ipynb"
target="_blank">download a Jupyter notebook with the imputation
code</a> from here.</p>

<p><code>sklearn</code> provides an <code>SimpleImputer</code> that,
in its default form, implements three basic strategies for imputing
missing values: (1) use the column's mean; (2) use the column's
median; or (3) use the column's most frequent
value. The <code>axis</code> argument can modify
this: <code>axis=0</code> for columns, <code>axis=1</code> for rows
(default is <code>axis=0</code>.) These approaches are reasonable,
although not particularly sophisticated.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-sklearn-impute">
% import numpy as np
% from sklearn.impute import SimpleImputer
%
% X = [[np.nan,2,3,1,5,2], [6,np.nan,1,8,2,1], [7,6,np.nan,np.nan,7,np.nan]]
% print( 'X: ', X )
%
% imp = SimpleImputer( missing_values=np.nan, strategy='mean' )
% imp.fit( X )
%
% print( 'Impute w/mean:' )
% print( imp.transform( X ) )
%
% imp = SimpleImputer( missing_values=np.nan, strategy='most_frequent' )
% imp.fit( X )
%
% print( 'Impute w/most frequent:' )
% print( imp.transform( X ) )

X: [[nan, 2, 3, 1, 5, 2], [6, nan, 1, 8, 2, 1], [7, 6, nan, nan, 7, nan]]
Impute columns w/mean:
[[6.5 2. 3. 1. 5. 2. ]
 [6. 4. 1. 8. 2. 1. ]
 [7. 6. 2. 4.5 7. 1.5]
Impute rows w/most frequent
[[6. 2. 3. 1. 5. 2.]
 [6. 2. 1. 8. 2. 1.]
 [7. 6. 1. 1. 7. 1.]]
  </div>
</div>


<p>Rather than identifying missing values, you may want to apply a
custom transformer to "derive" new values based on existing values
in your dataset. <code>sklearn</code> allows this through its
<code>FunctionTransformer</code> object. To use it, we build a
<code>FunctionTransformer</code> with a specific function attached to
it. We can then use that function to transform all values in a
numpy <code>Array</code>, just like any built-in
<code>sklearn</code> transformer.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-sklearn-impute-custom">
% import numpy as np
% from sklearn.preprocessing import FunctionTransformer
%
% X = [[0,1,2],[3,4,5],[6,7,8]]
% print( 'X:', X )
%
% trans = FunctionTransformer( np.log1p )
% print( 'Transform using 1+log(p):' )
% print( trans.transform( X ) )

X: [[0, 1, 2], [3, 4, 5], [6, 7, 8]]
Transform using 1+log(p):
[[0. 0.69314718 1.09861229]
 [1.38629436 1.60943791 1.79175947]
 [1.94591015 2.07944154 2.19722458]]
  </div>
</div>

<p><code>pandas</code> also provides a number of functions
specifically designed to handle NaN and perform different types of
correction or imputation. For example, <code>pandas</code>'s
<code>isnull()</code> function returns <code>True</code> for NaN
entries, and <code>False</code> otherwise. We can take advantage of
the face that <code>True</code> evaluates to 1 and <code>False</code>
evaluates to 0 to count the number of NaNs in a data frame. The
following examples will use a <a href="./construction-census.csv">U.S.
Census construction CSV file</a> to demonstrate <code>pandas</code>'s
capabilities. We will work with the <code>EMP</code> column, which is
a Census definition for number of employees.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-impute">
% import pandas as pd
% import os
%
% os.chdir( 'C:/users/healey/Downloads' )
% census_df = pd.read_csv( 'construction-census.csv', sep=',', skiprows=[ 1 ] )
%
% # Count NaN, True=1, False=0, so sum True/False isnull() value list
% nan_n = census_df.isnull().values.sum()
% print( nan_n, 'values out of', census_df.size, 'values total, {:.2f}%'.format( nan_n / census_df.size * 100 ) )

25905 values out of 170100 values total, 15.23%
  </div>
</div>

<p>One common use of <code>isnull</code> is to identify and remove
columns from a data frame that are entirely NaN. This is important,
because these types of columns can interfere with
normal <code>pandas</code> analytic operations.</p>

<p>Notice that in all the following examples, we make a copy of the
data frame with the <code>copy</code> command. This ensures that we
do not change any of the values in the original data frame. You
cannot copy a data frame with <code>df_cp = df</code>. If you do this,
<code>df_cp</code> will simply <em>reference</em> <code>df</code>.
Referencing means the variables <code>df</code> and <code>df_cp</code>
with both point to the same data frame, so any changes through either
will affect the original data. The <code>copy()</code> function ensures
an entirely new data frame is created, containing values identical to
the original data frame.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-var-ref">
% import os
%
% # First, make a copy of the original data frame
% os.chdir( 'C:/users/healey/Downloads' )
% census_df = pd.read_csv( 'construction-census.csv', sep=',', skiprows=[ 1 ] )
% df_cp = census_df.copy()
%
% # Check first 15 columns, remove if entirely NaN
% row_n = df_cp.shape[ 0 ]
% col_nm = list( df_cp )[ :15 ]
%
% for nm in col_nm:
%     nan_n = df_cp[ nm ].isnull().values.sum()
%     if nan_n == row_n:
%         print( nm, 'has only NaN values, removing...' )
%         del df_cp[ nm ]
%     elif nan_n > 0:
%         print( '{:s}, {:d} NaN values ({:.2f}%)'.format( nm, nan_n, ( nan_n / row_n * 100 ) ) )
%     else:
%         print( nm, 'has no NaN values' )

GEO.id has no NaN values
GEO.id2 has no NaN values
GEO.display-label has no NaN values
GEO.annotation.id has only NaN values, removing...
NAICS.id has no NaN values
NAICS.display-label has no NaN values
NAICS.annotation.id has only NaN values, removing...
YEAR.id has no NaN values
ESTAB has no NaN values
ESTAB_S has no NaN values
EMP, 38 NaN values (2.41%)
EMP_S, 38 NaN values (2.41%)
PAYANN, 57 NaN values (3.62%)
PAYANN_S, 57 NaN values (3.62%)
BENEFIT, 61 NaN values (3.87%)
  </div>
</div>

<p>It's not necessary that columns be entirely NaN to be removed. It
would be easy, for example, to remove any column whose percentage of
NaN was over some reasonable threshold, for example, 60%, with
<code>if nan_n &gt; 0.6 * row_n:</code>.</p>

<p>In terms of replacing NaNs, <code>pandas</code> can fill them with
a constant value with <em>ffill()</em>, moving the most recent
non-NaN value forward, or <em>bfill()</em>, moving the next non-NaN
value backwards.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-NaN">
% import os
%
% # First, make a copy of the original data frame
% os.chdir( 'C:/users/healey/Downloads' )
% census_df = pd.read_csv( 'construction-census.csv', sep=',', skiprows=[ 1 ] )
% df_cp = census_df.copy()
%
% # We can fill NaNs in a column with a constant value
% df_cp = census_df.copy()
%
% print( 'Original EMP column:' )
% print( df_cp.iloc[ 217:223 ][ 'EMP' ] )
%
% print( 'Constant value imputation:' )
% df_cp[ 'EMP' ] = df_cp[ 'EMP' ].fillna( 0 )
% print( 'Column EMP now has', df_cp[ 'EMP' ].isnull().values.sum(), 'NaNs' )
% print( df_cp.iloc[ 217:223 ][ 'EMP' ] )
%
% # We can backfill (move next value back) or pad (more last value forward)
% df_cp = census_df.copy()
% print( 'Backfill value imputation:' )
% df_cp[ 'EMP' ] = df_cp[ 'EMP' ].bfill()
% print( df_cp.iloc[ 217:223 ][ 'EMP' ] )
%
% df_cp = census_df.copy()
% print( 'Pad value imputation:' )
% df_cp[ 'EMP' ] = df_cp[ 'EMP' ].pad()
% print( df_cp.iloc[ 217:223 ][ 'EMP' ] )

Original EMP column:
217 659.0
218 NaN
219 431.0
220 944.0
221 NaN
222 1143.0
Name: EMP, dtype: float64
Constant value imputation:
Column EMP now has 0 NaNs
217 659.0
218 0.0
219 431.0
220 944.0
221 0.0
222 1143.0
Name: EMP, dtype: float64
Backfill value imputation:
217 659.0
218 431.0
219 431.0
220 944.0
221 1143.0
222 1143.0
Name: EMP, dtype: float64
Pad value imputation:
217 659.0
218 659.0
219 431.0
220 944.0
221 944.0
222 1143.0
Name: EMP, dtype: float64
  </div>
</div>

<p>Finally, if we integrate into <code>scipy</code>, the scientific
Python toolkit <code>sklearn</code> extends, we can gain access to a
larger number of interpolation methods. For example, rather than
performing a linear interpolation of missing values, we can use a
cubic spline or a second or third-degree polynomial to produce a
"smooth" interpolation of both available and missing values.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-pandas-interpolate">
% from scipy.interpolate import interp1d
% import matplotlib.pyplot as plt
% import os
% import numpy as np
%
% # More recent versions of pandas support new methods of interpolation through scipy
%
% # First, make a copy of the original data frame
% os.chdir( 'C:/users/healey/Downloads' )
% census_df = pd.read_csv( 'construction-census.csv', sep=',', skiprows=[ 1 ] )
% df_cp = census_df.copy()
%
% # Original subset of EMP values with numerous NaNs
% df_cp = census_df.copy()
% nan_df = df_cp[ 'EMP' ].isnull()
%
% fig = plt.figure()
% fig.suptitle( 'Employee Count by Sample ID' )
% plt.xlabel( 'Sample ID' )
% plt.ylabel( 'Number of Employees' )
% df_cp.iloc[ 219:247 ][ 'EMP' ].plot()
% plt.show()
%
% # Replace NaN with linear interpolation
% df_cp = census_df.copy()
% df_cp[ 'EMP' ] = df_cp[ 'EMP' ].interpolate( method='linear' )
%
% fig = plt.figure()
% fig.suptitle( 'Linear vs. Cubic Interpolation of Employee Count' )
% plt.xlabel( 'Sample ID' )
% plt.ylabel( 'Number of Employees' )
% df_cp.iloc[ 219:247 ][ 'EMP' ].plot()
%
% # Replace NaN with cubic interpolation
% df_cp = census_df.copy()
% df_cp[ 'EMP' ] = df_cp[ 'EMP' ].interpolate( method='cubic' )
% x = df_cp.iloc[ 219:247 ][ 'EMP' ].index
% y = df_cp.iloc[ 219:247 ][ 'EMP' ]
% f = interp1d( x, y, kind='cubic' )
%
% x = np.linspace( 219, 246, num=50, endpoint=True )
% plt.plot( x, f( x ), '--' )
% plt.legend( [ 'linear', 'cubic' ] )
% plt.show()    
  </div>
</div>


<div class="code-flex-div">
  <table style="margin: 2em auto 0px auto; border: 1px solid var(--tbl-bd);">

  <tr>
    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/orig-EMP.png" alt="orig-EMP">
    </div>
    </td>

    <td>
    <div class="code-img" style="background-color: #ffffff; width:80%; max-width: 550px;">
      <img style="width: 90%; max-width: 550px;" src="../figs/python/lin-cubic-EMP.png" alt="lin-cubic-EMP">
    </div>
    </td>
  </tr>
  
  </table>
</div>


<p><a href="https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html"
target="_blank"><code>interp1d</code></a> supports numerous additional
interpolation methods
like <code>polynomials</code>, <code>splines</code>,
and <code>nearest</code>, <code>previous</code>,
and <code>next</code>, which produce stair-step interpolation plots. It
is also possible to interpolate multivariate data superimposed on a
uniform grid using
<code>scipy</code>'s <code>griddata()</code> function.</p>

<h2 id="web">Web Parsing</h2>

<p>The ability read and parse web page content is often very useful,
since data is commonly available on a web page, but in a format that's
not convenient to simply copy and paste.</p>

<p>Two Python libraries are used to simplify <em>web scraping:</em>
<a target="_blank"
href="https://docs.python.org/2/library/urllib.html">urllib</a> and
<a target="_blank"
href="https://www.crummy.com/software/BeautifulSoup/">BeautifulSoup
4</a>. urllib supports posting HTTP requests to a web server. In our
case, this is normally a request for HTML content of a target web
page. BeautifulSoup parses HTML into a <em>parse tree</em>, then
provides operations that allow you to find specific information within
the tree, for example, all the HTML links, or text attached to an HTML
ID in the document.</p>

<p>These are the steps you would follow to read and parse a web
page.</p>

<ul>

  <li>Read the web page's HTML with <code>urllib.request.urlopen()</code>
  and <code>urllib.request.read()</code>.

  <li>Parse the web page's HTML with <code>BeautifulSoup()</code> into
  a parse tree.

  <li>Use BeautifulSoup's <em>navigation</em> commands to search for
  information within the parse tree.

</ul>

<p>This code will read the HTML for this tutorial, then return all the
HTML links in the document.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-beautiful-soup">
% import urllib
% from bs4 import BeautifulSoup
%
% url = urllib.request.urlopen( 'https://www.csc2.ncsu.edu/faculty/healey/msa/python/index.html' )
% doc = url.read()
% tree = BeautifulSoup( doc )
% links = tree.find_all( 'a' )
% for l in links:
%     print( l.get( 'href' ) )
%
https://www.csc2.ncsu.edu/faculty/healey
https://www.ncsu.edu
https://www.python.org
&hellip;<br>
https://www.crummy.com/software/BeautifulSoup
  </div>
</div>


<p>One you have a parse tree, most of your work will involve
navigating the tree to find the things you're looking
for. BeautifulSoup provides <a target="_blank"
href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigating-the-tree">numerous
operations to search within the tree</a>. This can be done by HTML
tag, by ID, by string value, and so on. This requires work on your
part, however.</p>

<ul>

  <li>You will need to look at the raw HTML to determine
  the <em>structure</em> of the web page, that is, which HTML elements
  contain the data you're looking for
  (<em>e.g.</em>, <code>&lt;li&gt;</code> list item
  elements, <code>&lt;a href&gt;</code> link reference elements,
  elements with a specific <code>&lt;id&gt;</code>
  or <code>&lt;class&gt;</code> value, and so on).

  <li>Next, you will write Python code that uses BeautifulSoup to
  locate the target elements in the parse tree and extract the strings
  or values attached to those elements.

  <li>Once you have the data isolated, you can process it, or write it
  to an output file using file or CSV write operations.

</ul>

<p>For example, suppose you parsed this HTML page using BeautifulSoup
into a variable called <code>tree</code>. You could search for
the <code>div</code> with a specific <code>id</code> and the value
within that <code>div</code> as follows.

<div class="code-flex-div">
  <div class="code-flex" id="code-beautiful-soup-search">
% import urllib.request
% from bs4 import BeautifulSoup
%
% url = urllib.request.urlopen( 'https://www.csc2.ncsu.edu/faculty/healey/msa/python/index.html' )
% doc = url.read()
% tree = BeautifulSoup( doc, 'libhtml5' )
%
% div = tree.find( 'div', { 'class': 'footer' } )
% print( div )
&lt;div class="footer"&gt;
 Updated 03-Sep-24 &lt;span id="mod-date">01-Jan-01&lt;/span&gt;
&lt;/div&gt;
% span = div.find( 'span', { 'id': 'mod-date' } )
% print( span )
&lt;span id="mod-date"&gt;01-Jan-01&lt;/span&gt;
% span.getText()
'01-Jan-01'
  </div>
</div>

<p>Another common task is finding specific text within a web page.
For example, we might want to find all the paragraph (<code>&lt;p&gt;
... &lt;/p&gt;</code>) blocks that contain the string <code>Python</code>.
The obvious way to do this might be as follows.</p>

<div class="ex-div">
% tree.find_all( 'p', string='Python' )
[]
</div>

<p>Notice the result is an empty list, even though we know that the
string <code>Python</code> occurs multiple times within this
document. The problem is that the command above asks for a paragraph
block that contains EXACTLY the string <code>Python</code>, not a
paragraph block that contains at least one occurrence of the string
<code>Python</code>. To correct this, we pass the string as a
<i>regular expression</i>. There is insufficient space to delve into
the details of regular expressions (REs), but suffice it to say that
REs allow us to specify text with wildcards, options on parts of text
that occur in the string we're specifying, whether a string has to
start at the beginning or end of a line, the number of times a string
has to occur, and many other conditions. REs are extremely powerful,
and also fairly difficult to master. Moreover, although all programming
languages include support for REs, they often specify REs in slightly
different ways, making it difficult to port anything but the most simple
REs between languages.</p>

<p>Regardless of these issues, in our case it is very simple to
convert the from looking for a paragraph block with
exactly <code>Python</code> to a paragraph block
containing <code>Python</code> by simple asking the regular expression
module <code>re</code> to convert the explicit string into a RE that
represents "an occurrence of this string."</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-beautiful-soup-re">
% import re
%
% tree.find_all( 'p', string=re.compile( 'Python' ) )
[&lt;p&gt;Since Python is an interpreted language, individual lines of
code are converted to machine language and executed as they are
%
it works as it should.&lt;/p&gt;, &lt;p&gt;If you want a quick summary of
the steps I use to try to install Python packages in the Anaconda
environment, they're listed in order below&lt;/p&gt;]
  </div>
</div>

<p>Now, all paragraph blocks containing the term <code>Python</code>
are returned as elements of a list of results.</p>

<p>Understanding the structure of a web page can't be done for you.
It's something you'll need to complete as a first step for extracting
data from the web page. Perhaps more importantly, if a web page
doesn't have any useful structure, then it might be difficult (or
impossible) to isolate the data you're interested in. Usually,
however, web pages are built with a logical design. In these cases,
web scraping can save you significant time and effort over manually
copying or re-typing individual data values.</p>


<h2 id="practice">Practice Examples</h2>

<p>For practice, here are five Practical Python practice problems. A
short description of the problem is provided, with one possible
solution presented. I strongly recommend that you attempt your own
solution first, before looking at the one we provide.</p>

<h3>Cows and Bulls</h3>

<p>Create a program to play the game "cows and bulls." This is how
the game works.</p>

<ul>

<li>Randomly generate a 4-digit number in the range 0000 to 9999.

<li>Ask the user to guess the target number.

<li>For every digit the user guesses correctly <em>in the correct
position</em>, they receive a cow.

<li>For every digit the user guesses incorrectly, they receive a bull.

<li>Count how many guesses it takes for them to guess the target number.

</ul>

<p>For example, if the target was <code>7934</code> and the user
guessed <code>7274</code>, they would receive two cows for the
first <code>7</code> and the <code>4</code>, and two bulls.</p>

<p>A basic pseudocode outline for how you <i>might</i> want to structure
your program design could be something like this.</p>


<div id="cows-and-bulls-pseudocode-accordion" class="detail">
  <h3>Cows and Bulls Pseudocode</h3>
  <div>
    <ol>

    <li>Initialize the guesses to proper starting value.

    <li>Generate a target value to guess.

    <li>While the number of cows isn't four, loop.
      
    <li>Initialize the number of cows and bulls to proper starting values.

    <li>Get an input on the valid range of 0 through 9999.

    <li>Determine how many cows (correct digits in the correct
    position) and bulls (incorrect digits in a given position) the
    input contains, and report it to the user.

    <li>Update the number of guesses prior to returning to the while
    loop's condition.
  
    <li>Once the user has correctly guessed the target (four cows),
    you will exit the while loop. At this point you could end the game
    or ask if the user wants to play again.

    </ol>
  </div>
</div>


<p>Here is one solution to the Cows and Bulls game. If you're
practising, you should program your own solution before looking at
ours.</p>
 

<div id="cows-and-bulls-soln-accordion" class="detail">
  <h3>Cows and Bulls Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-cows-and-bulls-soln">
% import random
%
% def generate_tg():
%     """Generate a random four-digit string
%
%     Generate a random digit between 0-9999, then covert it to a string
%     with padded zeros 0000-9999, used for the cows and bulls guessing game.
%
%     Returns:
%     str: A four-character string in the range 0000-4000
%     """
%
%     v = random.randint( 0, 9999 )
%     v_str = f'{v:04d}'
%
%     return v_str
%
%
% def cmp_tg( inp, tg ):
%     """Compare target and input
%
%     Compare 4-digit target to 4-digit input, each matched digit is a cow, each
%     mismatched digit is a bull, return number of cows and bulls
%
%     Args:
%         inp (str): 4-digit input as a string 0000-9999
%         tg (str): 4-digit target as a string 0000-9999
%
%     Returns:
%         tuple (cow,bull): Number of cows and bulls as a tuple
%     """
%
%     # Ensure correct input and target format
%
%     inp_v = int( inp )
%     if len( inp ) != 4 or inp_v < 0 or inp_v > 9999:
%         print( 'cmp_tg(), incorrect input ' + inp + ', must be (0000-9999)' )
%         return (0,4)
%
%     tg_v = int( tg )
%     if len( tg ) != 4 or tg_v < 0 or tg_v > 9999:
%         print( 'cmp_tg(), incorrect target ' + tg + ', must be (0000-9999)' )
%         return (0,4)
%
%     # Initialize number of cows and bulls
%
%     cow = 0
%     bull = 0
%
%     # Loop over four digits, matches increase cows, mismatches increase bulls
%
%     for i in range( 0, 4 ):
%         if inp[ i ] == tg[ i ]:
%             cow = cow + 1
%         else:
%             bull = bull + 1
%
%     return (cow,bull)
%
% # Main game loop
%
% # Initialize cows, bulls, and number of guesses made
%
% cow = 0
% bull = 4
% guess = 0
%
% # Generate target to guess
%
% tg = generate_tg()
%
% # Continue until four cows, all input digits match target
%
% while cow != 4:
%
%     # Continue looping until valid input
%
%     inp = -1
%     while inp < 0 or inp > 9999:
%         inp = input( 'Enter a value between 0000 and 9999: ' )
%         try:
%             inp = int( inp )
%         except:
%             inp = 0
%
%         # Convert input to 4-digit string, get cows and bulls
%
%         inp_s = f'{inp:04d}'
%         cow,bull = cmp_tg( inp_s, tg )
%
%         guess += 1
%         print( f'{cow} cow(s), {bull} bull(s)' )
%
% print( f'It took you {guess} guess(es) to match the target' )
      </div>
    </div>
  </div>
</div>

<h3>Birthday Plots</h3>

<p>Create a program to assign a random number of birthdays to each
month, based on a maximum number of birthdays defined by the
user.


<div id="birthday-pseudocode-accordion" class="detail">
  <h3>Birthday Plot Pseudocode</h3>
  <div>
    <ol>

    <li>Initialize the number of birthdays for each month to zero.

    <li>Ask the user for the maximum number of birthdays for a month.

    <li>Assign a random number between 0 and month-maximum for each
    month.

    <li>Plot the results using <code>pyplot</code>.

    </ol>
  </div>
</div>


<p>Plot the number of birthdays in a bar chart
using <code>pyplot</code>. You can Google search for simple
instructions on how to import and use <code>pyplot</code> to plot a
bar graph (<i>e.g.,</i> from <a target="_blank"
href="https://www.geeksforgeeks.org/bar-plot-in-matplotlib/#">somewhere
like here</a>).</p>


<div id="birthday-soln-accordion" class="detail">
  <h3>Birthday Plot Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-cows-and-bulls-soln">
% import random
% import matplotlib.pyplot as plt
%
% def gen_birthday( bday_max):
%     """Generate birthdays for 12 months
%
%     Generate random number of birthdays for each of the twelve months, up to a
%     maximum number specified by the caller.
%
%     Args:
%         bday_max (int): An integer specifying the maximum number of birthdays for any month
%
%     Returns:
%         int list: A list of 12 non-negative integers, number of birthdays per month
% """
%
%     # Initialize birthdays to 0 for each month
%
%     bday_n = [ 0 ] * 12
%
%     # Ensure maximum birthday is valid
%
%     if bday_max &lt; 0:
%         print( 'gen_birthday(), maximum birthdays per month', bday_max, 'is invalid' )
%         return bday_n
%
%     for i in range( 0, 12 ):
%         bday_n[ i ] = random.randint( 0, bday_max )
%
%     return bday_n
%
% # Mainline
%
% # Define months
%
% month = [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ]
%
% # Generate random birthdays per month
%
% birthday = gen_birthday( 30 )
%
% # Use pyplot to plot birthday frequencies per month
% fig = plt.figure( figsize=(8,6) )
% bar = plt.bar( month, birthday, 0.75 )
%
% # Put frequency count on top of each bar
%
% for i,rect in enumerate( bar ):
%     ht = rect.get_height()
% plt.text( rect.get_x() + rect.get_width() / 2, ht, '%s' % ht, ha='center', va='bottom' )
%
% # Annotate the visualization
%
% plt.ylabel( 'Birthday(s)' )
% plt.grid( axis='y', linestyle='dotted' )
% plt.xlabel( 'Month' )
% plt.title( 'Birthday(s) per Month' )
% plt.show()
      </div>
    </div>
  </div>
</div>


<h3>Morse Code</h3>

<p><a href="https://morsecode.world/american/morse.html">Morse
code</a>, also known as American or Railroad Morse code, was developed
by Samuel F. B. Morse in the United States during the 1830s to
represent letters of the alphabet, numerals, and punctuation for
electric telegraphy using an arrangement of dots and dashes. The
original Morse code was further improved by Alfred Lewis Vail, Morse's
assistant and partner. Later use of Morse code in Europe identified
that it was insufficient to support non-English text like diacritical
marks.  This led to the development
of <a href="https://morsecode.world/international/morse2.html">International
Morse Code</a>, or Continental Morse Code as it is now known, in 1951.</p>

<p>The most famous Morse code sequence is probably the one for
<a href="https://en.wikipedia.org/wiki/SOS">SOS (Save Our Souls)</a>,
denoted dot-dot-dot, dash-dash-dash, dot-dot-dot. This is because
dot-dot-dot represents S, and dash-dash-dash represents O in Morse
code.</p>

<p>Create a program to decode a message into Morse code. Morse code
uses a sequence of dots and dashes to encode letters, numbers, and the
space character. The table below shows the conversion from American
Morse code to individual characters. A single space separates the
dot&ndash;dash pattern for each character. Three spaces represent a
space character. You can use period for dot and hyphen for dash in
your program.</p>

<div>
<table style="margin-left: auto; margin-right: auto;">

<tr>
  <th>Code</th>
  <th>Character</th>
  <th>Code</th>
  <th>Character</th>
  <th>Code</th>
  <th>Character</th>
  <th>Code</th>
  <th>Character</th>
</tr>

<tr class="even">
<td style="text-align: center;">&middot; &ndash;</td><td style="text-align: center;">A</td>
<td style="text-align: center;">&ndash; &middot; &middot; &middot;</td><td style="text-align: center;">B</td>
<td style="text-align: center;">&ndash; &middot; &ndash; &middot;</td><td style="text-align: center;">C</td>
<td style="text-align: center;">&ndash; &middot; &middot;</td><td style="text-align: center;">D</td>
</tr>

<tr class="odd">
<td style="text-align: center;">&middot;</td><td style="text-align: center;">E</td>
<td style="text-align: center;">&middot; &middot; &ndash; &middot;</td><td style="text-align: center;">F</td>
<td style="text-align: center;">&ndash; &ndash; &middot;</td><td style="text-align: center;">G</td>
<td style="text-align: center;">&middot; &middot; &middot; &middot;</td><td style="text-align: center;">H</td>
</tr>

<tr class="even">
<td style="text-align: center;">&middot; &middot;</td><td style="text-align: center;">I</td>
<td style="text-align: center;">&middot; &ndash; &ndash; &ndash;</td><td style="text-align: center;">J</td>
<td style="text-align: center;">&ndash; &middot; &ndash;</td><td style="text-align: center;">K</td>
<td style="text-align: center;">&middot; &ndash; &middot; &middot;</td><td style="text-align: center;">L</td>
</tr>

<tr class="odd">
<td style="text-align: center;">&ndash; &ndash;</td><td style="text-align: center;">M</td>
<td style="text-align: center;">&ndash; &middot;</td><td style="text-align: center;">N</td>
<td style="text-align: center;">&ndash; &ndash; &ndash;</td><td style="text-align: center;">O</td>
<td style="text-align: center;">&middot; &ndash; &ndash; &middot;</td><td style="text-align: center;">P</td>
</tr>

<tr class="even">
<td style="text-align: center;">&ndash; &ndash; &middot; &ndash;</td><td style="text-align: center;">Q</td>
<td style="text-align: center;">&middot; &ndash; &middot;</td><td style="text-align: center;">R</td>
<td style="text-align: center;">&middot; &middot; &middot;</td><td style="text-align: center;">S</td>
<td style="text-align: center;">&ndash;</td><td style="text-align: center;">T</td>
</tr>

<tr class="odd">
<td style="text-align: center;">&middot; &middot; &ndash;</td><td style="text-align: center;">U</td>
<td style="text-align: center;">&middot; &middot; &middot; &ndash;</td><td style="text-align: center;">V</td>
<td style="text-align: center;">&middot; &ndash; &ndash;</td><td style="text-align: center;">W</td>
<td style="text-align: center;">&ndash; &middot; &middot; &ndash;</td><td style="text-align: center;">X</td>
</tr>

<tr class="even">
<td style="text-align: center;">&ndash; &middot; &ndash; &ndash;</td><td style="text-align: center;">Y</td>
<td style="text-align: center;">&ndash; &ndash; &middot; &middot;</td><td style="text-align: center;">Z</td>
<td style="text-align: center;">&middot; &ndash; &ndash; &ndash; &ndash;</td><td style="text-align: center;">1</td>
<td style="text-align: center;">&middot; &middot; &ndash; &ndash; &ndash;</td><td style="text-align: center;">2</td>
</tr>

<tr class="odd">
<td style="text-align: center;">&middot; &middot; &middot; &ndash; &ndash;</td><td style="text-align: center;">3</td>
<td style="text-align: center;">&middot; &middot; &middot; &middot; &ndash;</td><td style="text-align: center;">4</td>
<td style="text-align: center;">&middot; &middot; &middot; &middot; &middot;</td><td style="text-align: center;">5</td>
<td style="text-align: center;">&ndash; &middot; &middot; &middot; &middot;</td><td style="text-align: center;">6</td>
</tr>

<tr class="even">
<td style="text-align: center;">&ndash; &ndash; &middot; &middot; &middot;</td><td style="text-align: center;">7</td>
<td style="text-align: center;">&ndash; &ndash; &ndash; &middot; &middot;</td><td style="text-align: center;">8</td>
<td style="text-align: center;">&ndash; &ndash; &ndash; &ndash; &middot;</td><td style="text-align: center;">9</td>
<td style="text-align: center;">&ndash; &ndash; &ndash; &ndash; &ndash;</td><td style="text-align: center;">0</td>
</tr>

</table>
</div>


<p>A basic pseudocode outline for how you <em>might</em> want to
structure your program design could be something like this.</p>


<div id="morse-code-pseudocode-accordion" class="detail">
  <h3>Morse Code Pseudocode</h3>
  <div>
    <ol>
    <li>Build a data structure to hold the letter-number to dot-dash
    conversions.

    <li>Ask the user to enter a sentence.

    <li>Convert the sentence to uppercase.

    <li>Use your data structure to convert each letter, number, and
    space to its equivalent dot-dash pattern. You can ignore anything
    that's not a letter, number, or space.

    <li>Print the conversion for the user.

    <li>Ask the user if they want to enter another sentence. Based on
    this, accept another sentence for conversion or quit the program.
	  
    </ol>
  </div>
</div>


<p>Here is one solution to the Morse code program. If you're
practising, you should program your own solution before looking at
ours.</p>


<div id="morse-code-soln-accordion" class="detail">
  <h3>Morse Code Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-morse-code-soln">
% code_cvt = {
%   "A": ".-",
%   "B": "-...",
%   "C": "-.-.",
%   "D": "-..",
%   "E": ".",
%   "F": "..-.",
%   "G": "--.",
%   "H": "....",
%   "I": "..",
%   "J": ".---",
%   "K": "-.-",
%   "L": ".-..",
%   "M": "--",
%   "N": "-.",
%   "O": "---",
%   "P": ".--.",
%   "Q": "--.-",
%   "R": ".-.",
%   "S": "...",
%   "T": "-",
%   "U": "..-",
%   "V": "...-",
%   "W": ".--",
%   "X": "-..-",
%   "Y": "-.--",
%   "Z": "--..",
%   " ": " ",
%   "1": ".----",
%   "2": "..---",
%   "3": "...--",
%   "4": "....-",
%   "5": ".....",
%   "6": "-....",
%   "7": "--...",
%   "8": "---..",
%   "9": "----.",
%   "0": "-----"
% }
%
% # Mainline
%
% cvt = True
%
% while cvt:
%     sent = input( 'Enter a sentence: ' )
%     sent = sent.upper()
%
%     code = ''
%     orig = ''
%     for c in sent:
%         c = c
%         if c in code_cvt.keys():
%             code = code + f'{code_cvt[ c ]:5s} '
%             if c == ' ':
%                 c = 'spc'
%             orig = orig + f'{c:5s} '
%
%     print( code )
%     print( orig )
%
%     inp = input( 'Do you want to enter another sentence (Y/N)? ' )
%     inp = inp.upper()
%
%     cvt = ( inp == 'Y' )
      </div>
    </div>
  </div>
</div>


<h3>Hangman</h3>

<p>Create a program to play the game "hangman." Here are instructions
on how the game works.</p>

<div style="text-align: center; margin: 0 auto;">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/cGOeiQfjYPk" title="YouTube video
player" frameborder="0" allow="accelerometer; autoplay;
clipboard-write; encrypted-media; gyroscope; picture-in-picture;
web-share" allowfullscreen></iframe>
</div>

<p>
Here is <a href="words.json">a JSON file</a> with a few thousand words
you can use to select from for the word to guess. You can read the contents
of this file into a list using the following code.
</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-json-word">
% import json
  
% with open( 'words.json' ) as inp:
%     data = json.load(inp)
% words = data[ "data" ]
  </div>
</div>

<p>
The basic game-play would follow a pattern something similar to this.
</p>


<div id="hangman-pseudocode-accordion" class="detail">
  <h3>Hangman Pseudocode</h3>
  <div>
    <ol>
    <li>Randomly choose a target word.

    <li>Present the user with the number of letters in the target
    word, and fill in any letters they'd properly guessed (initially
    there would be no letters guessed).

    <li>Ask the user to enter a letter that hasn't already been
    selected.

    <li>Determine if that letter is part of the target word that the
    user has not guessed yet.

    <li>Let the user know whether their guess was in the (remainder of
    the) word or not.

    <li>Update letters guessed correctly if a correct guess was made,
    or number of mistakes if an incorrect guess was made.

    <li>Continue until the player guesses the entire word (success),
    or until six incorrect guesses are made (failure).
    </ol>
  </div>
</div>


<p>Here is one solution to the Hangman game. If you're practising, you
should program your own solution before looking at ours.</p>
 

<div id="hangman-soln-accordion" class="detail">
  <h3>Hangman Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-hangman-soln">
% import json
% import random
%
% hangman = [  # Hangman progress as mistakes are made
% """
%  +--|
%     |
%     |
%     |
% """,
% """
%  +--|
%     |
%     |
% /   |
% """,
% """
%  +--|
%     |
%     |
% / \ |
% """,
% """
%  +--|
%     |
% /   |
% / \ |
% """,
% """
%  +--|
%     |
% /|  |
% / \ |
% """,
% """
%  +--|
%     |
% /|\ |
% / \ |
% """,
% """
%  +--|
%  o  |
% /|\ |
% / \ |
% """,
% ]
%
% def choose_word(word_list):
%     try:
%         return random.choice(word_list).lower()
%     except:
%         return "random"
%
% def new_game():
%     c = ""
%     while c != "Y" and c != "N":
%         c = input("Would you like to play again (Y or N)? ")
%         c = c.upper()
%     return c == "Y"
%
% def get_input(avail):
%     for c in avail:
%         print(f"{c} ", end="")
%     print()
%
%     c = input("Choose an available character: ")
%     c = c.upper()
%
%     if len(c) != 1:
%         print("You must choose a single character")
%     elif ord(c) &lt; ord("A") or ord(c) &gt; ord("Z"):
%         print('You must choose a character between "A" and "Z"')
%     elif c not in avail:
%         print(f"Character {c.upper()} has already been selected")
%
%     pos = avail.index(c)
%     avail[pos] = "_"
%
%     return (c.lower(), avail)
%
% def print_word(word, lbl=""):
%     if len(lbl) &gt; 0:
%         print(f"{lbl}: ", end="")
%
%     for c in word:
%         print(f"{c} ", end="")
%     print("\n")
%
% def read_word():
%     with open("words.json") as inp:
%         data = json.load(inp)
%
%     return data["data"] # Return word list
%
% # Mainline
%
% words = read_word()
%
% game = True
% while game:
%     tg_word = choose_word(words)
%     known_word = "_" * len(tg_word)
%
%     correct = 0
%     mistake = 0
%     avail = [chr(v) for v in range(ord("A"), ord("Z") + 1)]
%
%     print()
%     print(hangman[mistake])
%     print_word(known_word, "Word")
%     print()
%
%     while correct != len(tg_word) and mistake &lt; 6:
%         c, avail = get_input(avail)
%
%         if c not in tg_word:
%             mistake += 1
%             print(f"\n{c.upper()} is not in the word to guess. ", end="")
%             print(f"{6-mistake} guesses left.")
%         else:
%             print(f"\n{c.upper()} is in the word to guess.")
%
%             pos = -1
%             while c in tg_word[pos + 1 :]:
%                 pos = tg_word.index(c, pos + 1)
%                 known_word = ( known_word[0:pos] + c.upper() + known_word[pos + 1 :] )
%                 correct += 1
%
%         print(hangman[mistake])
%         print_word(known_word, "Word")
%         print()
%
%         if correct == len(tg_word):
%             print(f"Congratulations! You guessed the word {tg_word.upper()}")
%         elif mistake == 6:
%             print("Sorry, you've hung yourself...")
%             print(f"{tg_word.upper()} was the correct word\n")
%
%     game = new_game()
      </div>
    </div>
  </div>
</div>


<h2 id="friday-13">Friday the 13th</h2>

<p>Friday the 13th is considered an unlucky day in many countries, but
not all. There is no definitive answer as to why this day is
considered unlucky, but a common belief is that it originates from
Judas Iscariot being the 13th guest to arrive at the last
supper. Another explanation is that in Norse lore, 12 gods came
together at Valhalla and Loki, the mischievous god, arrived
unannounced as the 13th guest.</p>

<p>Regardless of its origin, in this problem you are asked to find all
occurrences of Friday when it is the 13th day of the month, for a
given year chosen by a user. This will allow you to practice using the
<a
href="https://docs.python.org/3/library/datetime.html"><code>datetime</code></a>
data structure in Python. <code>datetime</code> is specifically
designed to allow date and time manipulation in a simple manner. For
example, with a <code>datetime</code> variable, you can easily perform
the following (often more complicated) tasks.

<ul>
<li>Convert a string like 01/01/2023 12:00:00pm to a
<code>datetime</code> variable with the <a target="_blank"
href="https://www.programiz.com/python-programming/datetime/strptime"><code>strptime()</code></a>
function,

  <li>Convert a <code>datetime</code> variable to a string in any format
  you need with the <a href="datetime"><code>strftime()</code></a>
  function,</li>

  <li>Determine the year, month, day, hour, minute, second, and day-of-week
  contained in a <code>datetime</code> variable by looking at its
  <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>,
  <code>minute</code>, and <code>second</code> components, and by using the
  <a target="_blank" href="">weekday()</a> function,</li>

  <li>Increment or decrement a <code>datetime</code> variable by a
  specific number of <code>weeks</code>, <code>days</code>,
  <code>hours</code>, <code>minutes</code>, <code>seconds</code>,
  <code>microseconds</code>, or <code>milliseconds</code> using
  the <a target="_blank"
  href="https://www.geeksforgeeks.org/python-datetime-timedelta-function/"><code>timedelta()</code></a>
  function. For other periods like months, you can use
  <a href="https://dateutil.readthedocs.io/en/stable/relativedelta.html"
  target="_blank"><code>dateutil.relativetime()</code></a>
  instead. Both functions account for things like the number of days
  in a month, leap years, and so on. You can increment in positive or
  negative amounts.</li>
  
  <li><code>dateutil.relativedelta()</code> can do much more than
  simply increment and decrement by different time amounts (including
  all the time types that <code>timedelta</code> supports). For
  example, you could use <code>dateutil.relativedelta</code> to find
  the date for the last Friday of a given month. Look at the <a
  target="_blank"
  href="https://dateutil.readthedocs.io/en/stable/examples#relativedelta-examples">various
  examples</a> to see what is possible with
  <code>dateutil.relativedelta()</code>.

</ul>

<h3><code>strptime</code></h3>

<p><code>strptime</code> converts a string containing a date, a time,
or both into a Python <code>datetime</code> object, a standard data
structure Python uses to record information about a specific date
and/or time. To use the method, you specify the string to convert, and
the
<em>format</em> of the string, which defines the type and location of
date, time, and character separator elements within the string like
hour, minute, second, month, day, year, colon, backslash, and so
on. Certain elements can be specified in different ways. For example,
a day can be numeric (1, 2, \(\ldots\), 30), zero-padded (01, 02,
\(\ldots\), 30), or a full name (Monday, Tuesday, \(\ldots\),
<code>Sunday</code>).  Month can be numeric from 1 to 12, zero-padded
from 01 to 12, as a full name from January to Decemeber, or an
abbreviated name from Jan to Dec. The
<a target="_blank"
href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">
documentation</a> details all available formats <code>strptime</code>
recognizes. Here are some examples of converting different types of
date, time, and date plus time strings into
<code>datetime</code> objects.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-strptime">
% from datetime import datetime
%
% dt_tm = datetime.strptime( "Jan 01, 2024", "%b %d, %Y" )
% dt_tm = datetime.strptime( "March 3/24", "%B %d/%y" )
% dt_tm = datetime.strptime( "11:30:30", "%I:%M:%S" )
% dt_tm = datetime.strptime( "10:00:00.005999PM", "%I:%M:%S.%f%p" )
% dt_tm = datetime.strptime( "18:15:00", "%H:%M:%S" )
% dt_tm = datetime.strptime( "Nov 09/24, 12:00:00PM", "%b %d/%y, %I:%M:%S%p" )
  </div>
</div>

<p>Once you've converted the date and/or time string into a <code>datetime</code>
object, you can access any of the elements of the date and time as components of
the object.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-strptime-components">
% from datetime import datetime;
%
% dt_tm = datetime.strptime( "Nov 09/22, 2:00:15PM", "%b %d/%y, %I:%M:%S%p" );
% print( dt_tm.year );
2022
% print( dt_tm.month );
11
% print( dt_tm.day );
9
% print( dt_tm.hour );
14
% print( dt_tm.minute );
0
% print( dt_tm.second );
15
% print( dt_tm.microsecond );
0
% print( dt_tm.weekday() );
2
  </div>
</div>

<p>One reason we want to work with <code>datetime</code> objects and
not strings representing dates and/or times is because
<code>datetime</code> objects understand and automatically handle
things like number of days in a given month, leap years, and so
on. Two very useful functions are <a target="_blank"
href="https://docs.python.org/3/library/datetime.html#timedelta-objects"><code>timedelta()</code></a>
and <a target="_blank"
href="https://dateutil.readthedocs.io/en/stable/relativedelta.html"><code>relativedelta()</code></a>,
which use a
<code>datetime</code>'s understanding of date and time-specific
information to allow you to increment or decrement a
<code>datetime</code> object by specific properties and amounts of
that property. If you plan on using <code>relativedelta</code>, be
sure the read its documentation. It can handle incrementing and
decrementing properties like month and year
that <code>timedelta</code> cannot, in addition to a wide range of
useful operations, <em>e.g.,</em> finding the last Friday of the
month, checking for leap years, and incrementing or <em>replacing</em>
properties of a datetime object.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-strptime-timedelta">
% from datetime import datetime;
% from datetime import timedelta;
% from dateutil.relativedelta import relativedelta;
%
% dt_tm = datetime.strptime( "Dec 31/22, 2:00:15PM", "%b %d/%y, %I:%M:%S%p" );
% dt_tm = dt_tm + timedelta( hours=12 )
% print( dt_tm.year );
2023
% print( dt_tm.month );
1
% print( dt_tm.day );
1
% print( dt_tm.hour );
2
%
% dt_tm = dt_tm + timedelta( days=-15 )
% print( dt_tm.year );
2022
% print( dt_tm.month );
12
% print( dt_tm.day );
17
% dt_tm = dt_tm + relativedelta( months=+2 )
% print( dt_tm.year );
2023
% print( dt_tm.month );
2
% print( dt_tm.day );
17
% dt_tm = dt_tm + relativedelta( month=10 )
% print( dt_tm.month );
10
  </div>
</div>

<h3><code>strftime</code></h3>

<p><code>strftime</code> is the complement to
<code>strptime</code>. Rather than converting a string to a
<code>datetime</code> object, it converts a <code>datetime</code>
object to a formatted string, suitable for printing in your
program. The <a target="_blank" href="https://strftime.org/">codes
used to format the string</a> are identical to those used to parse the
string during <code>datetime</code> creation.</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-strftime">
% from datetime import datetime;
% from datetime import timedelta;
%
% dt_tm = datetime.strptime( "Jan 01, 2024", "%b %d, %Y" );
% dt_tm = dt_tm + timedelta( days=130 );
% dt_str = dt_tm.strftime( "%b %d, %Y" );
% print( dt_str );
May 10, 2024
  </div>
</div>
 

<div id="zero-padding-accordion" class="detail">
  <h3>Managing Zero Padding</h3>
  <div>

    <p>Many of the online documentation pages for
    <code>strptime</code> and <code>strftime</code> refer to
    formatting options like <code>%-d</code>, <code>%-m</code>, or
    <code>%-I</code> to refer to days, month numbers, or hours without
    leading zeros. Unfortunately, this is <b>Linux ONLY</b> and
    <b>WILL NOT WORK</b> on Windows. So, how do you deal with non-zero
    padded date and time elements on Windows? For
    <code>strptime</code> this is normally handled automatically. For
    example, for a day of "5" or "05" the formatting code
    <code>%d</code> will correctly parse both examples. The same is
    true for other date and time properties that can optionally be
    zero padded.</p>

    <p>For creating strings with <code>strftime</code>, we need to
    augment <code>strftime</code> with some type of string
    formatting. For example, we can use Python <code>f-strings</code>
    to format elements of a <code>datetime</code> object to avoid
    leading zeros.</p>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-strftime-f-string">
% from datetime import datetime;
%
% dt_tm = datetime.strptime( "Jan 01, 2024", "%b %d, %Y" );
%
% # Print Jan 01, 2024
%
% dt_str = dt_tm.strftime( "%B %d, %Y" );
% print( dt_str );
Jan 01, 2024
%
% # Notice that even tho our string is "Jan 1" not "Jan 01"
% # the use of %d in strptime continues to work and recognize
% # the day even without the leading zero
%
% dt_tm = datetime.strptime( "Jan 01, 2024", "%b %d, %Y" );
%
% # Print January 1, 2024
%
% # Here we use the strftime %-format codes %B for full month
% # name and %Y for 4-digit year, but we explicitly query
% # the day property of the date-time object and use :d to
% # format it as a decimal without any leading zeros
%
% dt_str = f"{dt_tm:%B} {dt_tm.day:d}, {dt_tm:%Y}";
% print( dt_str );
January 1, 2024
    </div>
    </div>
  </div>
</div>

<h3>Time Zones</h3>

<p>As discussed in class, time zones are difficult to deal with
because they are ambiguous. Python's <code>datetime</code>
documentation states "...rules for time adjustment across the world are
more political than rational, change frequently, and there is no
standard suitable for every application..." However, there are times
where we need to manage timezone-formatted times. Python has its own
built-in <code>tzinfo</code> class built on <a target="_blank"
href="https://www.space.com/what-is-utc.html">Coordinated Universal
Time (UTC)</a> to provide basic timezone processing. More recently, <a
target="_blank"
href="https://docs.python.org/3/library/zoneinfo.html"><code>zoneinfo</code></a>
was added to provide an implementation of the <a target="_blank"
href="https://www.iana.org/time-zones">IANA (Internationally Assigned
Numbers Authority) time zone database</a>, a collection of codes and
data that represent the local time for many locations throughout the
world.  External libraries build on this to offer much more extensive
timezone manipulation. Some of the basic operations
<code>tzinfo</code> provides include UTC offset, daylight savings time
identification, time zone naming, and integration into
<code>strptime</code> and <code>strftime</code>. All three are part of
the <code>datetime</code> object structure.</p>


<div class="code-flex-div">
  <div class="code-flex" id="code-tzinfo">
% from datetime import datetime;
% from datetime import tzinfo;
% import zoneinfo;
%
% cur_dt_tm = datetime.now()
%
% # By default, no timezone information is included as
% # part of a datetime object. This is knows as a "naive"
% # datetime object in Python
%
% print( cur_dt_tm.tzinfo );
None
% # Convert the current datetime to be timezone aware and
% # print the offset from UTC, which for EST during daylight
% # savings is four hours to the West (-4:00)
%
% cur_dt_tm_tz = cur_dt_tm.astimezone()
% print( cur_dt_tm_tz )
2024-04-29 14:59:48.010824-04:00
% print( cur_dt_tm_tz.tzinfo )
Eastern Daylight Time
%
% # As of Python 3.9, the zoneinfo class allows basic
% # manipulation of timezone information
%
% cur_dt_tm_tz = cur_dt_tm.astimezone( zoneinfo.ZoneInfo( "US/Eastern" ) )
%
% # Return daylight savings time as a timedelta object, 0 if
% # we are not in DST, 1 hour if we are
%
% print( cur_dt_tm_tz.dst() )
1:00:00
% print( zoneinfo.available_timezones() )
{'America/Grand_Turk', 'America/Detroit', 'America/Belem', 'Europe/Tirane',
'Asia/Baghdad', 'America/Regina', 'Europe/Amsterdam', 'Asia/Calcutta',
'Asia/Vladivostok', 'Pacific/Guam', 'Greenwich', 'GB-Eire',
  &hellip;
'Australia/Brisbane', 'Africa/Niamey', 'Asia/Brunei', 'America/Punta_Arenas',
'Asia/Ashkhabad', 'America/Eirunepe', 'Pacific/Honolulu', 'Etc/GMT+10',
'Indian/Christmas', 'Pacific/Auckland', 'Etc/GMT+7', 'Etc/UCT',
'Europe/Zagreb', 'Africa/Conakry', 'America/Indiana/Vevay'}
  </div>
</div>

<p>The most basic approach to solving the Friday the 13th problem is
to ask the user for a target year, then using <code>datetime</code>
and <code>timedelta</code> walk through all 365 days in the year and
use <code>datetime</code>'s properties to check each day to see if it
is a Friday and the 13th day of the month.
</p>

<div id="friday-13-pseudocode-accordion" class="detail">
  <h3>Friday the 13th Pseudocode</h3>
  <div>
    <ol>
    <li>Ask the user to input a valid year.

    <li>Convert the year into a <code>datetime</code> variable
    representing 01/01/year.

    <li>Loop over potential Friday 13 days in the year and check each
    day to see if it is, in fact, Friday the 13th. You can use the
    <code>timedelta()</code> and <code>weekday()</code> functions, as well
    as the ability to directly access a <code>datetime</code>'s year,
    month, and day using <code>.year</code>, <code>.month</code>, and
    <code>.day</code> as needed.

    <li>Print each date that corresponds to Friday the 13th.

    </ol>
  </div>
</div>

<p>Here are three solutions to the Friday the 13th problem: basic,
standard, and production-ready. If you're practising, you should
program your own solution before looking at ours.
</p>

<p>The basic solution is the simplest possible code to generate a correct
result, with no error checking or consideration for efficency.</p>
 

<div id="friday-13-basic-soln-accordion" class="detail">
  <h3>Friday the 13th Basic Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-friday-13-basic-soln">
% from datetime import datetime
% from datetime import timedelta
%
% inp = input( 'Enter a year to query in the form YYYY: ' );
%
% # Convert year to first day of year
%
% inp = 'Jan 01 ' + inp;
% cur_dt_tm = datetime.strptime( inp, '%b %d %Y' );
%
% # Walk entire year, searching for Friday 13 occurrences
%
% n = 0;
% yr = cur_dt_tm.year;
% while( cur_dt_tm.year == yr ):
%     if ( cur_dt_tm.weekday() == 4 and cur_dt_tm.day == 13 ):
%         n = n + 1
%     cur_dt_tm = cur_dt_tm + timedelta( days=1 );
%
% # Report Friday 13 occurrences
%
% print( 'Number of Friday 13: ' + str( n ) );
      </div>
    </div>
  </div>
</div>


<p>A standard solution with basic error checking, support for the
most general case, consideration for efficiency, and basic useful
feedback.</p>


<div id="friday-13-standard-soln-accordion" class="detail">
  <h3>Friday the 13th Standard Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-friday-13-stnd-soln">
% from datetime import datetime
% from dateutil.relativedelta import relativedelta
%
% yr = 0
% while( yr &lt; 1 ):
%     try:
%         yr = input( 'Enter a year to query in the form YYYY: ' );
%         yr = int( yr );
%
%         if ( yr &lt; 1 ):
%             print( 'Year must be a number > 0\n' );
%     except:
%         print( yr + ' is not a year in the form YYYY\n' );
%         yr = -1;
%
% # Convert year to first possible Friday 13th
%
% yr = 'Jan 13 ' + f'{yr:4d}';
% cur_dt_tm = datetime.strptime( yr, '%b %d %Y' );
%
% # Search 13th day of each month to see if it's Friday
%
% n = 0;
% yr = cur_dt_tm.year;
%
% print( '\n', end='' );
% while( cur_dt_tm.year == yr ):
%     if ( cur_dt_tm.weekday() == 4 and cur_dt_tm.day == 13 ):
%         print( cur_dt_tm.strftime( "%B %d, %Y" ) + ' is Friday the 13th' );
%         n = n + 1
%     cur_dt_tm = cur_dt_tm + relativedelta( months=+1 );
%
% # Report Friday 13 occurrences
%
% print( '\n', end='' );
% print( 'Number of Friday 13: ' + str( n ) );
      </div>
  </div>
  </div>
</div>

<p>A production-level solution with docstring comments, comprehensive
error checking, and advanced features like the ability to support BCE/BC
(before common era/before Christ) and CE/AD (common era/anno Domini) year
definitions.</p>


<div id="friday-13-prod-soln-accordion" class="detail">
  <h3>Friday the 13th Production Solution</h3>
  <div>
    <div class="code-flex-div">
    <div class="code-flex-accordion" id="code-friday-13-prod-soln">
% #- FRIDAY-13.PY---------------------------------------------------------#
% #    A program to determine the days of a given year that are Friday    #
% #    the 13th.                                                          #
% #                                                                       #
% #- When: ------ Who: ------------------ Comments: ----------------------#
% #                                                                       #
% #  30-Aug-24    Christopher G. Healey   Initial implementation          #
% #-----------------------------------------------------------------------#
% 
% from datetime import datetime
% import numpy as np
%
% def datetime64_to_str( yr ):
%     """
%     Return current year as MMM 13, YYYY[BC].
%
%     :param yr: Current year, month, day as numpy datetime64 object
%     :return: yr formatted as 'MMM DD, YYYY[BC]'
%     """
%     suffix = ''   # Assume AD and not BC
%     dt_str = str( np.datetime_as_string( [ yr ], unit='D' )[ 0 ] )
%
%     # BC dates start with 0000 or -x[x...]
%
%     if dt_str.startswith( '0000' ) or dt_str.startswith( '-' ):
%         suffix = 'BC'
%
%         # Ensure 1BC => 0000-mm-dd converts to -0000-mm-dd
%
%         dt_str = '-' + dt_str if dt_str.startswith( '0' ) else dt_str
%
%         # Remember 1BC is 0, 2BC is -1, so convert e.g., -1 to 2, -2 to 3, etc.
%
%         tok = dt_str.split( '-' );
%         tok[ 1 ] = str( int( tok[ 1 ] ) + 1 );
%         dt_str = f'{int(tok[ 1 ] ):04d}-{tok[2]}-{tok[3]}'
%
%     cur_dt = datetime.strptime( dt_str, '%Y-%m-%d' )
%     dt_str = f'{cur_dt:%b} {cur_dt.day:d}, {cur_dt.year:d}{suffix}';
%
%     return dt_str
%
% # End function datetime64_to_str
%
% def get_year():
%     """
%     Determine valid year to query. Valid year format is Y[YYY][BC|AD].
%     Examples: 2024, 2024AD, 12BC, if AD/BC not specified, AD assumed.
%
%     :return: Year to query as a numpy datetime64 object
%     """
%     yr_int = None
%
%     while yr_int == None:    # While valid year not yet entered
%         ad = False   # AD and BC are initially not specified
%         bc = False
%
%         # Get year, remove spaces, lowercase to standardize
%
%         yr_str = input( 'Enter target year as Y[YYY][BC|AD]: ' )
%         yr_str = yr_str.replace( ' ', '' ).lower()
%
%         # If year entered ends in BC or AD, handle appropriately
%
%         while yr_str.endswith( 'bc' ) or yr_str.endswith( 'ad' ):
%             if yr_str.endswith( 'bc' ):
%                 bc = True
%             elif yr_str.endswith( 'ad' ):
%                 ad = True
%
%             yr_str = yr_str[ :-2 ]
%
%         if bc and ad:   # Ensure both BC and AD were not entered
%             print( 'Year cannot end in both BC and AD\n' )
%             continue
%
%         if len( yr_str ) < 1 or len( yr_str ) > 4:   # Ensure valid year
%             print( 'Year does not meet format Y[YYY][BC|AD]\n' )
%             continue
%
%         try:   # Try to convert string to integer
%             yr_int = int( yr_str )
%             if yr_int == 0:   # 0BC or 0AD are not valid years
%                 print( 'Year cannot be 0, 0BC, or 0AD\n' )
%                 yr_int = None
%                 continue
%
%             if bc:   # If BC specified, negate date: 1BC = 0, 2BC = -1, ...
%                 yr_int = 1 - yr_int
%         except:   # Catch invalid year
%             print( 'Year ' + yr_str + ' does not meet format Y[YYY][BC|AD]\n' )
%
%     # Account for "-" on BC dates (5 wide versus 4 wide)
%
%     yr_str = f'{yr_int:05d}' if bc else f'{yr_int:04d}'
%     return np.datetime64( yr_str )
%
% # End function get_year
%
% # Mainline
%
% yr_np = get_year()   # Get target year to search
%
% for i in range( 0, 12 ):   # For all 12 months in target year
%     # Set appropriate month and 13th day, then check if it's a Friday
%
%     cur_yr = yr_np + np.timedelta64( i, 'M' ) + np.timedelta64( 12, 'D' )
%     if np.is_busday( cur_yr, weekmask="Fri" ):
%         yr_str = datetime64_to_str( cur_yr )
%         print( yr_str + " is Friday the 13th" )
    </div>
    </div>
  </div>
</div>


<h2>Advanced Problems</h2>

<p>Below are some more advanced problems for students who have previous Python
programming experience or students who have finished the first four practice
problems.</p>

<h3>2048</h3>

<p>2048 is a game played on a 4&times;4 grid. The goal is to combine
values in squares on the grid to add up to 2048. Initially, two random
positions are given values of 2. The remaining seven positions are
empty. Players can push the non-empty squares up, down, left, or
right. All the non-empty squares will move as far as possible in the
given direction, until they hit the edge of the grid or they hit a
non-empty square. If a square hits another square with the same value
the two squares "merge," placing the sum of the values in the square
that was hit, and emptying the second square. After each "push" a
random empty square is selected and a value of 2 is placed in the
square.</p>

<p>The game continues until the player merges two squares to a value
of 2048, or until the board is full and no moves that form merges
exist. You can try an <a href="https://2048game.com/"
target="_blank">online version</a> of the game to see how it works and
understand the rules for what happens when you push squares, when
merges occur, and how the game ends.</p>


<div>
<table style="margin-left: auto; margin-right: auto;">
  
<!-- First two tables -->

  <tr class="even">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  </tr>
  
  <tr class="odd">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">Push Right</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  </tr>

  <tr class="even">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">&rarr;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  </tr>
  
  <tr class="odd">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  </tr>
  

<!-- Gap between first and second tables -->
  
  <tr><td style="border: none; background-color: var(--txt-bg);">&nbsp;</td></tr>

  
<!-- Second two tables -->

  <tr class="even">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;
  </td>
  </tr>
  
  <tr class="odd">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">Push Up</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  </tr>

  <tr class="even">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">&uarr;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  </tr>
  
  <tr class="odd">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;</td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  </tr>
  

<!-- Gap between second and third tables -->

  <tr><td style="border: none; background-color: var(--txt-bg);">&nbsp;</td></tr>
  
  
<!-- Third two tables -->

  <tr class="odd">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;
  </td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  </tr>
  
  <tr class="even">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">Push Left</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  </tr>

  <tr class="odd">
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>

  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">&larr;</td>

  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  <td>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </td>
  </tr>
  
  <tr class="even">
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>

  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  </tr>
  

<!-- Continue -->
  
  <tr class="odd">
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>
  <td style="border: none; background-color: var(--txt-bg);">&nbsp;</td>
  <td style="border: none; vertical-align: middle; text-align:
  center; background-color: var(--txt-bg); color: var(--txt-fg);">&hellip;</td>
  </tr>

</table>
</div>

<p>We have provided <a href="2048.py">one solution</a> to the 2048
game in Python. You'll need to <code>conda install
conda-forge::keyboard</code> to install the <code>keyboard</code>
library so it can run properly.</p>


<h3>String Matching</h3>

<p>String matching and partial string matching are two critical tasks
in computer science. The first asks, "What is the minimum number of
operations required to convert a source string \(s\) into a target
string \(t\)?"  The second asks, "From a set of strings, which strings
\(T = \{ t_1, t_2, \ldots, t_n\}\) are within a threshold similarity
\(\epsilon\) of a source string \(s\)?"
</p>


<h4>String Conversion</h4>

<p>Suppose we have two strings \(s\) and \(t\) and we want to perform
the minimum number of "operations" on \(s\) so that it is equivalent
to \(t\). Here, valid operations on \(s\) are inserting a new
character, deleting an existing character, or replacing an existing
character (<em>i.e.,</em> swapping it for something else). The
<a href="https://planetcalc.com/1721/" target="_blank">Levenshtein
distance</a>, proposed by Vladimir Levenshtein in 1965, defines the
minimum number of operations needed to convert \(s\) to \(t\). The
distance matrix \(D\) it builds can also be used to
determine <em>which</em> operations to perform, which is probably as
important (or perhaps more important) that the actual minimum
operation count itself.
</p>

<p>Levenshtein distance is calculated by recursively constructing a
distance matrix \(D\) of size \(|s| \times |t|\). Entry \(D[i][j]\)
holds the Levenshtein distance for \(s\) to \(t\) up to position \(i\)
in \(s\) and \(j\) in \(t\). This means the lower-right corner of \(D\)
holds the final distance for converting \(s\) to \(t\). A specific
algorithm based on values of \(s\) and \(t\) is used to construct
\(D\).
</p>

<div style="font-size: 1.15em;">
\begin{equation}
\textrm{lev}(s,t) =
\begin{cases}
|s| & \textrm{if} \; |t| = 0 \\
|t| & \textrm{if} \; |s| = 0 \\
\textrm{lev}(\textrm{tail}(a), \textrm{tail}(b)) & \textrm{if} \; a[0] = b[0] \\
1 + \textrm{min}
\begin{cases}
\textrm{lev}(\textrm{tail}(a),b) \\
\textrm{lev}(a,\textrm{tail}(b)) \\
\textrm{lev}(\textrm{tail}(a),\textrm{tail}(b)) \\
\end{cases} & \textrm{otherwise}
\end{cases}
\end{equation}
</div>

<p>This tells us the Levenshtein distance for (sub)strings \(s\) and \(t\)
is</p>

<ol>

<li> \(|s|\) if \(t\) is empty (delete all characters in \(s\), requiring
\(|s|\) operations)</li>

<li> \(|t|\) if \(s\) is empty (append all characters in \(t\) to the end of
\(s\), requiring \(|t|\) operations)</li>
  
<li> The Levenshtein distance of \(s[1:]\) and \(t[1:]\) if the first
characters of \(s\) and \(t\) are identical (nothing needs to be done since
the strings match at their first character)</li>
  
<li> Otherwise, we know a deletion, insertion, or replacement (swap)
is required, so we add 1 (for the operation) to the minimum of:</li>

<ul>

<li>the Levenshtein distance of \(s[1:]\) and \(t\) (<em>deleting</em>
the first character of \(s\))</li>
  
<li>the Levenshtein distance of \(s\) and \(t[1:]\)
(<em>inserting</em> the first character of \(t\) at the beginning of
\(s\))</li>

<li>the Levenshtein distance of \(s[1:]\) and \(t[1:]\)
(<em>swapping</em> the first character of \(s\) with the first
character of \(t\))</li>

</ul>
</ol>

<p>To actually <em>construct</em> \(D\), we use dynamic programming,
which divides a large problem into a sequence of smaller
ones. Obviously, the large problem is calculating the Levenshtein
distance between \(s\) and \(t\). We can reduce this to calculating
the Levenshtein distance between prefixes of \(s\) and \(t\). As an
example, suppose \(s=\textrm{kelm}\) and \(t=\textrm{hello}\). The
prefixes of kelm are k, ke, kel, and kelm. Similarly, the prefixes of
hello are h, he, hel, hell, and hello. The Levenshtein distance
between all pairs of prefixes forms the entries of \(D\).
</p>

<p>To further reduce this to something we can easily work with,
consider comparing the prefix k to all prefixes of hello. The first
one, \((\textrm{k},\textrm{h})\) has a Levenshtein distance of
\(\textrm{lev}(\textrm{k},\textrm{h})=1\), since we swap k for h. The
second, \((\textrm{k},\textrm{he})\) requires a swap and an insertion
of e, \(\textrm{lev}(\textrm{k},\textrm{he})=2\). Notice this is an
extension of the first \((\textrm{k},\textrm{h})\) operation. For
\((\textrm{k},\textrm{hel})\) it's a swap, an insertion, and an
insertion, for \(\textrm{lev}(\textrm{k},\textrm{hel})=3\). You can
easily guess that \(\textrm{lev}(\textrm{k},\textrm{hell})=4\) and
\(\textrm{lev}(\textrm{k},\textrm{hello})=5\). This represents the
first row of \(D\), or values of \(D[1,1]\) through \(D[1,5]\).
</p>

<p>
To describe this in a linear programming fashion, we will consider the
case of calculating \(D[i,j]\) given \(D[i-1,j]\), \(D[i,j-1]\), and
\(D[i-1,j-1]\), that is, the problem reduced to a \(2 \times 2\)
matrix. Suppose \(D[i-1,j]=2\), \(D[i,j-1]=3\), and \(D[i-1,j-1]=5\).

<table style="margin: 2em auto 0px auto;">
  <tr class="even"><td>5</td> <td>2</td></tr>
  <tr class="even"><td>3</td> <td>&nbsp;</td></tr>
</table>

<p>The missing element at \(D[i,j]\) will have a Levenshtein distance
based on two options.</p>

<ol>

<li> The current character of the two prefixes are identical, and no
operation is required if we do a replacement (since we'd be swapping
the same characters), so \(D[i,j] =
\min(1+D[i-1,j],1+D[i,j-1],D[i-1,j-1])\).

<li> The current character of the two prefixes are different, and a replacement
<em>does</em> require a swap, so
\(D[i,j] = \min(1+D[i-1,j],1+D[i,j-1],1+D[i-1,j-1])\).
  
</ol>

<p>To complete the discussion, notice that \(i\) and \(j\) index from \(1\),
but to get the three values we need to calculate the fourth, we need a row and
column indexed at \(0\) in \(D\). Therefore, this is the \(D\) we start
with when comparing kelm to hello.
</p>


<table style="margin: 2em auto 0px auto; font-family: 'Fira Code', monospace;">

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td style="border: none; background-color: var(--txt-bg);"></td> <td>h</td> <td>e</td> <td>l</td> <td>l</td> <td>o</td>
</tr>

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>k</td> <td>1</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>e</td> <td>2</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>l</td> <td>3</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>m</td> <td>4</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

</table>


<p>Given this table, to calculate \(D[1,1]\) we observe that the
prefixes k and h are not the same, so the distance is \(\min(1 +
D[0,1],1 + D[1,0],1 + D[0,0]) = 1 + 0 = 1\).


<table style="margin: 2em auto 0px auto; font-family: 'Fira Code', monospace;">

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td style="border: none; background-color: var(--txt-bg);"></td> <td>h</td> <td>e</td> <td>l</td> <td>l</td> <td>o</td>
</tr>

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>k</td> <td>1</td> <td><b>1</b></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>e</td> <td>2</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>l</td> <td>3</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>m</td> <td>4</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

</table>


<p>When the current characters of the prefixes are the same, the
replacement cost is 0, and our options are insert, delete, or do
nothing. The value for \(D[i,j]\) is therefore
\(\min(1+D[i-1,j],1+D[i,j-1],D[i-1,j-1])\). If the prefix characters
are different, then an deletion, insertion, or swap is required and
the replacement cost is 1, so the value for \(D[i,j]\) is \(\min(1 +
D[i-1,j],1 + D[i,j-1],1 + D[i-1,j-1])\).  This procedure is used to
fill in row \(D[1,:]\).
</p>


<table style="margin: 2em auto 0px auto; font-family: 'Fira Code', monospace;">

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td style="border: none; background-color: var(--txt-bg);"></td> <td>h</td> <td>e</td> <td>l</td> <td>l</td> <td>o</td>
</tr>

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>k</td> <td>1</td> <td>1</td> <td><b>2</b></td> <td><b>3</b></td> <td><b>4</b></td> <td><b>5</b></td>
</tr>

<tr class="even">
<td>e</td> <td>2</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>l</td> <td>3</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>m</td> <td>4</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

</table>


<p>For the next row, we are comparing <em>ke</em> to hello. Remember,
even though the second row is labelled e, it corresponds to the prefix
from the first to the second row: ke.  So as we walk through hello, we
would say:

<ul>
<li>e is different than h
<li>e is the same as e
<li>e is different from l
<li>e is different from l
<li>e is different from o
</ul>


<p>What about the first two entries in the next row, \(D[2,1]\) and
\(D[2,2]\)?  For \(D[2,1]\) we are comparing e to h, and since they
are different the distance is \(\min(1+1,1+2,1+1) = 2\). For
\(D[2,2]\), however, we are comparing e to e, and since these are the
same, no operation is needed for replacement, meaning \(D[2,2] =
\min(1+2,1+2,1) = 1\).
</p>


<table style="margin: 2em auto 0px auto; font-family: 'Fira Code', monospace;">

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td style="border: none; background-color: var(--txt-bg);"></td> <td>h</td> <td>e</td> <td>l</td> <td>l</td> <td>o</td>
</tr>

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>k</td> <td>1</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>e</td> <td>2</td> <td><b>2</b></td> <td><b>1</b></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>l</td> <td>3</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

<tr class="even">
<td>m</td> <td>4</td> <td></td> <td></td> <td></td> <td></td> <td></td>
</tr>

</table>


<p>If we continue this for all entries in \(D\), we obtain a final
table whose lower-right entry \(D[4,5]=3\), meaning
\(\textrm{lev}(\textrm{kelm},\textrm{hello})=3\). Intuitively this
seems correct, since we would swap k with h, insert an l, and swap m
with o. You will see below, however, that our algorithm uses a different
set of three operations to convert kelm to hello.
</p>


<table style="margin: 2em auto 0px auto; font-family: 'Fira Code', monospace;">

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td style="border: none; background-color: var(--txt-bg);"></td> <td>h</td> <td>e</td> <td>l</td> <td>l</td> <td>o</td>
</tr>

<tr class="even">
<td style="border: none; background-color: var(--txt-bg);"></td> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>k</td> <td>1</td> <td style="background: var(--tr-odd-bg);">1</td> <td>2</td> <td>3</td> <td>4</td> <td>5</td>
</tr>

<tr class="even">
<td>e</td> <td>2</td> <td>2</td> <td style="background: var(--tr-odd-bg);">1</td> <td>2</td> <td>3</td> <td>4</td>
</tr>

<tr class="even">
<td>l</td> <td>3</td> <td>3</td> <td>2</td> <td style="background: var(--tr-odd-bg);">1</td> <td>2</td> <td>3</td>
</tr>

<tr class="even">
<td>m</td> <td>4</td> <td>4</td> <td>3</td> <td>2</td> <td style="background: var(--tr-odd-bg);">2</td> <td style="background: var(--tr-odd-bg);">3</td>
</tr>

</table>


<p>Given this description, write a program that calculates the
Levenshtein distance between two words, then describes how to convert
the source word to the target word in the number of Levenshtein
distance operations allowed. You may get a different set of operations
depending on whether you modify the source front-to-back or
back-to-front and depending on how you break ties in minimum distances
for insert, delete, and replace, but the number of operations
(<em>i.e.,</em> the Levenshtein distance) will always be the same.
</p>

<div class="ex-div">
kelm &rarr; hello
Levenshtein distance: 3

kelm &rarr; kelmo (I)
kelmo &rarr; kello (R)
kello &rarr; hello (R)


smelt &rarr; salmon
Levenshtein distance: 5

smelt &rarr; smeltn (I)
smeltn &rarr; smelton (I)
smelton &rarr; smelmon (R)
smelmon &rarr; smlmon (D)
smlmon &rarr; salmon (R)
</div>


<h4>String Correction</h4>

<p>Levenshtein reports the edit distance between two words, and with
some extensions, how to perform edit operations to convert one word to
another.  Although interesting, this may not seem like a common
problem. However, Levenshtein provides another critical property: a
way to characterize the similarity between two words based on their
edit distance. This can be used in any situation where "word
similarity" is important. The example we will use is spell
checking. The basic strategy would be to say: if a word is misspelled,
suggest a small set of words that are "similar" to the misspelled
word, that is, a small set of words that have a small Levenshtein
distance from the misspelled word.
</p>

<p>Since we need suggestions to be identified quickly, we need to
encode all words in a dictionary in a way that supports rapid
identification of dictionary words within a threshold Levenshtein
distance of a target word. This can be done with
a <a href="https://dl.acm.org/doi/10.1145/362003.362025"
target="_blank">Burkhard-Keller tree</a>, commonly called a BK-tree.
In a BK-tree words are stored in tree nodes and the edge between two
nodes contains the Levenshtein distance between the nodes' words. A
BK-tree is constructed in the following manner.

<ol>

<li>Choose any word in a dictionary \(w_\textrm{root}\) as the root
of the BK-tree.</li>

<li>For all remaining words \(w_i\) in the dictionary, compute the
Levenshtein distance \(d_{i,\textrm{root}}\) between \(w_i\) and
\(w_\textrm{root}\).</li>
  
<li>If no child of \(w_\textrm{root}\) exists with an edge value of
\(d_{i,\textrm{root}}\), add \(w_i\) as a child of
\(w_\textrm{root}\).</li>
  
<li>If a child <b>does</b> exist with an edge value of
\(i,d_{\textrm{root}}\)</li>
  
  <ul>
  <li>Follow the edge to the node containing word \(w_j\).</li>
  <li>Calculate the Levenshtein distance \(d_{i,j}\) between \(w_i\)
  and \(w_j\).</li>
  <li>If no child of \(w_j\) exists with an edge value of \(d_{i,j}\),
  add \(w_i\) as a child of \(w_j\).</li>
  <li>Otherwise, recursively traverse the tree using the same rules to
  find the proper location for \(w_i\).</li>
  </ul>

</ol>

<p>As an example, suppose our (small) dictionary had the words <code>{ help,
helm, hello, shell, helper, loop, helps, troop }</code>. We arbitrarily
choose <code>help</code> as the root of the tree, then add <code>helm</code>
Since \(\textrm{lev}(\textrm{help},\textrm{helm})=1\) and <code>help</code>
has no child node with an edge value of \(1\), we add it to the BK-tree.
Similarly, <code>hello</code> with a Levenshtein distance of \(2\) is also
added as a child of <code>help</code>.
</p>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 200px;">
  <img style="width: 80%; max-width: 200px;" src="../figs/python/BK-01.png" alt="BK-01">
</div>

<p>Next we add <code>shell</code>. Since
\(\textrm{lev}(\textrm{help},\textrm{shell})\) is \(2\), we already
have a child with Levenshtein distance \(2\) (<code>hello</code>). Therefore,
we move to node <code>hello</code> and attempt to add <code>shell</code>
there. The Levenshtein distance between <code>hello</code> and <code>shell</code>
is 2, and no child of <code>hello</code> with edge value 2 exists, so we insert
<code>shell</code> as a child of <code>hello</code>.</p>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 200px;">
  <img style="width: 80%; max-width: 200px;" src="../figs/python/BK-02.png" alt="BK-02">
</div>

<p>This process continues, adding the remaining words to create the final
BK-tree.</p>

<div class="code-img" style="background-color: #ffffff; width:80%; max-width: 532px;">
  <img style="width: 80%; max-width: 532px;" src="../figs/python/BK-03.png" alt="agglomerative">
</div>


<p>Once the tree is built, it is searched for words "close" to a target
word, for example, a misspelled word. The threshold Levenshtein
distance \(\epsilon\) is called the <em>radius</em>. To search the
BK-tree, for a target word \(w_\textrm{tg}\), perform the following
iterative procedure.


<ol>

<li>Create an empty match list \(M\).</li>

<li>Create a candidate list \(C\) containing the root node
\(n_\textrm{root}\).</li>

<li>While \(C\) is not empty, remove the next node \(n_c \in C\).</li>

<ul>

<li>If Levenshtein distance \(d_c\) between \(w_\textrm{tg}\) and
\(w_c\) is less than or equal to \(\epsilon\), \(d_c =
\textrm{lev}(w_\textrm{tg},w_c) \leq \epsilon\), add \(w_c\) to
\(M\)</li>

<li>Create a soft threshold range \(d_c - \epsilon \ldots d_c +
\epsilon\).  Add every child of \(n_c\) whose edge value is within the
soft threshold to the candidate list \(C\)</li>

<li>Continue removing candidate nodes \(n_c \in C\) until \(C\) is
empty</li>

</ul>

<li>At this point, \(M\) contains all words in the BK-tree within
Levenshtein distance \(\epsilon\) of \(w_\textrm{tg}\).

</ol>

<p>Suppose we were searching for suggestions to the misspelled
word <code>hllo</code> with a threshold of \(\epsilon=1\). We start
with an empty \(M\) and a candidate list \(C = \{ \textrm{help} \}\)
containing the root node. We remove the first entry <code>help</code>
from \(C\). Because the Levenshtein distance
\(\textrm{lev}(\textrm{help},\textrm{hllo}) = 2 \gt \epsilon\), we
<b>do not</b> add <code>help</code> to \(M\). Our soft threshold
boundaries are \( 2 - \epsilon\) to \(2 + \epsilon = [1, \ldots,
3]\). <code>helm</code> and <code>hello</code> are added to \(C\)
since their edge values are within the soft threshold.
</p>

<p>We remove the next entry <code>helm</code> from \(C\).
\(\textrm{lev}(\textrm{helm},\textrm{hllo}) = 2 \gt
\epsilon\). Because the Levenshtein distance is greater than
\(\epsilon\), <code>helm</code> <b>is not</b> added to \(M\). The
soft threshold is \([1, \ldots, 3]\), so <code>helps</code> is added
to \(C\).
</p>

<p>We remove the next entry <code>hello</code> from \(C\).
\(\textrm{lev}(\textrm{hello},\textrm{hllo}) = 1 \leq
\epsilon\). Because the Levenshtein distance is less than of equal to
\(\epsilon\), <code>hello</code> is added to \(M\). The
soft threshold is \([0, \ldots, 2]\), so <code>shell</code> is added
to \(C\).
</p>

<p>To complete the example,
\(\textrm{lev}(\textrm{helps},\textrm{hllo}) = 3 \gt \epsilon\), and
\(\textrm{lev}(\textrm{shell},\textrm{hllo}) = 3 \gt \epsilon\), so
neither is added to \(M\). The final set of recommended corrections for
<code>hllo</code> is therefore \(M = \{\textrm{hello}\}\).
</p>

<p>Add code to your program to construct a BK-tree from a set of
words, then allow a user provide a target word and threshold
\(\epsilon\). The search function should return the set of words that
are within \(\epsilon\) of the target word. As an example, here
is <a href="levenshtein.py">our Python program</a>
that includes both the Levenshtein algorithm and the routines to
construct and search a BK-tree. As a dictionary, we
use <a href="https://www.csc2.ncsu.edu/faculty/healey/msa/python/words.json">the
same set of words</a> we provided for the hangman practice problem. If
you want a larger
dictionary, <a href="https://www.csc2.ncsu.edu/faculty/healey/msa/python/dictionary.json">an
abridged version of the 2016 Webster's English Dictionary</a> is also
available, although it will take longer to build a BK-tree since this
file contains significantly more words. To load data from the
Webster's Dictionary, execute the following Python commands.
</p>

<div class="code-flex-div">
  <div class="code-flex" id="code-dict-webster">
% import json
% 
% with open( 'dicitionary.json' ) as inp:
%   data = json.load( inp )
% words = list( data.keys() )
  </div>
</div>


<h2>Tic-Tac-Toe</h2>

<p>The final practice problem is also your assignment for the
Practical Python module. You are asked to
implement <a href="./assn-tictactoe/" target="_blank"> a simple
tic-tac-toe game</a> to allow two individuals to play one
another. The <a href="./assn-tictactoe/" target="_blank">assignment
web page</a> provides full details on what is required.</p>

<p>The assignment is due by 5:00pm Friday, September 8. The submission
link is included on the Moodle page in the Practical Python
section. As with the OpenWeatherMap assignment, you must submit a
Python .py source code so that we can automatically test it to ensure
it works as it should.</p>


<h2>Appendix: Installing Python Packages</h2>

<p>In a typical Python environment, you can install packages using
Python's <code>pip</code> command. <code>pip</code> automatically
determines <em>dependencies</em>, that is, whether other packages are
required to run the package you've requested. If any dependencies are
not installed, <code>pip</code> will attempt to install them prior to
installing the package you've requested.</p>

<p>In an Anaconda environment, however, we use the <code>conda</code>
command the perform the same function. This can be done either
in <code>Anaconda Navigator</code> or at the windows command line
interface (CLI). Anaconda
has <a href="https://docs.anaconda.com/anaconda/navigator/tutorials/manage-packages/"
target="_blank">an extensive help page</a> on how to perform package
installations, both those that Anaconda maintains in its own package
library, and those that live outside Anaconda's servers. For specific
details on installation, this is the best guide to reference.</p>

<p>If you want a quick summary of the steps I use to try to install
Python packages in the Anaconda environment, they're listed in order
below</p>

<ol>

<li>Run Anaconda Navigator and choose the "Environments" option on the
left-hand panel. This will bring up a package manager with a list of
installed packages on the right. Enter the name of your package in the
"Search Packages" field to see if it's already installed as part of
the default Anaconda package group. If the package doesn't appear as
an installed package, use the drop-down menu to switch from
"Installed" to "Not Installed." If your package appears in this list,
it is a package Anaconda maintains in their package library. Select
the package (click on the radio button to the left of its name), then
click "Apply" to install the package.

<li>If the package is not in the "Not Installed" list, it is not a
package Anaconda includes in its default installation. Hit Windows+Q
(Windows key plus Q key) to bring up the search option in Windows and
type "anaconda". The list of Recommended Apps should include "Anaconda
Prompt." Select this, since it guarantees all the proper Anaconda
environment information is set before the CLI is run.<br><br>
  
Search the web for the terms <code>anaconda <em>package</em></code> where
<code><em>package</em></code> is the package you want to install. Normally,
the first result returned is an Anaconda page that specifies exactly how
to install the given package.

<li>If all of these fail and you're willing to accept the possibility
of corrupting your current Anaconda environment, you can try
using <code>pip</code>. To do this, we first need to
ensure <code>pip</code> itself is installed. Type

<div class="ex-div">
conda list
</div>

at the command line. This will list all installed package in
alphabetical order. You can scroll backwards to see
if <code>pip</code> is in the list of installed
packages. If <code>pip</code> is not installed, you must install it
with the command

<div class="ex-div">
conda install pip
</div>

This will install <code>pip</code> (which is a package Anaconda
maintains) into the Anaconda environment. Once you
know <code>pip</code> is available, you can install your desired
package using

<div class="ex-div">
python -m pip install <em>package</em>
</div>

where <code><em>package</em></code> is the name of the package you
want to install. The reason we use <code>python</code> to
run <code>pip</code> is that this uses the Python interpreter <em>in
the current Anaconda environment</em> for the installation. This
guarantees the package you are installing is also placed in the
current Anaconda environment, which is where you want it. To check if
the package installed properly, you can either use
<code>conda list</code> again, or run python and try to <code>import
<em>package</em></code> to see if it loads properly.

</ol>

<!-- The mod-date span will be updated by code in mod-date.js -->

<hr class="fig_top">
<div class="footer">
  Updated <span id="mod-date">01-Jan-01</span>
</div>

</body>
</html>

<!--  LocalWords:  Analytics Healey Javascript Rossum Centrum bitwise
  -->
<!--  LocalWords:  Wiskunde Informatica decrement ebf fc px moz CSV '
  -->
<!--  LocalWords:  webkit Lucida monospace SAS numpy NumPy datetime -
  -->
<!--  LocalWords:  bool str boolean healey rappa durian  sklearn OMP
  -->
<!--  LocalWords:  Hodgenville tuples tuple substring len llo wo ld '
  -->
<!--  LocalWords:  elif sqrt Ctrl ui int's str's understandability nm
  -->
<!--  LocalWords:  LaBarr inp txt readlines num Mostek SUMLEV API tac
  -->
<!--  LocalWords:  substrings COUSUB CONCIT STNAME ESTIMATESBASE pre
  -->
<!--  LocalWords:  POPESTIMATE Abbeville Adamsville Albertville csv -
  -->
<!--  LocalWords:  Aliceville Los Angeles tuple's writerow stdev Aric
  -->

<!--  LocalWords:  Binet's covariance numpy's ndarray arange sublists
  -->
<!--  LocalWords:  sublist analytics eigenvectors pandas's labelled
  -->
<!--  LocalWords:  data's dtype NaN idx idxmax DataFrame DataFrame's
  -->
<!--  LocalWords:  df loc DataFrames ith iloc BeautifulSoup bs href
  -->
<!--  LocalWords:  BeautifulSoup's Traceback stdin TypeError urllib
  -->
<!--  LocalWords:  WinPython url urlopen forecasted Moodle iPython os
  -->
<!--  LocalWords:  ipython latin lxml getText dataset linesep scikit
  -->
<!--  LocalWords:  execfile Cournapeau preprocessing preprocessor SGD
  -->
<!--  LocalWords:  perceptron LDA QDA SVM neighbours XGBoost DBSCAN
  -->
<!--  LocalWords:  setosa virginica versicolor np matplotlib pyplot
  -->
<!--  LocalWords:  ListedColormap plt lightgreen cmap edgecolor uniq
  -->
<!--  LocalWords:  xlabel ylabel suptitle StandardScaler sc vstack rf
  -->
<!--  LocalWords:  hstack preprocessed ppn iter pred Misclassified tg
  -->
<!--  LocalWords:  prd svm SVC svc rbf KNeighborsClassifier KNN knn
  -->
<!--  LocalWords:  minkowski RandomForestClassifier oob accuracies cp
  -->
<!--  LocalWords:  misclassification misclassifications misclassify
  -->
<!--  LocalWords:  misclassified clust subrange WCSS arg Lloyd's agg
  -->
<!--  LocalWords:  centroids centroid KMeans Misassigned misassigned
  -->
<!--  LocalWords:  AgglomerativeClustering dendrogram outlier BaSed
  -->
<!--  LocalWords:  DBSCAN's misassignment Imputer nan NaNs chdir sep
  -->
<!--  LocalWords:  FunctionTransformer skiprows isnull del NAICS EMP
  -->
<!--  LocalWords:  ESTAB PAYANN backfill Const fillna scipy interp th
  -->
<!--  LocalWords:  linspace Jupyter gensim cmd conda agglomerative va
  -->
<!--  LocalWords:  datasets scatterplots REs randint cmp Args f'It -2
  -->
<!--  LocalWords:  bday figsize rect linestyle .ui-accordion-header
  -->
<!--  LocalWords:  'Droid Sans' -webkit-hyphens -moz-hyphens e.g. KY'
  -->
<!--  LocalWords:  -ms-hyphens Javascript 'healey' 'rappa' 'orange'
  -->
<!--  LocalWords:  'apple' 'pear' 'durian' 'pomegranate' 'Abraham -th
  -->
<!--  LocalWords:  Lincoln' 'Hodgenville 'February 1809' 'April 1865'
  -->
<!--  LocalWords:  'str' 'int' 'float' 'bool' 'Christopher Healey' -3
  -->
<!--  LocalWords:  '9195138112' 'Michael Rappa' '9195130480' 'Aric -4
  -->
<!--  LocalWords:  LaBarr' '9195132957' db.keys 'Hello 'w' 'llo wo'
  -->
<!--  LocalWords:  'd' 'ld 'Must.. harder..' 'Dept Science' i.e. 's
  -->
<!--  LocalWords:  '9195152858' 'A' 'B' 'C' 'F' 'The of' 'is' -15 -10
  -->
<!--  LocalWords:  math.sqrt -14 -13 -12 -11 'Healey' 'Rappa' 'stop'
  -->
<!--  LocalWords:  'LaBarr' l.insert 'is odd' engineers' 'input.txt'
  -->
<!--  LocalWords:  ipython-input-11-00773625d4c5 'r' 'latin' inp.seek
  -->
<!--  LocalWords:  inp.readlines inp.close inp.tell 'output.txt' ''
  -->
<!--  LocalWords:  'Mostek' out.write n' out.close 'This os.linesep
  -->
<!--  LocalWords:  inp.read content.split line' CENSUS2010POP 'excel'
  -->
<!--  LocalWords:  ESTIMATESBASE2010 POPESTIMATE2010 POPESTIMATE2011
  -->
<!--  LocalWords:  csv.list 'excel-tab' 'pop.csv' csv.reader 'has 'in
  -->
<!--  LocalWords:  population' 'City' state' 3.x 'pop-summary.csv' 2D
  -->
<!--  LocalWords:  csv.writer writer.writerow 'State' 'Population' 1D
  -->
<!--  LocalWords:  pop.csv 'Pop 'Sample 3.542248481792631e arr.shape
  -->
<!--  LocalWords:  numpy.array 'numpy.ndarray' numpy.zeros indices C1
  -->
<!--  LocalWords:  numpy.arange arr.reshape arr.size numpy.histogram
  -->
<!--  LocalWords:  pandas.Series 'a' 'b' 'c' int64 'x' -1.34 float64
  -->
<!--  LocalWords:  pandas.DataFrame 'C1' 'C2' C2 -ith df.loc df.iloc
  -->
<!--  LocalWords:  'C3' C3 s.name df.append pandas.read 'latin1' n---
  -->
<!--  LocalWords:  pop.describe 'NAME' 'STNAME' 'POPESTIMATE2011' -5
  -->
<!--  LocalWords:  .idxmax -means samples' datasets.load 'Data 'sepal
  -->
<!--  LocalWords:  iris.feature 'petal 'Target iris.target 'setosa'
  -->
<!--  LocalWords:  'versicolor' 'virginica' 'Truncated iris.data 's'
  -->
<!--  LocalWords:  matplotlib.colors matplotlib.pyplot 'o' colors d'
  -->
<!--  LocalWords:  'red' 'blue' 'lightgreen' np.unique plt.figure .2f
  -->
<!--  LocalWords:  plt.scatter 'black' plt.xlabel 'Petal plt.ylabel
  -->
<!--  LocalWords:  plt.legend fig.suptitle Width' 'Sepal 'Number eta0
  -->
<!--  LocalWords:  sklearn.model train.shape test.shape 'Frequency x-
  -->
<!--  LocalWords:  Centering sklearn.preprocessing sc.fit np.vstack
  -->
<!--  LocalWords:  sc.transform np.hstack 'Standardized -1.28030022
  -->
<!--  LocalWords:  -1.31903956 -1.33726273 -1.22333771 modeling .sum
  -->
<!--  LocalWords:  sklearn.linear sklearn.metrics ppn.fit ppn.predict
  -->
<!--  LocalWords:  'Perceptron 'Misclassified 'Accuracy '.format 'SVC
  -->
<!--  LocalWords:  ppn.score sklearn.svm 'rbf' svc.fit svc.predict 'X
  -->
<!--  LocalWords:  svc.score sklearn.neighbors neighbors 'minkowski'
  -->
<!--  LocalWords:  knn.fit knn.predict 'KNN knn.score rf.fit 'Random
  -->
<!--  LocalWords:  sklearn.ensemble rf.predict rf.score 'Out-of-bag
  -->
<!--  LocalWords:  rf.oob pre-labeled count.most sklearn.cluster U.S.
  -->
<!--  LocalWords:  km.fit km.predict 'k-Means 'Misassigned 'average'
  -->
<!--  LocalWords:  agg.fit 'Agglomerative db.fit 'DBSCAN np.nan 'NaN'
  -->
<!--  LocalWords:  'mean' imp.fit 'Impute imp.transform 'most pd.read
  -->
<!--  LocalWords:  frequent' np.log1p 'Transform trans.transform has'
  -->
<!--  LocalWords:  os.chdir 'construction-census.csv' df.isnull 'EMP'
  -->
<!--  LocalWords:  .values.sum 'values df.size df.copy cp.shape 'Pad
  -->
<!--  LocalWords:  .isnull removing...' values' GEO.id GEO.id2 'NaNs'
  -->
<!--  LocalWords:  GEO.display-label NAICS.id NAICS.display-label ID'
  -->
<!--  LocalWords:  YEAR.id 'Original cp.iloc 'Constant .fillna 'pad'
  -->
<!--  LocalWords:  'Column 'Backfill 'backfill' scipy.interpolate bs4
  -->
<!--  LocalWords:  interp1d 'Employee Employees' .plot plt.show '--'
  -->
<!--  LocalWords:  .interpolate 'linear' 'Linear Count' 'cubic' l.get
  -->
<!--  LocalWords:  .index np.linspace plt.plot url.read tree.find 'p'
  -->
<!--  LocalWords:  'href' 'lxml' 'div' 'class' 'footer' div.find 'id'
  -->
<!--  LocalWords:  'span' 'mod-date' span.getText '01-Jan-01'  'Droid
  -->
<!--  LocalWords:  'Python' wildcards string.'' re.compile pseudocode
  -->
<!--  LocalWords:  .ui-accordion-header -webkit-hyphens -moz-hyphens
  -->
<!--  LocalWords:  -ms-hyphens Javascript 'healey' 'rappa' 'orange'
  -->
<!--  LocalWords:  'apple' 'pear' 'durian' 'pomegranate' 'Abraham -th
  -->
<!--  LocalWords:  'Hodgenville 'February 1809' 'April 1865' 'str' -2
  -->
<!--  LocalWords:  'int' 'float' 'bool' 'Christopher '9195138112' 'w'
  -->
<!--  LocalWords:  'Michael '9195130480' 'Aric '9195132957' 'Hello -3
  -->
<!--  LocalWords:  'llo 'd' 'ld 'Must.. -4 'Dept '9195152858' 's 'A'
  -->
<!--  LocalWords:  'B' 'C' 'F' 'The 'is' -15 -10 -14 -13 -12 -11 'is
  -->
<!--  LocalWords:  'Healey' 'Rappa' 'LaBarr' 'stop' 'input.txt' 'r'
  -->
<!--  LocalWords:  'latin' 'output.txt' '' 'Mostek' 'This 'excel-tab'
  -->
<!--  LocalWords:  'excel' 'pop.csv' 'has 'City' 'in 3.x 'State' 'Pop
  -->
<!--  LocalWords:  'pop-summary.csv' 'Population' 'Sample 2D 1D 'a'
  -->
<!--  LocalWords:  3.542248481792631e 'numpy.ndarray' 'b' 'c' 'x' -5
  -->
<!--  LocalWords:  -1.34 'C1' 'C2' -ith 'C3' 'latin1' 'NAME' 'STNAME'
  -->
<!--  LocalWords:  'POPESTIMATE2011' .idxmax -means 'Data 'sepal 's'
  -->
<!--  LocalWords:  'petal 'Target 'setosa' 'versicolor' 'virginica'
  -->
<!--  LocalWords:  'Truncated 'o' 'red' 'blue' 'lightgreen' 'black'
  -->
<!--  LocalWords:  'Petal 'Sepal 'Number 'Frequency 'Standardized .2f
  -->
<!--  LocalWords:  -1.28030022 -1.31903956 -1.33726273 -1.22333771 'X
  -->
<!--  LocalWords:  'Perceptron 'Misclassified .sum 'Accuracy '.format
  -->
<!--  LocalWords:  'rbf' 'SVC 'minkowski' 'KNN 'Random 'Out-of-bag f'
  -->
<!--  LocalWords:  'k-Means 'Misassigned 'average' 'Agglomerative 'p'
  -->
<!--  LocalWords:  'DBSCAN 'NaN' 'mean' 'Impute 'most 'Transform 'Pad
  -->
<!--  LocalWords:  'construction-census.csv' .values.sum 'values '--'
  -->
<!--  LocalWords:  .isnull 'Original 'EMP' 'Constant .fillna 'Column
  -->
<!--  LocalWords:  'NaNs' 'Backfill 'backfill' 'pad' 'Employee .plot
  -->
<!--  LocalWords:  .interpolate 'linear' 'Linear 'cubic' .index 'div'
  -->
<!--  LocalWords:  'href' 'lxml' 'class' 'footer' 'span' 'id' 04d -1
  -->
<!--  LocalWords:  'mod-date' '01-Jan-01' 'Python' random.randint s'
 -->
<!--  LocalWords:  'Feb' 'Mar' 'Apr' 'May' 'Jun' 'Jul' 'Aug' 'Sep' .-
 -->
<!--  LocalWords:  'Oct' 'Nov' 'Dec' plt.bar rect.get plt.text Vail
 -->
<!--  LocalWords:  'center' 'bottom' 'Birthday plt.grid 'dotted' cvt
 -->
<!--  LocalWords:  'Month' plt.title -.-. ..-. --. -.- -- --- --.- 5s
 -->
<!--  LocalWords:  ..- ...- -.-- sent.upper cvt.keys 'spc' 'Do JSON
 -->
<!--  LocalWords:  inp.upper json 'words.json' json.load .lower ord
 -->
<!--  LocalWords:  random.choice c.upper 'You pos avail.index c.lower
 -->
<!--  LocalWords:  lbl words.json chr word.index word.upper ldots lev
 -->
<!--  LocalWords:  Levenshtein textrm kelm ke kel hel kelmo kello .py
 -->
<!--  LocalWords:  smeltn smelton smelmon smlmon 00pm OpenWeatherMap
 -->
